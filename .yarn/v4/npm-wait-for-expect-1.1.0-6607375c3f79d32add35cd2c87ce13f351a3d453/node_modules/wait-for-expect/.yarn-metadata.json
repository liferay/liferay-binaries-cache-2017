{
  "manifest": {
    "name": "wait-for-expect",
    "version": "1.1.0",
    "description": "Wait for expectation to be true, useful for integration and end to end testing",
    "main": "lib/index.js",
    "typings": "lib/index.d.ts",
    "scripts": {
      "test": "eslint src/**/*.ts && jest",
      "build": "tsc --emitDeclarationOnly && babel src --out-dir lib --extensions \".ts,.tsx\"",
      "build:watch": "npm run build -- --watch",
      "type-check": "tsc --noEmit",
      "semantic-release": "semantic-release"
    },
    "repository": {
      "type": "git",
      "url": "https://github.com/TheBrainFamily/wait-for-expect.git"
    },
    "keywords": [
      "jest",
      "expect",
      "wait",
      "async",
      "await",
      "promise",
      "integration",
      "testing",
      "unit"
    ],
    "author": {
      "name": "Lukasz Gandecki"
    },
    "license": "MIT",
    "bugs": {
      "url": "https://github.com/TheBrainFamily/wait-for-expect/issues"
    },
    "homepage": "https://github.com/TheBrainFamily/wait-for-expect#readme",
    "devDependencies": {
      "@babel/cli": "^7.0.0-beta.42",
      "@babel/core": "^7.0.0-beta.42",
      "@babel/plugin-proposal-class-properties": "^7.0.0-beta.42",
      "@babel/plugin-proposal-object-rest-spread": "^7.0.0-beta.42",
      "@babel/preset-env": "^7.0.0-beta.42",
      "@babel/preset-typescript": "^7.0.0-beta.42",
      "@types/eslint": "^4.16.0",
      "@types/eslint-plugin-prettier": "^2.2.0",
      "@types/jest": "^22.2.2",
      "@types/node": "^9.6.1",
      "@types/prettier": "^1.10.0",
      "@types/typescript": "^2.0.0",
      "babel-core": "^7.0.0-0",
      "babel-jest": "^22.4.3",
      "babel-plugin-add-module-exports": "^0.2.1",
      "eslint": "^4.19.1",
      "eslint-config-airbnb-base": "^12.1.0",
      "eslint-config-prettier": "^2.9.0",
      "eslint-plugin-import": "^2.9.0",
      "eslint-plugin-prettier": "^2.6.0",
      "eslint-plugin-typescript": "^0.11.0",
      "jest": "^22.4.3",
      "jest-serializer-ansi": "^1.0.3",
      "prettier": "^1.11.1",
      "semantic-release": "^15.12.0",
      "typescript": "^2.7.2",
      "typescript-eslint-parser": "^14.0.0"
    },
    "jest": {
      "snapshotSerializers": [
        "jest-serializer-ansi"
      ],
      "moduleDirectories": [
        "./node_modules",
        "./src"
      ],
      "moduleFileExtensions": [
        "ts",
        "tsx",
        "js",
        "jsx"
      ],
      "transform": {
        "^.+\\.(js|jsx|ts|tsx)$": "babel-jest"
      },
      "testRegex": "/src/.*\\.spec\\.(js|ts|tsx)$"
    },
    "_registry": "npm",
    "_loc": "P:\\project\\lfm\\liferay-binaries-cache-2017\\.yarn\\v4\\npm-wait-for-expect-1.1.0-6607375c3f79d32add35cd2c87ce13f351a3d453\\node_modules\\wait-for-expect\\package.json",
    "readmeFilename": "README.md",
    "readme": "[![code style: prettier](https://img.shields.io/badge/code_style-prettier-ff69b4.svg?style=flat-square)](https://github.com/prettier/prettier)\n[![CircleCI](https://circleci.com/gh/TheBrainFamily/wait-for-expect.svg?style=shield)](https://circleci.com/gh/TheBrainFamily/wait-for-expect)\n\n# wait-for-expect\nWait for expectation to be true, useful for integration and end to end testing\n\nThink things like calling external APIs, database operations, or even GraphQL subscriptions. \nWe will add examples for all of them soon, for now please enjoy the simple docs. :-)\n\n# Usage:\n\n```javascript\nconst waitForExpect = require(\"wait-for-expect\")\n\ntest(\"it waits for the number to change\", async () => {\n  let numberToChange = 10;\n  // we are using random timeout here to simulate a real-time example\n  // of an async operation calling a callback at a non-deterministic time\n  const randomTimeout = Math.floor(Math.random() * 300);\n\n  setTimeout(() => {\n    numberToChange = 100;\n  }, randomTimeout);\n\n  await waitForExpect(() => {\n    expect(numberToChange).toEqual(100);\n  });\n});\n```\n\ninstead of:\n\n```javascript\n\ntest(\"it waits for the number to change\", () => {\n  let numberToChange = 10;\n  const randomTimeout = Math.floor(Math.random() * 300);\n\n  setTimeout(() => {\n    numberToChange = 100;\n  }, randomTimeout);\n  \n  setTimeout(() => {\n    expect(numberToChange).toEqual(100);\n  }, 700);\n});\n```\n\nIt will check whether the expectation passes right away in the next available \"tick\" (very useful with, for example, integration testing of react when mocking fetches, like here: https://github.com/kentcdodds/react-testing-library#usage).\n\nIf it doesn't, it will keep repeating for the duration of, at most, the specified timeout, every 50 ms. The default timeout is 4.5 seconds to fit below the default 5 seconds that Jest waits for before throwing an error. \n\nNice thing about this simple tool is that if the expectation keeps failing till the timeout, it will check it one last time, but this time the same way your test runner would run it - so you basically get your expectation library error, the sam way like if you used setTimeout to wait but didn't wait long enough.\n\nTo show an example - if I change the expectation to wait for 105 in above code, you will get nice and familiar:\n\n```\n\n FAIL  src/waitForExpect.spec.js (5.042s)\n  ✕ it waits for the number to change (4511ms)\n\n  ● it waits for the number to change\n\n    expect(received).toEqual(expected)\n    \n    Expected value to equal:\n      105\n    Received:\n      100\n\n       9 |   }, 600);\n      10 |   await waitForExpect(() => {\n    > 11 |     expect(numberToChange).toEqual(105);\n      12 |   });\n      13 | });\n      14 | \n      \n      at waitForExpect (src/waitForExpect.spec.js:11:28)\n      at waitUntil.catch (src/index.js:61:5)\n\nTest Suites: 1 failed, 1 total\nTests:       1 failed, 1 total\nSnapshots:   0 total\nTime:        5.807s\n```\n\nYou can add multiple expectations to wait for, all of them have to pass, and if one of them don't, it will be marked.\nFor example, let's add another expectation for a different number, notice how jest tells you that that's the expectation that failed.\n\n```\n    expect(received).toEqual(expected)\n    \n    Expected value to equal:\n      110\n    Received:\n      105\n\n      11 |   await waitForExpect(() => {\n      12 |     expect(numberToChange).toEqual(100);\n    > 13 |     expect(numberThatWontChange).toEqual(110);\n      14 |   });\n      15 | });\n      16 | \n      \n      at waitForExpect (src/waitForExpect.spec.js:13:34)\n      at waitUntil.catch (src/index.js:61:5)\n```\n\nSince 0.6.0 we can now work with promises, for example, this is now possible:\n\n```javascript\ntest(\"rename todo by typing\", async () => {\n  // (..)\n  const todoToChange = getTodoByText(\"original todo\");\n  todoToChange.value = \"different text now\";\n  Simulate.change(todoToChange);\n\n  await waitForExpect(() =>\n    expect(\n      todoItemsCollection.findOne({\n        text: \"different text now\"\n      })).resolves.not.toBeNull()\n  );\n});\n```\n\nAsync Await also works, as in this example - straight from our test case\n\n```javascript\ntest(\"it works with promises\", async () => {\n  let numberToChange = 10;\n  const randomTimeout = Math.floor(Math.random() * 300);\n\n  setTimeout(() => {\n    numberToChange = 100;\n  }, randomTimeout);\n\n  const sleep = (ms) =>\n    new Promise(resolve => setTimeout(() => resolve(), ms));\n\n  await waitForExpect(async () => {\n    await sleep(10);\n    expect(numberToChange).toEqual(100);\n  });\n});\n```\n\n(Note: Obviously, in this case it doesn't make sense to put the await sleep there, this is just for demonstration purpose)\n\n# API\nwaitForExpect takes 3 arguments, 2 optional.\n\n```javascript\n/**\n * Waits for predicate to not throw and returns a Promise\n *\n * @param  expectation  Function  Predicate that has to complete without throwing\n * @param  timeout  Number  Maximum wait interval, 4500ms by default\n * @param  interval  Number  Wait interval, 50ms by default\n * @return  Promise  Promise to return a callback result\n */\n```\n\n## Changelog\n1.0.0 - 15 June 2018\n\n( For most people this change doesn't matter. )\nExport the function directly in module.exports instead of exporting as an object that has default key. If that's not clear (...it isn't ;-) ) - check #8 #9 . \nThanks to @mbaranovski for the PR and @BenBrostoff for creating the issue! I'm making this 1.0.0 as this is breaking for people that currently did:\n```javascript\nconst { default: waitFor } = require('wait-for-expect');\n```\n\n0.6.0 - 3 May 2018\n\nWork with promises.\n\n0.5.0 - 10 April 2018\n\nPlay nicely with jest fake timers (and also in any test tool that overwrites setTimeout) - thanks to @slightlytyler and @kentcoddods for helping to get this resolved.\n\n## Credit\nOriginally based on ideas from https://github.com/devlato/waitUntil.\nSimplified highly and rewritten for 0.1.0 version.\nSimplified even more and rewritten even more for 0.2.0 with guidance from Kent C. Dodds: https://github.com/kentcdodds/react-testing-library/pull/25",
    "licenseText": "MIT License\n\nCopyright (c) 2018 The Brain Software House\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n"
  },
  "artifacts": [],
  "remote": {
    "resolved": "https://registry.yarnpkg.com/wait-for-expect/-/wait-for-expect-1.1.0.tgz#6607375c3f79d32add35cd2c87ce13f351a3d453",
    "type": "tarball",
    "reference": "https://registry.yarnpkg.com/wait-for-expect/-/wait-for-expect-1.1.0.tgz",
    "hash": "6607375c3f79d32add35cd2c87ce13f351a3d453",
    "integrity": "sha512-vQDokqxyMyknfX3luCDn16bSaRcOyH6gGuUXMIbxBLeTo6nWuEWYqMTT9a+44FmW8c2m6TRWBdNvBBjA1hwEKg==",
    "registry": "npm",
    "packageName": "wait-for-expect"
  },
  "registry": "npm",
  "hash": "6607375c3f79d32add35cd2c87ce13f351a3d453"
}