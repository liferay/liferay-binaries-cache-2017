(function(){this.metal=this.metal||{},this.metalNamed=this.metalNamed||{};var babelHelpers={};babelHelpers["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},babelHelpers.classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},babelHelpers.createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),babelHelpers.defineProperty=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},babelHelpers.get=function e(t,n,r){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,n);if(void 0===a){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in a)return a.value;var i=a.get;if(void 0!==i)return i.call(r)},babelHelpers.inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},babelHelpers.possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},babelHelpers.slicedToArray=function(){function e(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(l){a=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(a)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),babelHelpers.toConsumableArray=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},function(){function e(){throw Error("Unimplemented abstract method")}function t(){C=void 0}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};C=e}function r(){return void 0===C&&"undefined"!=typeof window&&window.__METAL_COMPATIBILITY__&&n(window.__METAL_COMPATIBILITY__),C}function a(e,t){return e||t}function o(e){if(!e.name){var t=e.toString();e.name=t.substring(9,t.indexOf("("))}return e.name}function i(e,t,n){var r=t+"_MERGED";if(!e.hasOwnProperty(r)){var o=e.hasOwnProperty(t)?e[t]:null;if(e.__proto__&&!e.__proto__.isPrototypeOf(Function)){var s=n||a;o=s(o,i(e.__proto__,t,s))}e[r]=o}return e[r]}function s(e,t){if(e){var n=e[R];return t&&!e.hasOwnProperty(R)&&(n=null),n||(e[R]=k++)}return k++}function l(e){return e}function u(e){return"boolean"==typeof e}function c(e){return void 0!==e}function d(e){return c(e)&&!p(e)}function h(e){return e&&"object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))&&9===e.nodeType}function g(e){return e&&"object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))&&11===e.nodeType}function m(e){return e&&"object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))&&1===e.nodeType}function f(e){return"function"==typeof e}function p(e){return null===e}function v(e){return"number"==typeof e}function y(e){return null!==e&&e===e.window}function _(e){var t="undefined"==typeof e?"undefined":babelHelpers["typeof"](e);return"object"===t&&null!==e||"function"===t}function b(e){return e&&"object"===("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))&&"function"==typeof e.then}function E(e){return"string"==typeof e||e instanceof String}function N(){return"undefined"!=typeof process&&"undefined"!=typeof process.env&&"test"!==process.env.NODE_ENV&&!process.browser}function S(){}var C=void 0,k=1,R="core_"+(1e9*Math.random()>>>0);this.metalNamed.coreNamed=this.metalNamed.coreNamed||{},this.metalNamed.coreNamed.UID_PROPERTY=R,this.metalNamed.coreNamed.abstractMethod=e,this.metalNamed.coreNamed.disableCompatibilityMode=t,this.metalNamed.coreNamed.enableCompatibilityMode=n,this.metalNamed.coreNamed.getCompatibilityModeData=r,this.metalNamed.coreNamed.getFunctionName=o,this.metalNamed.coreNamed.getStaticProperty=i,this.metalNamed.coreNamed.getUid=s,this.metalNamed.coreNamed.identityFunction=l,this.metalNamed.coreNamed.isBoolean=u,this.metalNamed.coreNamed.isDef=c,this.metalNamed.coreNamed.isDefAndNotNull=d,this.metalNamed.coreNamed.isDocument=h,this.metalNamed.coreNamed.isDocumentFragment=g,this.metalNamed.coreNamed.isElement=m,this.metalNamed.coreNamed.isFunction=f,this.metalNamed.coreNamed.isNull=p,this.metalNamed.coreNamed.isNumber=v,this.metalNamed.coreNamed.isWindow=y,this.metalNamed.coreNamed.isObject=_,this.metalNamed.coreNamed.isPromise=b,this.metalNamed.coreNamed.isString=E,this.metalNamed.coreNamed.isServerSide=N,this.metalNamed.coreNamed.nullFunction=S}.call(this),function(){var e=this.metalNamed.coreNamed;this.metal.core=e,this.metalNamed.core=this.metalNamed.core||{},this.metalNamed.core.core=e,Object.keys(this.metalNamed.coreNamed).forEach(function(e){this.metalNamed.core[e]=this.metalNamed.coreNamed[e]})}.call(this),function(){var e=this.metalNamed.core.isDef,t=function(){function t(){babelHelpers.classCallCheck(this,t)}return babelHelpers.createClass(t,null,[{key:"equal",value:function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}},{key:"firstDefinedValue",value:function(e){for(var t=0;t<e.length;t++)if(void 0!==e[t])return e[t]}},{key:"flatten",value:function(e,n){for(var r=n||[],a=0;a<e.length;a++)Array.isArray(e[a])?t.flatten(e[a],r):r.push(e[a]);return r}},{key:"remove",value:function(e,n){var r=e.indexOf(n),a=void 0;return(a=r>=0)&&t.removeAt(e,r),a}},{key:"removeAt",value:function(e,t){return 1===Array.prototype.splice.call(e,t,1).length}},{key:"slice",value:function(t,n,r){for(var a=[],o=e(r)?r:t.length,i=n;i<o;i++)a.push(t[i]);return a}}]),t}();this.metal.array=t}.call(this),function(){var e={};e.throwException=function(t){e.nextTick(function(){throw t})},e.run=function(t,n){e.run.workQueueScheduled_||(e.nextTick(e.run.processWorkQueue),e.run.workQueueScheduled_=!0),e.run.workQueue_.push(new e.run.WorkItem_(t,n))},e.run.workQueueScheduled_=!1,e.run.workQueue_=[],e.run.processWorkQueue=function(){for(;e.run.workQueue_.length;){var t=e.run.workQueue_;e.run.workQueue_=[];for(var n=0;n<t.length;n++){var r=t[n];try{r.fn.call(r.scope)}catch(a){e.throwException(a)}}}e.run.workQueueScheduled_=!1},e.run.WorkItem_=function(e,t){this.fn=e,this.scope=t},e.nextTick=function(t,n){var r=t;return n&&(r=t.bind(n)),r=e.nextTick.wrapCallback_(r),"function"==typeof setImmediate?void setImmediate(r):(e.nextTick.setImmediate_||(e.nextTick.setImmediate_=e.nextTick.getSetImmediateEmulator_()),void e.nextTick.setImmediate_(r))},e.nextTick.setImmediate_=null,e.nextTick.getSetImmediateEmulator_=function(){var e=void 0;if("function"==typeof MessageChannel&&(e=MessageChannel),"undefined"==typeof e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&(e=function(){var e=document.createElement("iframe");e.style.display="none",e.src="",document.documentElement.appendChild(e);var t=e.contentWindow,n=t.document;n.open(),n.write(""),n.close();var r="callImmediate"+Math.random(),a=t.location.protocol+"//"+t.location.host,o=function(e){e.origin!==a&&e.data!==r||this.port1.onmessage()}.bind(this);t.addEventListener("message",o,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(r,a)}}}),"undefined"!=typeof e){var t=new e,n={},r=n;return t.port1.onmessage=function(){n=n.next;var e=n.cb;n.cb=null,e()},function(e){r.next={cb:e},r=r.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("script")?function(e){var t=document.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){setTimeout(e,0)}},e.nextTick.wrapCallback_=function(e){return e},this.metal.async=e}.call(this),function(){var e=function(){function e(){babelHelpers.classCallCheck(this,e),this.disposed_=!1}return babelHelpers.createClass(e,[{key:"dispose",value:function(){this.disposed_||(this.disposeInternal(),this.disposed_=!0)}},{key:"disposeInternal",value:function(){}},{key:"isDisposed",value:function(){return this.disposed_}}]),e}();this.metal.Disposable=e}.call(this),function(){var e=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"mixin",value:function(e){for(var t=void 0,n=void 0,r=1;r<arguments.length;r++){n=arguments[r];for(t in n)e[t]=n[t]}return e}},{key:"getObjectByName",value:function(e,t){var n=t||window,r=e.split(".");return r.reduce(function(e,t){return e[t]},n)}},{key:"map",value:function(e,t){for(var n={},r=Object.keys(e),a=0;a<r.length;a++)n[r[a]]=t(r[a],e[r[a]]);return n}},{key:"shallowEqual",value:function(e,t){if(e===t)return!0;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var a=0;a<n.length;a++)if(e[n[a]]!==t[n[a]])return!1;return!0}}]),e}();this.metal.object=e}.call(this),function(){var e=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"caseInsensitiveCompare",value:function(e,t){var n=String(e).toLowerCase(),r=String(t).toLowerCase();return n<r?-1:n===r?0:1}},{key:"collapseBreakingSpaces",value:function(e){return e.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")}},{key:"escapeRegex",value:function(e){return String(e).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")}},{key:"getRandomString",value:function(){var e=2147483648;return Math.floor(Math.random()*e).toString(36)+Math.abs(Math.floor(Math.random()*e)^Date.now()).toString(36)}},{key:"hashCode",value:function(e){for(var t=0,n=0,r=e.length;n<r;n++)t=31*t+e.charCodeAt(n),t%=4294967296;return t}},{key:"replaceInterval",value:function(e,t,n,r){return e.substring(0,t)+r+e.substring(n)}}]),e}();this.metal.string=e}.call(this),function(){var e=this.metal.core,t=this.metal.array,n=this.metal.async,r=this.metal.Disposable,a=this.metal.object,o=this.metal.string;this.metalNamed.metal=this.metalNamed.metal||{},Object.keys(this.metalNamed.core).forEach(function(e){this.metalNamed.metal[e]=this.metalNamed.core[e]}),this.metalNamed.metal.array=t,this.metalNamed.metal.async=n,this.metalNamed.metal.Disposable=r,this.metalNamed.metal.object=a,this.metalNamed.metal.string=o,this.metal.metal=e}.call(this),function(){var e=e||{};"undefined"!=typeof window&&(e.window=window),"undefined"!=typeof document&&(e.document=document),this.metal.globals=e}.call(this),function(){function e(e){var t=document.createElement("a");if(t.href=e,":"===t.protocol||!/:/.test(t.href))throw new TypeError(e+" is not a valid URL");return{hash:t.hash,hostname:t.hostname,password:t.password,pathname:"/"===t.pathname[0]?t.pathname:"/"+t.pathname,port:t.port,protocol:t.protocol,search:t.search,username:t.username}}this.metal.parseFromAnchor=e}.call(this),function(){function e(e){if(t(URL)&&URL.length){var r=new URL(e);if(r.port&&r.href.indexOf(r.port)===-1)throw new TypeError(e+" is not a valid URL");return r}return n(e)}var t=this.metalNamed.metal.isFunction,n=this.metal.parseFromAnchor;this.metal.parse=e}.call(this),function(){var e=this.metalNamed.metal.Disposable,t=Object.create,n=function(e){function n(){babelHelpers.classCallCheck(this,n);var e=babelHelpers.possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.keys=t(null),e.values=t(null),e}return babelHelpers.inherits(n,e),babelHelpers.createClass(n,[{key:"add",value:function(e,t){return this.keys[e.toLowerCase()]=e,this.values[e.toLowerCase()]=this.values[e.toLowerCase()]||[],this.values[e.toLowerCase()].push(t),this}},{key:"clear",value:function(){return this.keys=t(null),this.values=t(null),this}},{key:"contains",value:function(e){return e.toLowerCase()in this.values}},{key:"disposeInternal",value:function(){this.values=null}},{key:"get",value:function(e){var t=this.values[e.toLowerCase()];if(t)return t[0]}},{key:"getAll",value:function(e){return this.values[e.toLowerCase()]}},{key:"isEmpty",value:function(){return 0===this.size()}},{key:"names",value:function(){var e=this;return Object.keys(this.values).map(function(t){return e.keys[t]})}},{key:"remove",value:function(e){return delete this.keys[e.toLowerCase()],delete this.values[e.toLowerCase()],this}},{key:"set",value:function(e,t){return this.keys[e.toLowerCase()]=e,this.values[e.toLowerCase()]=[t],this}},{key:"size",value:function(){return this.names().length}},{key:"toString",value:function(){return JSON.stringify(this.values)}}],[{key:"fromObject",value:function(e){for(var t=new n,r=Object.keys(e),a=0;a<r.length;a++)t.set(r[a],e[r[a]]);return t}}]),n}(e);this.metal.MultiMap=n}.call(this),function(){var e=this.metalNamed.metal.array,t=function(){function t(e){babelHelpers.classCallCheck(this,t),this.value_=e,this.parent_=null,this.children_=null}return babelHelpers.createClass(t,[{key:"addChild",value:function(e){n(e),e.setParent(this),this.children_=this.children_||[],this.children_.push(e)}},{key:"contains",value:function(e){for(var t=e.getParent();t;){if(t===this)return!0;t=t.getParent()}return!1}},{key:"getAncestors",value:function(){for(var e=[],t=this.getParent();t;)e.push(t),t=t.getParent();return e}},{key:"getChildAt",value:function(e){return this.getChildren()[e]||null}},{key:"getChildren",value:function(){return this.children_||t.EMPTY_ARRAY}},{key:"getChildCount",value:function(){return this.getChildren().length}},{key:"getDepth",value:function(){for(var e=0,t=this;t.getParent();)e++,t=t.getParent();return e}},{key:"getParent",value:function(){return this.parent_}},{key:"getRoot",value:function(){for(var e=this;e.getParent();)e=e.getParent();return e}},{key:"getValue",value:function(){return this.value_}},{key:"isLeaf",value:function(){return!this.getChildCount()}},{key:"removeChild",value:function(t){return e.remove(this.getChildren(),t)?t:null}},{key:"setParent",value:function(e){this.parent_=e}},{key:"traverse",value:function(e,t){e&&e(this),this.getChildren().forEach(function(n){return n.traverse(e,t)}),t&&t(this)}}]),t}();t.EMPTY_ARRAY=[];var n=function(e){if(e.getParent())throw new Error("Cannot add child with parent.")};this.metal.TreeNode=t}.call(this),function(){var e=this.metal.MultiMap,t=this.metal.TreeNode;this.metalNamed.structs=this.metalNamed.structs||{},this.metalNamed.structs.MultiMap=e,this.metalNamed.structs.TreeNode=t}.call(this),function(){var e=this.metalNamed.metal.isDef,t=this.metalNamed.metal.string,n=this.metal.parse,r=this.metalNamed.structs.MultiMap,a=n,o=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";babelHelpers.classCallCheck(this,n),this.url=n.parse(this.maybeAddProtocolAndHostname_(e))}return babelHelpers.createClass(n,[{key:"addParametersFromMultiMap",value:function(e){var t=this;return e.names().forEach(function(n){e.getAll(n).forEach(function(e){t.addParameterValue(n,e)})}),this}},{key:"addParameterValue",value:function(t,n){return this.ensureQueryInitialized_(),e(n)&&(n=String(n)),this.query.add(t,n),this}},{key:"addParameterValues",value:function(e,t){var n=this;return t.forEach(function(t){return n.addParameterValue(e,t)}),this}},{key:"ensureQueryInitialized_",value:function(){var t=this;if(!this.query){this.query=new r;var a=this.url.search;a&&a.substring(1).split("&").forEach(function(r){var a=r.split("="),o=babelHelpers.slicedToArray(a,2),i=o[0],s=o[1];e(s)&&(s=n.urlDecode(s)),t.addParameterValue(i,s)})}}},{key:"getHash",value:function(){return this.url.hash||""}},{key:"getHost",value:function(){var e=this.getHostname();if(e){var t=this.getPort();t&&"80"!==t&&(e+=":"+t)}return e}},{key:"getHostname",value:function(){var e=this.url.hostname;return e===n.HOSTNAME_PLACEHOLDER?"":e}},{key:"getOrigin",value:function(){var e=this.getHost();return e?this.getProtocol()+"//"+e:""}},{key:"getParameterValue",value:function(e){return this.ensureQueryInitialized_(),this.query.get(e)}},{key:"getParameterValues",value:function(e){return this.ensureQueryInitialized_(),this.query.getAll(e)}},{key:"getParameterNames",value:function(){return this.ensureQueryInitialized_(),this.query.names()}},{key:"getPathname",value:function(){return this.url.pathname}},{key:"getPort",value:function(){return this.url.port}},{key:"getProtocol",value:function(){return this.url.protocol}},{key:"getSearch",value:function(){var t=this,n="",r="";return this.getParameterNames().forEach(function(n){t.getParameterValues(n).forEach(function(t){r+=n,e(t)&&(r+="="+encodeURIComponent(t)),r+="&"})}),r=r.slice(0,-1),r&&(n+="?"+r),n}},{key:"hasParameter",value:function(e){return this.ensureQueryInitialized_(),this.query.contains(e)}},{key:"makeUnique",value:function(){return this.setParameterValue(n.RANDOM_PARAM,t.getRandomString()),this}},{key:"maybeAddProtocolAndHostname_",value:function(e){var t=e;if(e.indexOf("://")===-1&&0!==e.indexOf("javascript:"))switch(t=n.DEFAULT_PROTOCOL,"/"===e[0]&&"/"===e[1]||(t+="//"),e.charAt(0)){case".":case"?":case"#":t+=n.HOSTNAME_PLACEHOLDER,t+="/",t+=e;break;case"":case"/":"/"!==e[1]&&(t+=n.HOSTNAME_PLACEHOLDER),t+=e;break;default:t+=e}return t}},{key:"removeParameter",value:function(e){return this.ensureQueryInitialized_(),this.query.remove(e),this}},{key:"removeUnique",value:function(){return this.removeParameter(n.RANDOM_PARAM),this}},{key:"setHash",value:function(e){return this.url.hash=e,this}},{key:"setHostname",value:function(e){return this.url.hostname=e,this}},{key:"setParameterValue",value:function(e,t){return this.removeParameter(e),this.addParameterValue(e,t),this}},{key:"setParameterValues",value:function(e,t){var n=this;return this.removeParameter(e),t.forEach(function(t){return n.addParameterValue(e,t)}),this}},{key:"setPathname",value:function(e){return this.url.pathname=e,this}},{key:"setPort",value:function(e){return this.url.port=e,this}},{key:"setProtocol",value:function(e){return this.url.protocol=e,":"!==this.url.protocol[this.url.protocol.length-1]&&(this.url.protocol+=":"),this}},{key:"toString",value:function(){var e="",t=this.getHost();return t&&(e+=this.getProtocol()+"//"),e+=t+this.getPathname()+this.getSearch()+this.getHash()}}],[{key:"getParseFn",value:function(){return a}},{key:"parse",value:function(e){return a(e)}},{key:"setParseFn",value:function(e){a=e}},{key:"joinPaths",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"/"===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),n=n.map(function(e){return"/"===e.charAt(0)?e.substring(1):e}),[e].concat(n).join("/").replace(/\/$/,"")}},{key:"urlDecode",value:function(e){return decodeURIComponent(e.replace(/\+/g," "))}}]),n}(),i=function(){return"undefined"!=typeof window&&window.location&&window.location.protocol&&0===window.location.protocol.indexOf("https")};o.DEFAULT_PROTOCOL=i()?"https:":"http:",o.HOSTNAME_PLACEHOLDER="hostname"+Date.now(),o.RANDOM_PARAM="zx",this.metal.Uri=o}.call(this),function(){var e=this.metal.globals,t=this.metal.Uri,n=function(){function n(){babelHelpers.classCallCheck(this,n)}return babelHelpers.createClass(n,null,[{key:"copyNodeAttributes",value:function(e,t){Array.prototype.slice.call(e.attributes).forEach(function(e){return t.setAttribute(e.name,e.value)})}},{key:"getCurrentBrowserPath",value:function(){return this.getCurrentBrowserPathWithoutHash()+e.window.location.hash}},{key:"getCurrentBrowserPathWithoutHash",value:function(){return e.window.location.pathname+e.window.location.search}},{key:"getNodeOffset",value:function(e){var t=0,n=0;do t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;while(e);return{offsetLeft:t,offsetTop:n}}},{key:"getUrlPath",value:function(e){var n=new t(e);return n.getPathname()+n.getSearch()+n.getHash()}},{key:"getUrlPathWithoutHash",value:function(e){var n=new t(e);return n.getPathname()+n.getSearch()}},{key:"getUrlPathWithoutHashAndSearch",value:function(e){var n=new t(e);return n.getPathname()}},{key:"isCurrentBrowserPath",value:function(e){if(e){var t=this.getCurrentBrowserPathWithoutHash();return n.getUrlPathWithoutHash(e)===this.getUrlPath(t)}return!1}},{key:"isHtml5HistorySupported",value:function(){return!(!e.window.history||!e.window.history.pushState)}},{key:"isWebUri",value:function(e){try{return new t(e)}catch(n){return!1}}},{key:"clearNodeAttributes",value:function(e){Array.prototype.slice.call(e.attributes).forEach(function(t){return e.removeAttribute(t.name)})}},{key:"removePathTrailingSlash",value:function(e){var t=e?e.length:0;return t>1&&"/"===e[t-1]&&(e=e.substr(0,t-1)),e}}]),n}();this.metal.utils=n}.call(this),function(){this.metal.dataAttributes={basePath:"data-senna-base-path",linkSelector:"data-senna-link-selector",loadingCssClass:"data-senna-loading-css-class",senna:"data-senna",dispatch:"data-senna-dispatch",surface:"data-senna-surface",updateScrollPosition:"data-senna-update-scroll-position"}}.call(this),function(){var e="__metal_data__",t=function(){function t(){babelHelpers.classCallCheck(this,t)}return babelHelpers.createClass(t,null,[{key:"get",value:function(t,n,r){return t[e]||(t[e]={}),n?(!t[e][n]&&r&&(t[e][n]=r),t[e][n]):t[e]}},{key:"has",value:function(t){return!!t[e]}}]),t}();this.metal.domData=t}.call(this),function(){var e=this.metalNamed.metal.Disposable,t=function(e){function t(e,n,r){babelHelpers.classCallCheck(this,t);var a=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.emitter_=e,a.event_=n,a.listener_=r,a}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"disposeInternal",value:function(){this.removeListener(),this.emitter_=null,this.listener_=null}},{key:"removeListener",value:function(){this.emitter_.isDisposed()||this.emitter_.removeListener(this.event_,this.listener_)}}]),t}(e);this.metal.EventHandle=t}.call(this),function(){function e(e){return e=e||[],Array.isArray(e)?e:[e]}var t=this.metalNamed.metal.array,n=this.metalNamed.metal.Disposable,r=this.metalNamed.metal.isFunction,a=this.metalNamed.metal.isString,o=this.metal.EventHandle,i=[0],s=function(n){function s(){babelHelpers.classCallCheck(this,s);var e=babelHelpers.possibleConstructorReturn(this,(s.__proto__||Object.getPrototypeOf(s)).call(this));return e.events_=null,e.listenerHandlers_=null,e.shouldUseFacade_=!1,e}return babelHelpers.inherits(s,n),babelHelpers.createClass(s,[{key:"addHandler_",value:function(e,t){return e?(Array.isArray(e)||(e=[e]),e.push(t)):e=t,e}},{key:"addListener",value:function(e,t,n){this.validateListener_(t);for(var r=this.toEventsArray_(e),a=0;a<r.length;a++)this.addSingleListener_(r[a],t,n);return new o(this,e,t)}},{key:"addSingleListener_",value:function(e,t,n,r){this.runListenerHandlers_(e),(n||r)&&(t={"default":n,fn:t,origin:r}),this.events_=this.events_||{},this.events_[e]=this.addHandler_(this.events_[e],t)}},{key:"buildFacade_",value:function(e){if(this.getShouldUseFacade()){var t={preventDefault:function(){t.preventedDefault=!0},target:this,type:e};return t}}},{key:"disposeInternal",value:function(){this.events_=null}},{key:"emit",value:function(e){var n=this.getRawListeners_(e);if(0===n.length)return!1;var r=t.slice(arguments,1);return this.runListeners_(n,r,this.buildFacade_(e)),!0}},{key:"getRawListeners_",value:function(t){var n=e(this.events_&&this.events_[t]);return n.concat(e(this.events_&&this.events_["*"]))}},{key:"getShouldUseFacade",value:function(){return this.shouldUseFacade_}},{key:"listeners",value:function(e){return this.getRawListeners_(e).map(function(e){return e.fn?e.fn:e})}},{key:"many",value:function(e,t,n){for(var r=this.toEventsArray_(e),a=0;a<r.length;a++)this.many_(r[a],t,n);return new o(this,e,n)}},{key:"many_",value:function(e,t,n){function r(){0===--t&&a.removeListener(e,r),n.apply(a,arguments)}var a=this;t<=0||a.addSingleListener_(e,r,!1,n)}},{key:"matchesListener_",value:function(e,t){var n=e.fn||e;return n===t||e.origin&&e.origin===t}},{key:"off",value:function(t,n){if(this.validateListener_(n),!this.events_)return this;for(var r=this.toEventsArray_(t),a=0;a<r.length;a++)this.events_[r[a]]=this.removeMatchingListenerObjs_(e(this.events_[r[a]]),n);return this}},{key:"on",value:function(){return this.addListener.apply(this,arguments)}},{key:"onListener",value:function(e){this.listenerHandlers_=this.addHandler_(this.listenerHandlers_,e)}},{key:"once",value:function(e,t){return this.many(e,1,t)}},{key:"removeAllListeners",value:function(e){if(this.events_)if(e)for(var t=this.toEventsArray_(e),n=0;n<t.length;n++)this.events_[t[n]]=null;else this.events_=null;return this}},{key:"removeMatchingListenerObjs_",value:function(e,t){for(var n=[],r=0;r<e.length;r++)this.matchesListener_(e[r],t)||n.push(e[r]);return n.length>0?n:null}},{key:"removeListener",value:function(){return this.off.apply(this,arguments)}},{key:"runListenerHandlers_",value:function(t){var n=this.listenerHandlers_;if(n){n=e(n);for(var r=0;r<n.length;r++)n[r](t)}}},{key:"runListeners_",value:function(e,t,n){n&&t.push(n);for(var r=[],a=0;a<e.length;a++){var o=e[a].fn||e[a];e[a]["default"]?r.push(o):o.apply(this,t)}if(!n||!n.preventedDefault)for(var i=0;i<r.length;i++)r[i].apply(this,t)}},{key:"setShouldUseFacade",value:function(e){return this.shouldUseFacade_=e,this}},{key:"toEventsArray_",value:function(e){return a(e)&&(i[0]=e,e=i),e}},{key:"validateListener_",value:function(e){if(!r(e))throw new TypeError("Listener must be a function")}}]),s}(n);this.metal.EventEmitter=s}.call(this),function(){var e=this.metalNamed.metal.Disposable,t=function(e){function t(e,n,r,a){babelHelpers.classCallCheck(this,t);var o=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.blacklist_=r,o.originEmitter_=e,o.pendingEvents_=null,o.proxiedEvents_=null,o.targetEmitter_=n,o.whitelist_=a,o.startProxy_(),o}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"addListener_",value:function(e,t){return this.originEmitter_.on(e,t)}},{key:"disposeInternal",value:function(){this.removeListeners_(),this.proxiedEvents_=null,this.originEmitter_=null,this.targetEmitter_=null}},{key:"emitOnTarget_",value:function(){this.targetEmitter_.emit.apply(this.targetEmitter_,arguments)}},{key:"proxyEvent",value:function(e){this.shouldProxyEvent_(e)&&this.tryToAddListener_(e)}},{key:"removeListeners_",value:function(){if(this.proxiedEvents_){for(var e=Object.keys(this.proxiedEvents_),t=0;t<e.length;t++)this.proxiedEvents_[e[t]].removeListener();this.proxiedEvents_=null}this.pendingEvents_=null}},{key:"setOriginEmitter",value:function(e){var t=this,n=this.originEmitter_&&this.proxiedEvents_?Object.keys(this.proxiedEvents_):this.pendingEvents_;this.originEmitter_=e,n&&(this.removeListeners_(),n.forEach(function(e){return t.proxyEvent(e)}))}},{key:"shouldProxyEvent_",value:function(e){return!(this.whitelist_&&!this.whitelist_[e])&&((!this.blacklist_||!this.blacklist_[e])&&(!this.proxiedEvents_||!this.proxiedEvents_[e]))}},{key:"startProxy_",value:function(){this.targetEmitter_.onListener(this.proxyEvent.bind(this))}},{key:"tryToAddListener_",value:function(e){this.originEmitter_?(this.proxiedEvents_=this.proxiedEvents_||{},this.proxiedEvents_[e]=this.addListener_(e,this.emitOnTarget_.bind(this,e))):(this.pendingEvents_=this.pendingEvents_||[],this.pendingEvents_.push(e))}}]),t}(e);this.metal.EventEmitterProxy=t}.call(this),function(){var e=this.metalNamed.metal.Disposable,t=function(e){function t(){babelHelpers.classCallCheck(this,t);var e=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.eventHandles_=[],e}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"add",value:function(){for(var e=0;e<arguments.length;e++)this.eventHandles_.push(arguments[e])}},{key:"disposeInternal",value:function(){this.eventHandles_=null}},{key:"removeAllListeners",value:function(){for(var e=0;e<this.eventHandles_.length;e++)this.eventHandles_[e].removeListener();this.eventHandles_=[]}}]),t}(e);this.metal.EventHandler=t}.call(this),function(){var e=this.metal.EventEmitter,t=this.metal.EventEmitterProxy,n=this.metal.EventHandle,r=this.metal.EventHandler;this.metal.events=e,this.metalNamed.events=this.metalNamed.events||{},this.metalNamed.events.EventEmitter=e,this.metalNamed.events.EventEmitterProxy=t,this.metalNamed.events.EventHandle=n,this.metalNamed.events.EventHandler=r}.call(this),function(){var e=this.metalNamed.metal.array,t=this.metalNamed.metal.isString,n=this.metal.domData,r=this.metalNamed.events.EventHandle,a=function(r){function a(e,t,n,r){babelHelpers.classCallCheck(this,a);var o=babelHelpers.possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,t,n));return o.selector_=r,o}return babelHelpers.inherits(a,r),babelHelpers.createClass(a,[{key:"removeListener",value:function(){var r=n.get(this.emitter_,"delegating",{}),a=n.get(this.emitter_,"listeners",{}),o=this.selector_,i=t(o)?r[this.event_].selectors:a,s=t(o)?o:this.event_;e.remove(i[s]||[],this.listener_),i[s]&&0===i[s].length&&delete i[s]}}]),a}(r);this.metal.DomDelegatedEventHandle=a}.call(this),function(){var e=this.metalNamed.events.EventHandle,t=function(e){function t(e,n,r,a){babelHelpers.classCallCheck(this,t);var o=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r));return o.capture_=a,o}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"removeListener",value:function(){this.emitter_.removeEventListener(this.event_,this.listener_,this.capture_)}}]),t}(e);this.metal.DomEventHandle=t}.call(this),function(){function e(e,r){if(Q(e)&&J(r)){e.length||(e=[e]);for(var a=0;a<e.length;a++)"classList"in e[a]?t(e[a],r):n(e[a],r)}}function t(e,t){t.split(" ").forEach(function(t){t&&e.classList.add(t)})}function n(e,t){var n=" "+e.className+" ",r="";t=t.split(" ");for(var a=0;a<t.length;a++){var o=t[a];n.indexOf(" "+o+" ")===-1&&(r+=" "+o)}r&&(e.className=e.className+r)}function r(e,t,n){o(X.get(e,"listeners",{}),t,n)}function a(e,t,n,r){var a=X.get(e,"delegating",{});o(a[t].selectors,n,r)}function o(e,t,n){e[t]||(e[t]=[]),e[t].push(n)}function i(e,t){var n=X.get(e,"delegating",{});n[t]||(n[t]={handle:C(e,t,f,!!ie[t]),selectors:{}})}function s(e,t){for(;e&&!b(e,t);)e=e.parentNode;return e}function l(e,t){if(J(t)&&(t=u(t)),t instanceof NodeList)for(var n=Array.prototype.slice.call(t),r=0;r<n.length;r++)e.appendChild(n[r]);else e.appendChild(t);return t}function u(e){var t=document.createElement("div");t.innerHTML="<br>"+e,t.removeChild(t.firstChild);for(var n=document.createDocumentFragment();t.firstChild;)n.appendChild(t.firstChild);return n}function c(e,t){return K(e)?e.documentElement.contains(t):e.contains(t)}function d(e,t,n,o,s){var l=ae[t];return l&&l.delegate&&(t=l.originalEvent,o=l.handler.bind(l,o)),s&&(o=o.bind(),o.defaultListener_=!0),i(e,t),J(n)?a(e,t,n,o):r(n,t,o),new ee(J(n)?e:n,t,o,J(n)?n:null)}function h(e,t,n){if(n&&"click"===t&&2===n.button)return!1;var r=["BUTTON","INPUT","SELECT","TEXTAREA","FIELDSET"];return!("click"===t&&r.indexOf(e.tagName)>-1)||!(e.disabled||R(e,"fieldset[disabled]"))}function g(e){e&&l(document.body,e)}function m(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function f(e){S(e);var t=!0,n=e.currentTarget,r=[];return t&=x(n,e,r),t&=M(r,e),e.delegateTarget=null,e[oe]=n,t}function p(e,t){return"classList"in e?v(e,t):y(e,t)}function v(e,t){return e.classList.contains(t)}function y(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>=0}function _(e){return 0===e.childNodes.length;
}function b(e,t){if(!e||1!==e.nodeType)return!1;var n=Element.prototype,r=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector;return r?r.call(e,t):E(e,t)}function E(e,t){for(var n=document.querySelectorAll(t,e.parentNode),r=0;r<n.length;++r)if(n[r]===e)return!0;return!1}function N(e,t){do if(e=e.nextSibling,e&&b(e,t))return e;while(e);return null}function S(e){e.stopPropagation=I,e.stopImmediatePropagation=w}function C(e,t,n,r){if(J(e))return d(document,t,e,n);var a=ae[t];return a&&a.event&&(t=a.originalEvent,n=a.handler.bind(a,n)),e.addEventListener(t,n,r),new te(e,t,n,r)}function k(e,t,n){var r=C(e,t,function(){return r.removeListener(),n.apply(this,arguments)});return r}function R(e,t){return s(e.parentNode,t)}function D(e,t){ae[e]=t}function O(e){for(var t=void 0;t=e.firstChild;)e.removeChild(t)}function A(e,t){if(Q(e)&&J(t)){e.length||(e=[e]);for(var n=0;n<e.length;n++)"classList"in e[n]?P(e[n],t):L(e[n],t)}}function P(e,t){t.split(" ").forEach(function(t){t&&e.classList.remove(t)})}function L(e,t){var n=" "+e.className+" ";t=t.split(" ");for(var r=0;r<t.length;r++)n=n.replace(" "+t[r]+" "," ");e.className=n.trim()}function T(e,t){e&&t&&e!==t&&e.parentNode&&(e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e))}function w(){var e=this;e.stopped=!0,e.stoppedImmediate=!0,Event.prototype.stopImmediatePropagation.call(e)}function I(){var e=this;e.stopped=!0,Event.prototype.stopPropagation.call(e)}function H(e,t){if(ae[t])return!0;J(e)&&(ne[e]||(ne[e]=document.createElement(e)),e=ne[e]);var n=e.tagName;return re[n]&&re[n].hasOwnProperty(t)||(re[n]=re[n]||{},re[n][t]="on"+t in e),re[n][t]}function M(e,t){for(var n=!0,r=0;r<e.length&&!t.defaultPrevented;r++)t.delegateTarget=e[r].element,n&=e[r].fn(t);return n}function x(e,t,n){for(var r=!0,a=t.target,o=e.parentNode;a&&a!==o&&!t.stopped;)h(a,t.type,t)&&(t.delegateTarget=a,r&=V(a,t,n),r&=G(e,a,t,n)),a=a.parentNode;return r}function U(e){return W(e)||K(e)||Y(e)?e:J(e)?"#"===e[0]&&e.indexOf(" ")===-1?document.getElementById(e.substr(1)):document.querySelector(e):null}function F(e,t){Q(e)&&J(t)&&("classList"in e?j(e,t):B(e,t))}function j(e,t){t.split(" ").forEach(function(t){e.classList.toggle(t)})}function B(e,t){var n=" "+e.className+" ";t=t.split(" ");for(var r=0;r<t.length;r++){var a=" "+t[r]+" ",o=n.indexOf(a);if(o===-1)n=""+n+t[r]+" ";else{var i=n.substring(0,o),s=n.substring(o+a.length);n=i+" "+s}}e.className=n.trim()}function V(e,t,n){var r=t[oe];if(!z(r)||!c(r,e)){var a=X.get(e,"listeners",{})[t.type];return $(a,t,e,n)}return!0}function q(e,t,n){if(h(e,t,n)){var r=document.createEvent("HTMLEvents");r.initEvent(t,!0,!0),Z.mixin(r,n),e.dispatchEvent(r)}}function $(e,t,n,r){var a=!0;e=e||[];for(var o=0;o<e.length&&!t.stoppedImmediate;o++)e[o].defaultListener_?r.push({element:n,fn:e[o]}):a&=e[o](t);return a}function G(e,t,n,r){for(var a=!0,o=X.get(e,"delegating",{}),i=o[n.type].selectors,s=Object.keys(i),l=0;l<s.length&&!n.stoppedImmediate;l++)if(b(t,s[l])){var u=i[s[l]];a&=$(u,n,t,r)}return a}var z=this.metalNamed.metal.isDef,K=this.metalNamed.metal.isDocument,Y=this.metalNamed.metal.isDocumentFragment,W=this.metalNamed.metal.isElement,Q=this.metalNamed.metal.isObject,J=this.metalNamed.metal.isString,Z=this.metalNamed.metal.object,X=this.metal.domData,ee=this.metal.DomDelegatedEventHandle,te=this.metal.DomEventHandle,ne={},re={},ae={};this.metalNamed.domNamed=this.metalNamed.domNamed||{},this.metalNamed.domNamed.customEvents=ae;var oe="__metal_last_container__",ie={blur:!0,error:!0,focus:!0,invalid:!0,load:!0,scroll:!0};this.metalNamed.domNamed.addClasses=e,this.metalNamed.domNamed.closest=s,this.metalNamed.domNamed.append=l,this.metalNamed.domNamed.buildFragment=u,this.metalNamed.domNamed.contains=c,this.metalNamed.domNamed.delegate=d,this.metalNamed.domNamed.enterDocument=g,this.metalNamed.domNamed.exitDocument=m,this.metalNamed.domNamed.hasClass=p,this.metalNamed.domNamed.isEmpty=_,this.metalNamed.domNamed.match=b,this.metalNamed.domNamed.next=N,this.metalNamed.domNamed.on=C,this.metalNamed.domNamed.once=k,this.metalNamed.domNamed.parent=R,this.metalNamed.domNamed.registerCustomEvent=D,this.metalNamed.domNamed.removeChildren=O,this.metalNamed.domNamed.removeClasses=A,this.metalNamed.domNamed.replace=T,this.metalNamed.domNamed.supportsEvent=H,this.metalNamed.domNamed.toElement=U,this.metalNamed.domNamed.toggleClasses=F,this.metalNamed.domNamed.triggerEvent=q}.call(this),function(){var e=this.metalNamed.domNamed;this.metal.dom=e,this.metalNamed.dom=this.metalNamed.dom||{},this.metalNamed.dom.dom=e,Object.keys(this.metalNamed.domNamed).forEach(function(e){this.metalNamed.dom[e]=this.metalNamed.domNamed[e]})}.call(this),function(){var e=this.metalNamed.dom.delegate,t=this.metalNamed.dom.on,n=this.metalNamed.dom.supportsEvent,r=this.metalNamed.events.EventEmitterProxy,a=function(r){function a(){return babelHelpers.classCallCheck(this,a),babelHelpers.possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return babelHelpers.inherits(a,r),babelHelpers.createClass(a,[{key:"addListener_",value:function(n,r){if(this.originEmitter_.addEventListener){if(this.isDelegateEvent_(n)){var o=n.indexOf(":",9),i=n.substring(9,o),s=n.substring(o+1);return e(this.originEmitter_,i,s,r)}return t(this.originEmitter_,n,r)}return babelHelpers.get(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"addListener_",this).call(this,n,r)}},{key:"isDelegateEvent_",value:function(e){return"delegate:"===e.substr(0,9)}},{key:"isSupportedDomEvent_",value:function(e){return!this.originEmitter_||!this.originEmitter_.addEventListener||(this.isDelegateEvent_(e)&&e.indexOf(":",9)!==-1||n(this.originEmitter_,e))}},{key:"shouldProxyEvent_",value:function(e){return babelHelpers.get(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"shouldProxyEvent_",this).call(this,e)&&this.isSupportedDomEvent_(e)}}]),a}(r);this.metal.DomEventEmitterProxy=a}.call(this),function(){var e=this.metalNamed.dom.append,t=this.metalNamed.metal.string,n=function(){function n(){babelHelpers.classCallCheck(this,n)}return babelHelpers.createClass(n,null,[{key:"checkAnimationEventName",value:function(){return void 0===n.animationEventName_&&(n.animationEventName_={animation:n.checkAnimationEventName_("animation"),transition:n.checkAnimationEventName_("transition")}),n.animationEventName_}},{key:"checkAnimationEventName_",value:function(e){for(var r=["Webkit","MS","O",""],a=t.replaceInterval(e,0,1,e.substring(0,1).toUpperCase()),o=[a+"End",a+"End",a+"End",e+"end"],i=0;i<r.length;i++)if(void 0!==n.animationElement_.style[r[i]+a])return r[i].toLowerCase()+o[i];return e+"end"}},{key:"checkAttrOrderChange",value:function(){if(void 0===n.attrOrderChange_){var t='<div data-component="" data-ref=""></div>',r=document.createElement("div");e(r,t),n.attrOrderChange_=t!==r.innerHTML}return n.attrOrderChange_}}]),n}();n.animationElement_=document.createElement("div"),n.animationEventName_=void 0,n.attrOrderChange_=void 0,this.metal.features=n}.call(this),function(){var e=this.metalNamed.metal.async,t=this.metalNamed.dom.exitDocument,n=this.metalNamed.dom.once,r=function(){function r(){babelHelpers.classCallCheck(this,r)}return babelHelpers.createClass(r,null,[{key:"run",value:function(e,n){var r=document.createElement("script");return r.text=e,n?n(r):document.head.appendChild(r),t(r),r}},{key:"runFile",value:function(e,r,a){var o=document.createElement("script");o.src=e;var i=function(){t(o),r&&r()};return n(o,"load",i),n(o,"error",i),a?a(o):document.head.appendChild(o),o}},{key:"runScript",value:function(n,a,o){var i=function(){a&&a()};return n.type&&"text/javascript"!==n.type?void e.nextTick(i):(t(n),n.src?r.runFile(n.src,a,o):(e.nextTick(i),r.run(n.text,o)))}},{key:"runScriptsInElement",value:function(t,n,a){var o=t.querySelectorAll("script");o.length?r.runScriptsInOrder(o,0,n,a):n&&e.nextTick(n)}},{key:"runScriptsInOrder",value:function(t,n,a,o){r.runScript(t.item(n),function(){n<t.length-1?r.runScriptsInOrder(t,n+1,a,o):a&&e.nextTick(a)},o)}}]),r}();this.metal.globalEval=r}.call(this),function(){var e=this.metalNamed.metal.async,t=this.metalNamed.dom.once,n=function(){function n(){babelHelpers.classCallCheck(this,n)}return babelHelpers.createClass(n,null,[{key:"run",value:function(e,t){var n=document.createElement("style");return n.innerHTML=e,t?t(n):document.head.appendChild(n),n}},{key:"runFile",value:function(e,t,r){var a=document.createElement("link");return a.rel="stylesheet",a.href=e,n.runStyle(a,t,r),a}},{key:"runStyle",value:function(n,r,a){var o=function(){r&&r()};return n.rel&&"stylesheet"!==n.rel?void e.nextTick(o):("STYLE"===n.tagName?e.nextTick(o):(t(n,"load",o),t(n,"error",o)),a?a(n):document.head.appendChild(n),n)}},{key:"runStylesInElement",value:function(t,r,a){var o=t.querySelectorAll("style,link");if(0===o.length&&r)return void e.nextTick(r);for(var i=0,s=function(){r&&++i===o.length&&e.nextTick(r)},l=0;l<o.length;l++)n.runStyle(o[l],s,a)}}]),n}();this.metal.globalEvalStyles=n}.call(this),function(){var e=this.metalNamed.dom.registerCustomEvent,t=this.metalNamed.dom.contains,n=this.metal.features,r={mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"};Object.keys(r).forEach(function(n){e(n,{delegate:!0,handler:function(e,r){var a=r.relatedTarget,o=r.delegateTarget;if(!a||a!==o&&!t(o,a))return r.customType=n,e(r)},originalEvent:r[n]})});var a={animation:"animationend",transition:"transitionend"};Object.keys(a).forEach(function(t){var r=a[t];e(r,{event:!0,delegate:!0,handler:function(e,t){return t.customType=r,e(t)},originalEvent:n.checkAnimationEventName()[t]})})}.call(this),function(){var e=this.metal.dom,t=this.metal.domData,n=this.metal.DomEventEmitterProxy,r=this.metal.DomEventHandle,a=this.metal.features,o=this.metal.globalEval,i=this.metal.globalEvalStyles;this.metalNamed.dom=this.metalNamed.dom||{},Object.keys(this.metalNamed.dom).forEach(function(e){this.metalNamed.dom[e]=this.metalNamed.dom[e]}),this.metalNamed.dom.domData=t,this.metalNamed.dom.DomEventEmitterProxy=n,this.metalNamed.dom.DomEventHandle=r,this.metalNamed.dom.features=a,this.metalNamed.dom.globalEval=o,this.metalNamed.dom.globalEvalStyles=i,this.metal.dom=e}.call(this),function(){var e=this.metalNamed.metal.isDef,t=this.metalNamed.metal.isFunction,n=this.metalNamed.metal.isObject,r=this.metalNamed.metal.async,a=function(){};a.prototype.then=function(){},a.IMPLEMENTED_BY_PROP="$goog_Thenable",a.addImplementation=function(e){e.prototype.then=e.prototype.then,e.prototype.$goog_Thenable=!0},a.isImplementedBy=function(e){if(!e)return!1;try{return!!e.$goog_Thenable}catch(t){return!1}};var o=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=t.slice();return n.push.apply(n,arguments),e.apply(this,n)}},i=function s(e,t){this.state_=s.State_.PENDING,this.result_=void 0,this.parent_=null,this.callbackEntries_=null,this.executing_=!1,s.UNHANDLED_REJECTION_DELAY>0?this.unhandledRejectionId_=0:0===s.UNHANDLED_REJECTION_DELAY&&(this.hadUnhandledRejection_=!1);try{var n=this;e.call(t,function(e){n.resolve_(s.State_.FULFILLED,e)},function(e){n.resolve_(s.State_.REJECTED,e)})}catch(r){this.resolve_(s.State_.REJECTED,r)}};i.UNHANDLED_REJECTION_DELAY=0,i.State_={PENDING:0,BLOCKED:1,FULFILLED:2,REJECTED:3},i.CallbackEntry_=null,i.resolve=function(e){return new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){e.length||t(void 0);for(var r,a=0;r=e[a];a++)r.then(t,n)})},i.all=function(e){return new i(function(t,n){var r=e.length,a=[];if(!r)return void t(a);for(var i,s=function(e,n){r--,a[e]=n,0===r&&t(a)},l=function(e){n(e)},u=0;i=e[u];u++)i.then(o(s,u),l)})},i.firstFulfilled=function(e){return new i(function(t,n){var r=e.length,a=[];if(!r)return void t(void 0);for(var i,s=function(e){t(e)},l=function(e,t){r--,a[e]=t,0===r&&n(a)},u=0;i=e[u];u++)i.then(s,o(l,u))})},i.prototype.then=function(e,n,r){return this.addChildPromise_(t(e)?e:null,t(n)?n:null,r)},a.addImplementation(i),i.prototype.thenAlways=function(e,t){var n=function(){try{e.call(t)}catch(n){i.handleRejection_.call(null,n)}};return this.addCallbackEntry_({child:null,onRejected:n,onFulfilled:n}),this},i.prototype.thenCatch=function(e,t){return this.addChildPromise_(null,e,t)},i.prototype["catch"]=i.prototype.thenCatch,i.prototype.cancel=function(e){this.state_===i.State_.PENDING&&r.run(function(){var t=new i.CancellationError(e);t.IS_CANCELLATION_ERROR=!0,this.cancelInternal_(t)},this)},i.prototype.cancelInternal_=function(e){this.state_===i.State_.PENDING&&(this.parent_?this.parent_.cancelChild_(this,e):this.resolve_(i.State_.REJECTED,e))},i.prototype.cancelChild_=function(e,t){if(this.callbackEntries_){for(var n,r=0,a=-1,o=0;n=this.callbackEntries_[o];o++){var s=n.child;if(s&&(r++,s===e&&(a=o),a>=0&&r>1))break}if(a>=0)if(this.state_===i.State_.PENDING&&1===r)this.cancelInternal_(t);else{var l=this.callbackEntries_.splice(a,1)[0];this.executeCallback_(l,i.State_.REJECTED,t)}}},i.prototype.addCallbackEntry_=function(e){this.callbackEntries_&&this.callbackEntries_.length||this.state_!==i.State_.FULFILLED&&this.state_!==i.State_.REJECTED||this.scheduleCallbacks_(),this.callbackEntries_||(this.callbackEntries_=[]),this.callbackEntries_.push(e)},i.prototype.addChildPromise_=function(t,n,r){var a={child:null,onFulfilled:null,onRejected:null};return a.child=new i(function(o,i){a.onFulfilled=t?function(e){try{var n=t.call(r,e);o(n)}catch(a){i(a)}}:o,a.onRejected=n?function(t){try{var a=n.call(r,t);!e(a)&&t.IS_CANCELLATION_ERROR?i(t):o(a)}catch(s){i(s)}}:i}),a.child.parent_=this,this.addCallbackEntry_(a),a.child},i.prototype.unblockAndFulfill_=function(e){if(this.state_!==i.State_.BLOCKED)throw new Error("CancellablePromise is not blocked.");this.state_=i.State_.PENDING,this.resolve_(i.State_.FULFILLED,e)},i.prototype.unblockAndReject_=function(e){if(this.state_!==i.State_.BLOCKED)throw new Error("CancellablePromise is not blocked.");this.state_=i.State_.PENDING,this.resolve_(i.State_.REJECTED,e)},i.prototype.resolve_=function(e,r){if(this.state_===i.State_.PENDING){if(this===r)e=i.State_.REJECTED,r=new TypeError("CancellablePromise cannot resolve to itself");else{if(a.isImplementedBy(r))return r=r,this.state_=i.State_.BLOCKED,void r.then(this.unblockAndFulfill_,this.unblockAndReject_,this);if(n(r))try{var o=r.then;if(t(o))return void this.tryThen_(r,o)}catch(s){e=i.State_.REJECTED,r=s}}this.result_=r,this.state_=e,this.scheduleCallbacks_(),e!==i.State_.REJECTED||r.IS_CANCELLATION_ERROR||i.addUnhandledRejection_(this,r)}},i.prototype.tryThen_=function(e,t){this.state_=i.State_.BLOCKED;var n=this,r=!1,a=function(e){r||(r=!0,n.unblockAndFulfill_(e))},o=function(e){r||(r=!0,n.unblockAndReject_(e))};try{t.call(e,a,o)}catch(s){o(s)}},i.prototype.scheduleCallbacks_=function(){this.executing_||(this.executing_=!0,r.run(this.executeCallbacks_,this))},i.prototype.executeCallbacks_=function(){for(;this.callbackEntries_&&this.callbackEntries_.length;){var e=this.callbackEntries_;this.callbackEntries_=[];for(var t=0;t<e.length;t++)this.executeCallback_(e[t],this.state_,this.result_)}this.executing_=!1},i.prototype.executeCallback_=function(e,t,n){t===i.State_.FULFILLED?e.onFulfilled(n):(this.removeUnhandledRejection_(),e.onRejected(n))},i.prototype.removeUnhandledRejection_=function(){var e;if(i.UNHANDLED_REJECTION_DELAY>0)for(e=this;e&&e.unhandledRejectionId_;e=e.parent_)clearTimeout(e.unhandledRejectionId_),e.unhandledRejectionId_=0;else if(0===i.UNHANDLED_REJECTION_DELAY)for(e=this;e&&e.hadUnhandledRejection_;e=e.parent_)e.hadUnhandledRejection_=!1},i.addUnhandledRejection_=function(e,t){i.UNHANDLED_REJECTION_DELAY>0?e.unhandledRejectionId_=setTimeout(function(){i.handleRejection_.call(null,t)},i.UNHANDLED_REJECTION_DELAY):0===i.UNHANDLED_REJECTION_DELAY&&(e.hadUnhandledRejection_=!0,r.run(function(){e.hadUnhandledRejection_&&i.handleRejection_.call(null,t)}))},i.handleRejection_=r.throwException,i.setUnhandledRejectionHandler=function(e){i.handleRejection_=e},i.CancellationError=function(e){function t(e){babelHelpers.classCallCheck(this,t);var n=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return e&&(n.message=e),n}return babelHelpers.inherits(t,e),t}(Error),i.CancellationError.prototype.name="cancel",this.metalNamed.Promise=this.metalNamed.Promise||{},this.metalNamed.Promise.CancellablePromise=i,this.metal.Promise=i}.call(this),function(){function e(e,n){return function r(){var a=arguments;t(r),r.id=setTimeout(function(){e.apply(null,a)},n)}}function t(e){clearTimeout(e.id)}this.metal.debounce=e,this.metalNamed.debounce=this.metalNamed.debounce||{},this.metalNamed.debounce.cancelDebounce=t,this.metalNamed.debounce.debounce=e}.call(this),function(){function e(e){return{match:e[0],prefix:e[1],name:e[2],paramPattern:e[3],unnamedPattern:e[4],modifier:e[5]}}function t(e){for(var t="",o=0;o<e.length;o++)if(l.isString(e[o]))t+=r(e[o]);else{var i=n(e[o].pattern);e[o].repeat&&(i+=n("\\/"+i)+"*"),i=r(e[o].prefix)+("("+i+")"),e[o].optional&&(e[o].partial||(i=n(i)),i+="?"),t+=i}return new RegExp("^"+a(t)+"$")}function n(e){return"(?:"+e+")"}function r(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function a(e){return e+=/\/$/.test(e)?"?":"\\/?"}function o(t){if(!l.isString(t))return t;for(var n=t,r=0,a=[],o="",i=0,s=u.exec(n);s;){var c=e(s);o=n.slice(i,s.index),i=s.index+c.match.length,a.push(o),a.push({name:c.name?c.name:""+r++,partial:n[i]&&n[i]!==c.prefix,prefix:c.prefix||"",pattern:c.paramPattern||c.unnamedPattern||"[^\\/]+",repeat:"*"===c.modifier||"+"===c.modifier,optional:"*"===c.modifier||"?"===c.modifier}),s=u.exec(n)}return i<n.length&&a.push(n.substr(i)),a}function i(e){return t(o(e))}function s(e,n){var r={},a=o(e),i=n.match(t(a));if(!i)return null;for(var s=1,u=0;u<a.length;u++)if(!l.isString(a[u])){var c=i[s++];l.isDef(c)&&(a[u].repeat&&(c=c.split("/")),r[a[u].name]=c)}return r}var l=this.metal.metal,u=/([\/])?(?:(?:\:(\w+)(?:\(((?:\\.|[^\\()])*)\))?|\(((?:\\.|[^\\()])+)\))([+*?])?)/g;this.metalNamed.pathParser=this.metalNamed.pathParser||{},this.metalNamed.pathParser.parse=o,this.metalNamed.pathParser.toRegex=i,this.metalNamed.pathParser.extractData=s}.call(this),function(){var e=this.metalNamed.metal.isDefAndNotNull,t=this.metalNamed.metal.isFunction,n=this.metalNamed.metal.isString,r=this.metalNamed.pathParser.extractData,a=this.metalNamed.pathParser.parse,o=this.metalNamed.pathParser.toRegex,i=function(){function i(n,r){if(babelHelpers.classCallCheck(this,i),!e(n))throw new Error("Route path not specified.");if(!t(r))throw new Error("Route handler is not a function.");this.handler=r,this.path=n}return babelHelpers.createClass(i,[{key:"buildParsedData_",value:function(){if(!this.parsedData_){var e=a(this.path),t=o(e);this.parsedData_={regex:t,tokens:e}}return this.parsedData_}},{key:"extractParams",value:function(e){return n(this.path)?r(this.buildParsedData_().tokens,e):{}}},{key:"getHandler",value:function(){return this.handler}},{key:"getPath",value:function(){return this.path}},{key:"matchesPath",value:function(e){var r=this.path;return t(r)?r(e):(n(r)&&(r=this.buildParsedData_().regex),r instanceof RegExp&&e.search(r)>-1)}}]),i}();this.metal.Route=i}.call(this),function(){var e=this.metalNamed.metal.Disposable,t=function(e){function t(){babelHelpers.classCallCheck(this,t);var e=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.cache=null,e.cacheable=!1,e}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"addCache",value:function(e){return this.cacheable&&(this.cache=e),this}},{key:"clearCache",value:function(){return this.cache=null,this}},{key:"disposeInternal",value:function(){this.clearCache()}},{key:"getCache",value:function(){return this.cache}},{key:"isCacheable",value:function(){return this.cacheable}},{key:"setCacheable",value:function(e){e||this.clearCache(),this.cacheable=e}}]),t}(e);this.metal.Cacheable=t}.call(this),function(){var e=this.metalNamed.metal.getUid,t=this.metalNamed.dom.globalEval,n=this.metal.Cacheable,r=this.metal.Promise,a=function(n){function a(){babelHelpers.classCallCheck(this,a);var t=babelHelpers.possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return t.id=t.makeId_(e()),t.title=null,t}return babelHelpers.inherits(a,n),babelHelpers.createClass(a,[{key:"activate",value:function(){}},{key:"beforeDeactivate",value:function(){}},{key:"beforeUpdateHistoryPath",value:function(e){return e}},{key:"beforeUpdateHistoryState",value:function(e){return e}},{key:"deactivate",value:function(){}},{key:"disposeInternal",value:function(){babelHelpers.get(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"disposeInternal",this).call(this)}},{key:"evaluateScripts",value:function(e){return Object.keys(e).forEach(function(n){e[n].activeChild&&t.runScriptsInElement(e[n].activeChild)}),r.resolve()}},{key:"evaluateStyles",value:function(){return r.resolve()}},{key:"flip",value:function(e){var t=this,n=[];return Object.keys(e).forEach(function(r){var a=e[r],o=a.show(t.id);n.push(o)}),r.all(n)}},{key:"getId",value:function(){return this.id}},{key:"getSurfaceContent",value:function(){}},{key:"getTitle",value:function(){return this.title}},{key:"load",value:function(){return r.resolve()}},{key:"makeId_",value:function(e){return"screen_"+e}},{key:"setId",value:function(e){this.id=e}},{key:"setTitle",value:function(e){this.title=e}},{key:"toString",value:function(){return this.id}}]),a}(n);a.isImplementedBy=function(e){return e instanceof a},this.metal.Screen=a}.call(this),function(){var e=this.metal.globals,t=this.metalNamed.metal.Disposable,n=this.metalNamed.metal.isDefAndNotNull,r=this.metalNamed.dom.append,a=this.metalNamed.dom.removeChildren,o=this.metalNamed.dom.exitDocument,i=this.metal.Promise,s=function(t){function s(e){babelHelpers.classCallCheck(this,s);var t=babelHelpers.possibleConstructorReturn(this,(s.__proto__||Object.getPrototypeOf(s)).call(this));if(!e)throw new Error("Surface element id not specified. A surface element requires a valid id.");return t.activeChild=null,t.defaultChild=null,t.element=null,t.id=e,t.transitionFn=null,t.defaultChild=t.getChild(s.DEFAULT),t.maybeWrapContentAsDefault_(),t.activeChild=t.defaultChild,t}return babelHelpers.inherits(s,t),babelHelpers.createClass(s,[{key:"addContent",value:function(e,t){var o=this.defaultChild;n(t)&&(o=this.getChild(e),o?a(o):(o=this.createChild(e),this.transition(o,null)),r(o,t));var i=this.getElement();return i&&o&&r(i,o),o}},{key:"createChild",value:function(t){var n=e.document.createElement("div");return n.setAttribute("id",this.makeId_(t)),n}},{key:"getChild",value:function(t){return e.document.getElementById(this.makeId_(t))}},{key:"getElement",value:function(){return this.element?this.element:(this.element=e.document.getElementById(this.id),this.element)}},{key:"getId",value:function(){return this.id}},{key:"getTransitionFn",value:function(){return this.transitionFn}},{key:"makeId_",value:function(e){return this.id+"-"+e}},{key:"maybeWrapContentAsDefault_",value:function(){var t=this.getElement();if(t&&!this.defaultChild){for(var n=e.document.createDocumentFragment();t.firstChild;)n.appendChild(t.firstChild);this.defaultChild=this.addContent(s.DEFAULT,n),this.transition(null,this.defaultChild)}}},{key:"setId",value:function(e){this.id=e}},{key:"setTransitionFn",value:function(e){this.transitionFn=e}},{key:"show",value:function(e){var t=this.activeChild,n=this.getChild(e);return n||(n=this.defaultChild),this.activeChild=n,this.transition(t,n).thenAlways(function(){t&&t!==n&&o(t)})}},{key:"remove",value:function(e){var t=this.getChild(e);t&&o(t)}},{key:"toString",value:function(){return this.id}},{key:"transition",value:function(e,t){var n=this.transitionFn||s.defaultTransition;return i.resolve(n.call(this,e,t))}}]),s}(t);s.DEFAULT="default",s.defaultTransition=function(e,t){e&&(e.style.display="none",e.classList.remove("flipped")),t&&(t.style.display="block",t.classList.add("flipped"))},this.metal.Surface=s}.call(this),function(){var e=this.metalNamed.dom.addClasses,t=this.metalNamed.dom.delegate,n=this.metalNamed.dom.match,r=this.metalNamed.dom.on,a=this.metalNamed.dom.removeClasses,o=this.metalNamed.metal.array,i=this.metalNamed.metal.async,s=this.metalNamed.metal.isDefAndNotNull,l=this.metalNamed.metal.isString,u=this.metalNamed.events.EventEmitter,c=this.metalNamed.events.EventHandler,d=this.metal.Promise,h=this.metal.debounce,g=this.metal.globals,m=this.metal.Route,f=this.metal.Screen,p=this.metal.Surface,v=this.metal.Uri,y=this.metal.utils,_=function(u){function _(){babelHelpers.classCallCheck(this,_);var e=babelHelpers.possibleConstructorReturn(this,(_.__proto__||Object.getPrototypeOf(_)).call(this));return e.activeScreen=null,e.activePath=null,e.allowPreventNavigate=!0,e.basePath="",e.browserPathBeforeNavigate=y.getCurrentBrowserPathWithoutHash(),e.captureScrollPositionFromScrollEvent=!0,e.defaultTitle=g.document.title,e.formSelector='form[enctype="multipart/form-data"]:not([data-senna-off])',e.ignoreQueryStringFromRoutePath=!1,e.linkSelector='a:not([data-senna-off]):not([target="_blank"])',e.loadingCssClass="senna-loading",e.nativeScrollRestorationSupported="scrollRestoration"in g.window.history,e.isNavigationPending=!1,e.pendingNavigate=null,e.popstateScrollLeft=0,e.popstateScrollTop=0,e.redirectPath=null,e.routes=[],e.screens={},e.skipLoadPopstate=!1,e.surfaces={},e.updateScrollPosition=!0,e.appEventHandlers_=new c,e.appEventHandlers_.add(r(g.window,"scroll",h(e.onScroll_.bind(e),100)),r(g.window,"load",e.onLoad_.bind(e)),r(g.window,"popstate",e.onPopstate_.bind(e))),e.on("startNavigate",e.onStartNavigate_),e.on("beforeNavigate",e.onBeforeNavigate_),e.on("beforeNavigate",e.onBeforeNavigateDefault_,!0),e.setLinkSelector(e.linkSelector),e.setFormSelector(e.formSelector),e}return babelHelpers.inherits(_,u),babelHelpers.createClass(_,[{key:"addRoutes",value:function(e){var t=this;return Array.isArray(e)||(e=[e]),e.forEach(function(e){e instanceof m||(e=new m(e.path,e.handler)),t.routes.push(e)}),this}},{key:"addSurfaces",value:function(e){var t=this;return Array.isArray(e)||(e=[e]),e.forEach(function(e){l(e)&&(e=new p(e)),t.surfaces[e.getId()]=e}),this}},{key:"canNavigate",value:function(e){var t=y.isWebUri(e);if(!t)return!1;var n=y.getUrlPath(e);return!!this.isLinkSameOrigin_(t.getHostname())&&(!!this.isSameBasePath_(n)&&((!t.getHash()||!y.isCurrentBrowserPath(n))&&!!this.findRoute(n)))}},{key:"clearScreensCache",value:function(){var e=this;Object.keys(this.screens).forEach(function(t){t===e.activePath?e.activeScreen.clearCache():e.removeScreen(t)})}},{key:"createScreenInstance",value:function(e,t){if(!this.pendingNavigate&&e===this.activePath)return this.activeScreen;var n=this.screens[e];if(!n){var r=t.getHandler();n=r===f||f.isImplementedBy(r.prototype)?new r:r(t)||new f}return n}},{key:"disposeInternal",value:function(){this.activeScreen&&this.removeScreen(this.activePath),this.clearScreensCache(),this.formEventHandler_.removeListener(),this.linkEventHandler_.removeListener(),this.appEventHandlers_.removeAllListeners(),babelHelpers.get(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"disposeInternal",this).call(this)}},{key:"dispatch",value:function(){return this.navigate(y.getCurrentBrowserPath(),!0)}},{key:"doNavigate_",value:function(e,t){var n=this;if(this.activeScreen&&this.activeScreen.beforeDeactivate())return this.pendingNavigate=d.reject(new d.CancellationError("Cancelled by active screen")),this.pendingNavigate;var r=this.findRoute(e);if(!r)return this.pendingNavigate=d.reject(new d.CancellationError("No route for "+e)),this.pendingNavigate;this.stopPendingNavigate_(),this.isNavigationPending=!0;var a=this.createScreenInstance(e,r);return a.load(e).then(function(){n.activeScreen&&n.activeScreen.deactivate(),n.prepareNavigateHistory_(e,a,t),n.prepareNavigateSurfaces_(a,n.surfaces,n.extractParams(r,e))}).then(function(){return a.evaluateStyles(n.surfaces)}).then(function(){return a.flip(n.surfaces)}).then(function(){return a.evaluateScripts(n.surfaces)}).then(function(){return n.maybeUpdateScrollPositionState_()}).then(function(){return n.syncScrollPositionSyncThenAsync_()}).then(function(){return n.finalizeNavigate_(e,a)})["catch"](function(t){throw n.isNavigationPending=!1,n.handleNavigateError_(e,a,t),t})}},{key:"extractParams",value:function(e,t){return e.extractParams(this.getRoutePath(t))}},{key:"finalizeNavigate_",value:function(e,t){t.activate(),this.activeScreen&&!this.activeScreen.isCacheable()&&this.activeScreen!==t&&this.removeScreen(this.activePath),this.activePath=e,this.activeScreen=t,this.browserPathBeforeNavigate=y.getCurrentBrowserPathWithoutHash(),this.screens[e]=t,this.isNavigationPending=!1,this.pendingNavigate=null,g.capturedFormElement=null,g.capturedFormButtonElement=null}},{key:"findRoute",value:function(e){e=this.getRoutePath(e);for(var t=0;t<this.routes.length;t++){var n=this.routes[t];if(n.matchesPath(e))return n}return null}},{key:"getAllowPreventNavigate",value:function(){return this.allowPreventNavigate}},{key:"getBasePath",value:function(){return this.basePath}},{key:"getDefaultTitle",value:function(){return this.defaultTitle}},{key:"getFormSelector",value:function(){return this.formSelector}},{key:"getIgnoreQueryStringFromRoutePath",value:function(){return this.ignoreQueryStringFromRoutePath}},{key:"getLinkSelector",value:function(){return this.linkSelector}},{key:"getLoadingCssClass",value:function(){return this.loadingCssClass}},{key:"getRoutePath",value:function(e){return this.getIgnoreQueryStringFromRoutePath()?(e=y.getUrlPathWithoutHashAndSearch(e),y.getUrlPathWithoutHashAndSearch(e.substr(this.basePath.length))):(e=y.getUrlPathWithoutHash(e),y.getUrlPathWithoutHash(e.substr(this.basePath.length)))}},{key:"getUpdateScrollPosition",value:function(){return this.updateScrollPosition}},{key:"handleNavigateError_",value:function(e,t,n){var r=this;this.emit("navigationError",{error:n,nextScreen:t,path:e}),y.isCurrentBrowserPath(e)||(this.isNavigationPending&&this.pendingNavigate?this.pendingNavigate.thenAlways(function(){return r.removeScreen(e)},this):this.removeScreen(e))}},{key:"hasRoutes",value:function(){return this.routes.length>0}},{key:"isLinkSameOrigin_",value:function(e){return e===g.window.location.hostname}},{key:"isSameBasePath_",value:function(e){return 0===e.indexOf(this.basePath)}},{key:"lockHistoryScrollPosition_",value:function(){var e=g.window.history.state;if(e){var t=!1,n=function r(){g.document.removeEventListener("scroll",r,!1),t||(g.window.scrollTo(e.scrollLeft,e.scrollTop),t=!0)};i.nextTick(n),g.document.addEventListener("scroll",n,!1)}}},{key:"maybeDisableNativeScrollRestoration",value:function(){this.nativeScrollRestorationSupported&&(this.nativeScrollRestoration_=g.window.history.scrollRestoration,g.window.history.scrollRestoration="manual")}},{key:"maybeNavigate_",value:function(e,t){if(this.canNavigate(e)){g.capturedFormElement=t.capturedFormElement,g.capturedFormButtonElement=t.capturedFormButtonElement;var n=!1;try{this.navigate(y.getUrlPath(e),!1,t)}catch(r){n=!0}n||t.preventDefault()}}},{key:"maybeRepositionScrollToHashedAnchor",value:function(){var e=g.window.location.hash;if(e){var t=g.document.getElementById(e.substring(1));if(t){var n=y.getNodeOffset(t),r=n.offsetLeft,a=n.offsetTop;g.window.scrollTo(r,a)}}}},{key:"maybeRestoreNativeScrollRestoration",value:function(){this.nativeScrollRestorationSupported&&this.nativeScrollRestoration_&&(g.window.history.scrollRestoration=this.nativeScrollRestoration_)}},{key:"maybeRestoreRedirectPathHash_",value:function(e,t,n){return t===y.getUrlPathWithoutHash(e)?t+n:t}},{key:"maybeUpdateScrollPositionState_",value:function(){var e=g.window.location.hash,t=g.document.getElementById(e.substring(1));if(t){var n=y.getNodeOffset(t),r=n.offsetLeft,a=n.offsetTop;
this.saveHistoryCurrentPageScrollPosition_(a,r)}}},{key:"navigate",value:function(e,t,n){if(!y.isHtml5HistorySupported())throw new Error("HTML5 History is not supported. Senna will not intercept navigation.");return e===this.activePath&&(t=!0),this.emit("beforeNavigate",{event:n,path:e,replaceHistory:!!t}),this.pendingNavigate}},{key:"onBeforeNavigate_",value:function(e){g.capturedFormElement&&(e.form=g.capturedFormElement)}},{key:"onBeforeNavigateDefault_",value:function(e){this.pendingNavigate&&this.pendingNavigate.path===e.path||this.emit("startNavigate",{form:e.form,path:e.path,replaceHistory:e.replaceHistory})}},{key:"onDocClickDelegate_",value:function(e){e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||e.button||this.maybeNavigate_(e.delegateTarget.href,e)}},{key:"onDocSubmitDelegate_",value:function(e){var t=e.delegateTarget;if("get"!==t.method){e.capturedFormElement=t;var r="button:not([type]),button[type=submit],input[type=submit]";n(g.document.activeElement,r)?e.capturedFormButtonElement=g.document.activeElement:e.capturedFormButtonElement=t.querySelector(r),this.maybeNavigate_(t.action,e)}}},{key:"onLoad_",value:function(){var e=this;this.skipLoadPopstate=!0,setTimeout(function(){e.skipLoadPopstate=!1},0),this.maybeRepositionScrollToHashedAnchor()}},{key:"onPopstate_",value:function(e){if(!this.skipLoadPopstate){if(y.isCurrentBrowserPath(this.browserPathBeforeNavigate))return void this.maybeRepositionScrollToHashedAnchor();var t=e.state;return t?void(t.senna&&(this.popstateScrollTop=t.scrollTop,this.popstateScrollLeft=t.scrollLeft,this.nativeScrollRestorationSupported||this.lockHistoryScrollPosition_(),this.navigate(t.path,!0))):void(g.window.location.hash?(this.redirectPath&&!y.isCurrentBrowserPath(this.redirectPath)&&this.reloadPage(),this.maybeRepositionScrollToHashedAnchor()):this.reloadPage())}}},{key:"onScroll_",value:function(){this.captureScrollPositionFromScrollEvent&&this.saveHistoryCurrentPageScrollPosition_(g.window.pageYOffset,g.window.pageXOffset)}},{key:"onStartNavigate_",value:function(t){var n=this;this.maybeDisableNativeScrollRestoration(),this.captureScrollPositionFromScrollEvent=!1,e(g.document.documentElement,this.loadingCssClass);var r={form:t.form,path:t.path};this.pendingNavigate=this.doNavigate_(t.path,t.replaceHistory)["catch"](function(e){throw r.error=e,e}).thenAlways(function(){n.pendingNavigate||(a(g.document.documentElement,n.loadingCssClass),n.maybeRestoreNativeScrollRestoration(),n.captureScrollPositionFromScrollEvent=!0),n.emit("endNavigate",r)}),this.pendingNavigate.path=t.path}},{key:"prefetch",value:function(e){var t=this,n=this.findRoute(e);if(!n)return d.reject(new d.CancellationError("No route for "+e));var r=this.createScreenInstance(e,n);return r.load(e).then(function(){return t.screens[e]=r})["catch"](function(n){throw t.handleNavigateError_(e,r,n),n})}},{key:"prepareNavigateHistory_",value:function(e,t,n){var r=t.getTitle();l(r)||(r=this.getDefaultTitle());var a=t.beforeUpdateHistoryPath(e),o={form:s(g.capturedFormElement),path:e,redirectPath:a,scrollLeft:0,scrollTop:0,senna:!0};n&&(o.scrollTop=this.popstateScrollTop,o.scrollLeft=this.popstateScrollLeft);var i=new v(e).getHash();a=this.maybeRestoreRedirectPathHash_(e,a,i),this.updateHistory_(r,a,t.beforeUpdateHistoryState(o),n),this.redirectPath=a}},{key:"prepareNavigateSurfaces_",value:function(e,t,n){Object.keys(t).forEach(function(r){var a=e.getSurfaceContent(r,n);t[r].addContent(e.getId(),a)})}},{key:"reloadPage",value:function(){g.window.location.reload()}},{key:"removeRoute",value:function(e){return o.remove(this.routes,e)}},{key:"removeScreen",value:function(e){var t=this,n=this.screens[e];n&&(Object.keys(this.surfaces).forEach(function(e){return t.surfaces[e].remove(n.getId())}),n.dispose(),delete this.screens[e])}},{key:"saveHistoryCurrentPageScrollPosition_",value:function(e,t){var n=g.window.history.state;if(n&&n.senna){var r=[e,t];n.scrollTop=r[0],n.scrollLeft=r[1],g.window.history.replaceState(n,null,null)}}},{key:"setAllowPreventNavigate",value:function(e){this.allowPreventNavigate=e}},{key:"setBasePath",value:function(e){this.basePath=y.removePathTrailingSlash(e)}},{key:"setDefaultTitle",value:function(e){this.defaultTitle=e}},{key:"setFormSelector",value:function(e){this.formSelector=e,this.formEventHandler_&&this.formEventHandler_.removeListener(),this.formEventHandler_=t(document,"submit",this.formSelector,this.onDocSubmitDelegate_.bind(this),this.allowPreventNavigate)}},{key:"setIgnoreQueryStringFromRoutePath",value:function(e){this.ignoreQueryStringFromRoutePath=e}},{key:"setLinkSelector",value:function(e){this.linkSelector=e,this.linkEventHandler_&&this.linkEventHandler_.removeListener(),this.linkEventHandler_=t(document,"click",this.linkSelector,this.onDocClickDelegate_.bind(this),this.allowPreventNavigate)}},{key:"setLoadingCssClass",value:function(e){this.loadingCssClass=e}},{key:"setUpdateScrollPosition",value:function(e){this.updateScrollPosition=e}},{key:"stopPendingNavigate_",value:function(){this.pendingNavigate&&(this.pendingNavigate.cancel("Cancel pending navigation"),this.pendingNavigate=null)}},{key:"syncScrollPositionSyncThenAsync_",value:function(){var e=this,t=g.window.history.state;if(t){var n=t.scrollTop,r=t.scrollLeft,a=function(){e.updateScrollPosition&&g.window.scrollTo(r,n)};return new d(function(e){return a()&i.nextTick(function(){return a()&e()})})}}},{key:"updateHistory_",value:function(e,t,n,r){r?g.window.history.replaceState(n,e,t):g.window.history.pushState(n,e,t);var a=g.document.querySelector("title");a?a.innerHTML=e:g.document.title=e}}]),_}(u);this.metal.App=_}.call(this),function(){var e=this.metalNamed.metal.isDef,t=this.metalNamed.metal.isDefAndNotNull,n=this.metal.Uri,r=this.metalNamed.Promise.CancellablePromise,a=function(){function a(){babelHelpers.classCallCheck(this,a)}return babelHelpers.createClass(a,null,[{key:"parseResponseHeaders",value:function(e){var t=[];if(!e)return t;for(var n=e.split("\r\n"),r=0;r<n.length;r++){var a=n[r].indexOf(": ");if(a>0){var o=n[r].substring(0,a),i=n[r].substring(a+2);t.push({name:o,value:i})}}return t}},{key:"request",value:function o(a,i,s,l,u,c,d,h){a=a||"",i=i||"GET";var o=new XMLHttpRequest,g=0,m=new r(function(e,t){o.onload=function(){return o.aborted?void o.onerror():void e(o)},o.onreadystatechange=function(){g&&g<3&&4===o.readyState&&(o.terminatedPrematurely=!0),g=o.readyState},o.onerror=function(){var e="Request error";o.terminatedPrematurely&&(e="Request terminated prematurely");var n=new Error(e);n.request=o,t(n)}}).thenCatch(function(e){throw o.abort(),e}).thenAlways(function(){clearTimeout(f)});if(a=new n(a),u&&a.addParametersFromMultiMap(u).toString(),a=a.toString(),o.open(i,a,!d),h&&(o.withCredentials=!0),l&&l.names().forEach(function(e){o.setRequestHeader(e,l.getAll(e).join(", "))}),o.send(e(s)?s:null),t(c))var f=setTimeout(function(){m.cancel("Request timeout")},c);return m}}]),a}();this.metal.Ajax=a}.call(this),function(){var e=function t(){babelHelpers.classCallCheck(this,t)};e.INVALID_STATUS="Invalid status code",e.REQUEST_ERROR="Request error",e.REQUEST_TIMEOUT="Request timeout",e.REQUEST_PREMATURE_TERMINATION="Request terminated prematurely",this.metal.errors=e}.call(this),function(){var e=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"getNativeUserAgent",value:function(){var t=e.globals.window.navigator;if(t){var n=t.userAgent;if(n)return n}return""}},{key:"getNativePlatform",value:function(){var t=e.globals.window.navigator;if(t){var n=t.platform;if(n)return n}return""}},{key:"matchPlatform",value:function(t){return e.platform.indexOf(t)!==-1}},{key:"matchUserAgent",value:function(t){return e.userAgent.indexOf(t)!==-1}},{key:"testUserAgent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.userAgent=t,e.platform=n,e.isMac=e.matchPlatform("Mac"),e.isWin=e.matchPlatform("Win"),e.isOpera=e.matchUserAgent("Opera")||e.matchUserAgent("OPR"),e.isIe=e.matchUserAgent("Trident")||e.matchUserAgent("MSIE"),e.isEdge=e.matchUserAgent("Edge"),e.isIeOrEdge=e.isIe||e.isEdge,e.isChrome=(e.matchUserAgent("Chrome")||e.matchUserAgent("CriOS"))&&!e.isOpera&&!e.isEdge,e.isSafari=e.matchUserAgent("Safari")&&!(e.isChrome||e.isOpera||e.isEdge),e.isFirefox=e.matchUserAgent("Firefox")}}]),e}();e.globals={window:window},e.testUserAgent(e.getNativeUserAgent(),e.getNativePlatform()),this.metal.UA=e}.call(this),function(){var e=this.metalNamed.metal.isDefAndNotNull,t=this.metal.Ajax,n=this.metalNamed.structs.MultiMap,r=this.metal.Promise,a=this.metal.errors,o=this.metal.utils,i=this.metal.globals,s=this.metal.Screen,l=this.metal.Uri,u=this.metal.UA,c=function(s){function c(){babelHelpers.classCallCheck(this,c);var e=babelHelpers.possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));return e.cacheable=!0,e.httpHeaders={"X-PJAX":"true","X-Requested-With":"XMLHttpRequest"},e.httpMethod=c.GET,e.request=null,e.timeout=3e4,e}return babelHelpers.inherits(c,s),babelHelpers.createClass(c,[{key:"assertValidResponseStatusCode",value:function(e){if(!this.isValidResponseStatusCode(e)){var t=new Error(a.INVALID_STATUS);throw t.invalidStatus=!0,t.statusCode=e,t}}},{key:"beforeUpdateHistoryPath",value:function(e){var t=this.getRequestPath();return t&&t!==e?t:e}},{key:"beforeUpdateHistoryState",value:function(e){return e.senna&&e.form&&e.redirectPath===e.path?null:e}},{key:"formatLoadPath",value:function(e){var t=new l(e);return t.setHostname(i.window.location.hostname),t.setProtocol(i.window.location.protocol),i.window.location.port&&t.setPort(i.window.location.port),u.isIeOrEdge&&this.httpMethod===c.GET?t.makeUnique().toString():t.toString()}},{key:"getHttpHeaders",value:function(){return this.httpHeaders}},{key:"getHttpMethod",value:function(){return this.httpMethod}},{key:"getRequestPath",value:function(){var e=this.getRequest();if(e){var t=e.requestPath,n=this.maybeExtractResponseUrlFromRequest(e);return n&&(t=n),u.isIeOrEdge&&this.httpMethod===c.GET&&(t=new l(t).removeUnique().toString()),o.getUrlPath(t)}return null}},{key:"getRequest",value:function(){return this.request}},{key:"getTimeout",value:function(){return this.timeout}},{key:"isValidResponseStatusCode",value:function(e){return e>=200&&e<=399}},{key:"load",value:function(o){var s=this,l=this.getCache();if(e(l))return r.resolve(l);var d=null,h=this.httpMethod,g=new n;Object.keys(this.httpHeaders).forEach(function(e){return g.add(e,s.httpHeaders[e])}),i.capturedFormElement&&(d=new FormData(i.capturedFormElement),this.maybeAppendSubmitButtonValue_(d),h=c.POST,u.isIeOrEdge&&g.add("If-None-Match",'"0"'));var m=this.formatLoadPath(o);return t.request(m,h,d,g,null,this.timeout).then(function(e){return s.setRequest(e),s.assertValidResponseStatusCode(e.status),h===c.GET&&s.isCacheable()&&s.addCache(e.responseText),e.requestPath=m,e.responseText})["catch"](function(e){switch(e.message){case a.REQUEST_TIMEOUT:e.timeout=!0;break;case a.REQUEST_ERROR:e.requestError=!0;break;case a.REQUEST_PREMATURE_TERMINATION:e.requestError=!0,e.requestPrematureTermination=!0}throw e})}},{key:"maybeAppendSubmitButtonValue_",value:function(e){var t=i.capturedFormButtonElement;t&&t.name&&e.append(t.name,t.value)}},{key:"maybeExtractResponseUrlFromRequest",value:function(e){var t=e.responseURL;return t?t:e.getResponseHeader(c.X_REQUEST_URL_HEADER)}},{key:"setHttpHeaders",value:function(e){this.httpHeaders=e}},{key:"setHttpMethod",value:function(e){this.httpMethod=e.toLowerCase()}},{key:"setRequest",value:function(e){this.request=e}},{key:"setTimeout",value:function(e){this.timeout=e}}]),c}(s);c.GET="get",c.POST="post",c.X_REQUEST_URL_HEADER="X-Request-URL",this.metal.RequestScreen=c}.call(this),function(){var e=this.metalNamed.metal.getUid,t=this.metalNamed.dom.buildFragment,n=this.metalNamed.dom.exitDocument,r=this.metalNamed.dom.globalEval,a=this.metalNamed.dom.globalEvalStyles,o=this.metalNamed.dom.match,i=this.metal.Promise,s=this.metal.globals,l=this.metal.RequestScreen,u=this.metal.Surface,c=this.metal.UA,d=this.metal.Uri,h=this.metal.utils,g=function(l){function g(){babelHelpers.classCallCheck(this,g);var e=babelHelpers.possibleConstructorReturn(this,(g.__proto__||Object.getPrototypeOf(g)).call(this));return e.titleSelector="title",e}return babelHelpers.inherits(g,l),babelHelpers.createClass(g,[{key:"activate",value:function(){babelHelpers.get(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"activate",this).call(this),this.releaseVirtualDocument(),this.pendingStyles=null}},{key:"allocateVirtualDocumentForContent",value:function(e){this.virtualDocument||(this.virtualDocument=s.document.createElement("html")),this.copyNodeAttributesFromContent_(e,this.virtualDocument),this.virtualDocument.innerHTML=e}},{key:"appendStyleIntoDocument_",value:function(e){var t=o(e,g.selectors.stylesTemporary);if(t&&this.pendingStyles.push(e),e.id){var n=s.document.getElementById(e.id);if(n)return void n.parentNode.insertBefore(e,n.nextSibling)}s.document.head.appendChild(e)}},{key:"assertSameBodyIdInVirtualDocument",value:function(){var t=this.virtualDocument.querySelector("body");s.document.body.id||(s.document.body.id="senna_surface_"+e()),t&&(t.id=s.document.body.id)}},{key:"copyNodeAttributesFromContent_",value:function(e,t){e=e.replace(/[<]\s*html/gi,"<senna"),e=e.replace(/\/html\s*\>/gi,"/senna>"),t.innerHTML=e;var n=t.querySelector("senna");n&&(h.clearNodeAttributes(t),h.copyNodeAttributes(n,t))}},{key:"disposeInternal",value:function(){this.disposePendingStyles(),babelHelpers.get(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"disposeInternal",this).call(this)}},{key:"disposePendingStyles",value:function(){this.pendingStyles&&this.pendingStyles.forEach(function(e){return n(e)})}},{key:"evaluateScripts",value:function(e){var t=this,n=this.evaluateTrackedResources_(r.runScriptsInElement,g.selectors.scripts,g.selectors.scriptsTemporary,g.selectors.scriptsPermanent);return n.then(function(){return babelHelpers.get(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"evaluateScripts",t).call(t,e)})}},{key:"evaluateStyles",value:function(e){var t=this;this.pendingStyles=[];var n=this.evaluateTrackedResources_(a.runStylesInElement,g.selectors.styles,g.selectors.stylesTemporary,g.selectors.stylesPermanent,this.appendStyleIntoDocument_.bind(this));return n.then(function(){return babelHelpers.get(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"evaluateStyles",t).call(t,e)})}},{key:"evaluateTrackedResources_",value:function(e,r,a,s,l){var u=this,c=this.virtualQuerySelectorAll_(r),d=this.querySelectorAll_(a),h=this.querySelectorAll_(s);h.forEach(function(e){var t=u.getResourceKey_(e);t&&(g.permanentResourcesInDoc[t]=!0)});var m=t();return c.forEach(function(e){var t=u.getResourceKey_(e);g.permanentResourcesInDoc[t]||m.appendChild(e),t&&o(e,s)&&(g.permanentResourcesInDoc[t]=!0)}),new i(function(t){e(m,function(){d.forEach(function(e){return n(e)}),t()},l)})}},{key:"flip",value:function(e){var t=this;return babelHelpers.get(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"flip",this).call(this,e).then(function(){h.clearNodeAttributes(document.documentElement),h.copyNodeAttributes(t.virtualDocument,document.documentElement)})}},{key:"getResourceKey_",value:function(e){return e.id||e.href||e.src||""}},{key:"getSurfaceContent",value:function(e){var t=this.virtualDocument.querySelector("#"+e);if(t){var n=t.querySelector("#"+e+"-"+u.DEFAULT);return n?n.innerHTML:t.innerHTML}}},{key:"getTitleSelector",value:function(){return this.titleSelector}},{key:"load",value:function(e){var t=this;return babelHelpers.get(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"load",this).call(this,e).then(function(e){return t.allocateVirtualDocumentForContent(e),t.resolveTitleFromVirtualDocument(),t.assertSameBodyIdInVirtualDocument(),c.isIe&&t.makeTemporaryStylesHrefsUnique_(),e})}},{key:"makeTemporaryStylesHrefsUnique_",value:function(){var e=this,t=this.virtualQuerySelectorAll_(g.selectors.stylesTemporary);t.forEach(function(t){return e.replaceStyleAndMakeUnique_(t)})}},{key:"replaceStyleAndMakeUnique_",value:function(e){if(e.href){var t=s.document.createElement(e.tagName);e.href=new d(e.href).makeUnique().toString(),h.copyNodeAttributes(e,t),e.parentNode.replaceChild(t,e),e.disabled=!0}}},{key:"virtualQuerySelectorAll_",value:function(e){return Array.prototype.slice.call(this.virtualDocument.querySelectorAll(e))}},{key:"querySelectorAll_",value:function(e){return Array.prototype.slice.call(s.document.querySelectorAll(e))}},{key:"releaseVirtualDocument",value:function(){this.virtualDocument=null}},{key:"resolveTitleFromVirtualDocument",value:function(){var e=this.virtualDocument.querySelector(this.titleSelector);e&&this.setTitle(e.textContent.trim())}},{key:"setTitleSelector",value:function(e){this.titleSelector=e}}]),g}(l);g.selectors={scripts:"script[data-senna-track]",scriptsPermanent:'script[data-senna-track="permanent"]',scriptsTemporary:'script[data-senna-track="temporary"]',styles:"style[data-senna-track],link[data-senna-track]",stylesPermanent:'style[data-senna-track="permanent"],link[data-senna-track="permanent"]',stylesTemporary:'style[data-senna-track="temporary"],link[data-senna-track="temporary"]'},g.permanentResourcesInDoc={},this.metal.HtmlScreen=g}.call(this),function(){var e=this.metalNamed.metal.Disposable,t=this.metalNamed.metal.getUid,n=this.metalNamed.metal.isDefAndNotNull,r=this.metalNamed.metal.isElement,a=this.metalNamed.metal.object,o=this.metal.dataAttributes,i=this.metal.globals,s=this.metal.App,l=this.metal.HtmlScreen,u=this.metal.Route,c=function(e){function c(){babelHelpers.classCallCheck(this,c);var e=babelHelpers.possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));return e.app=null,e.baseElement=null,e}return babelHelpers.inherits(c,e),babelHelpers.createClass(c,[{key:"handle",value:function(){if(!r(this.baseElement))throw new Error("Senna data attribute handler base element not set or invalid, try setting a valid element that contains a `data-senna` attribute.");if(this.baseElement.hasAttribute(o.senna)){if(this.app)throw new Error("Senna app was already initialized.");this.app=new s,this.maybeAddRoutes_(),this.maybeAddSurfaces_(),this.maybeSetBasePath_(),this.maybeSetLinkSelector_(),this.maybeSetLoadingCssClass_(),this.maybeSetUpdateScrollPosition_(),this.maybeDispatch_()}}},{key:"disposeInternal",value:function(){this.app&&this.app.dispose()}},{key:"getApp",value:function(){return this.app}},{key:"getBaseElement",value:function(){return this.baseElement}},{key:"maybeAddRoutes_",value:function(){var e=this,t='link[rel="senna-route"]';this.querySelectorAllAsArray_(t).forEach(function(t){return e.maybeParseLinkRoute_(t)}),this.app.hasRoutes()||this.app.addRoutes(new u(/.*/,l))}},{key:"maybeAddSurfaces_",value:function(){var e=this,t="["+o.surface+"]";this.querySelectorAllAsArray_(t).forEach(function(t){e.updateElementIdIfSpecialSurface_(t),e.app.addSurfaces(t.id)})}},{key:"maybeDispatch_",value:function(){this.baseElement.hasAttribute(o.dispatch)&&this.app.dispatch()}},{key:"maybeParseLinkRoute_",value:function(e){var t=new u(this.maybeParseLinkRoutePath_(e),this.maybeParseLinkRouteHandler_(e));this.app.addRoutes(t)}},{key:"maybeParseLinkRouteHandler_",value:function(e){var t=e.getAttribute("type");return n(t)&&(t=a.getObjectByName(t)),t}},{key:"maybeParseLinkRoutePath_",value:function(e){var t=e.getAttribute("href");return n(t)&&0===t.indexOf("regex:")&&(t=new RegExp(t.substring(6))),t}},{key:"maybeSetBasePath_",value:function(){var e=this.baseElement.getAttribute(o.basePath);n(e)&&this.app.setBasePath(e)}},{key:"maybeSetLinkSelector_",value:function(){var e=this.baseElement.getAttribute(o.linkSelector);n(e)&&this.app.setLinkSelector(e)}},{key:"maybeSetLoadingCssClass_",value:function(){var e=this.baseElement.getAttribute(o.loadingCssClass);n(e)&&this.app.setLoadingCssClass(e)}},{key:"maybeSetUpdateScrollPosition_",value:function(){var e=this.baseElement.getAttribute(o.updateScrollPosition);n(e)&&("false"===e?this.app.setUpdateScrollPosition(!1):this.app.setUpdateScrollPosition(!0))}},{key:"querySelectorAllAsArray_",value:function(e){return Array.prototype.slice.call(i.document.querySelectorAll(e))}},{key:"updateElementIdIfSpecialSurface_",value:function(e){e.id||e!==i.document.body||(e.id="senna_surface_"+t())}},{key:"setBaseElement",value:function(e){this.baseElement=e}}]),c}(e);this.metal.AppDataAttributeHandler=c}.call(this),function(){var e=this.metal.globals,t=this.metal.AppDataAttributeHandler,n=new t;e.document.addEventListener("DOMContentLoaded",function(){n.setBaseElement(e.document.body),n.handle()}),this.metal.dataAttributeHandler=n}.call(this),function(){var e=this.metal.utils,t=this.metal.dataAttributeHandler,n=this.metal.App,r=this.metal.HtmlScreen,a=this.metal.RequestScreen,o=this.metal.Route,i=this.metal.Screen;this.metal.senna=n,this.metalNamed.senna=this.metalNamed.senna||{},this.metalNamed.senna.dataAttributeHandler=t,this.metalNamed.senna.utils=e,this.metalNamed.senna.App=n,this.metalNamed.senna.HtmlScreen=r,this.metalNamed.senna.Route=o,this.metalNamed.senna.RequestScreen=a,this.metalNamed.senna.Screen=i}.call(this),function(){function e(e,n){for(var r=Object.keys(n||{}),a=[],o=0;o<r.length;o++){var i=t(e,n[r[o]]);if(i.fn){var s=void 0;s=i.selector?e.delegate(r[o],i.selector,i.fn):e.on(r[o],i.fn),a.push(s)}}return a}function t(e,t){var i={fn:t};return a(t)&&!r(t)&&(i.selector=t.selector,i.fn=t.fn),o(i.fn)&&(i.fn=n(e,i.fn)),i}function n(e,t){if(r(e[t]))return e[t].bind(e)}var r=(this.metalNamed.metal.getFunctionName,this.metalNamed.metal.isFunction),a=this.metalNamed.metal.isObject,o=this.metalNamed.metal.isString;this.metalNamed.events=this.metalNamed.events||{},this.metalNamed.events.addListenersFromObj=e,this.metalNamed.events.getComponentFn=n}.call(this),function(){function e(e){var t=e.constructor;if(t.hasOwnProperty(r))return t[r];for(var n={},a=e.getDataManager().getSyncKeys(e),o=!0,i=0;i<a.length;i++){var s="sync"+a[i].charAt(0).toUpperCase()+a[i].slice(1),l=e[s];l&&(n[a[i]]=l,o=o&&e.constructor.prototype[s])}return o&&(t[r]=n),n}function t(t,r){for(var a=e(t),o=Object.keys(r||a),i=0;i<o.length;i++){var s=a[o[i]];if(n(s)){var l=r&&r[o[i]],u=t.getDataManager();s.call(t,l?l.newVal:u.get(t,o[i]),l?l.prevVal:void 0)}}}var n=this.metalNamed.metal.isFunction,r="__METAL_SYNC_FNS__";this.metalNamed.sync=this.metalNamed.sync||{},this.metalNamed.sync.syncState=t}.call(this),function(){function e(e){var t=a(i.bind(null,e));return function(){return 0===arguments.length?t:t.apply(void 0,arguments)}}function t(e,t,n){var r=n?s(n.constructor):null,a=n&&n.getRenderer&&n.getRenderer(),o=a&&a.getParent&&a.getParent(),i=o?s(o.constructor):null,l=i?"Check render method of '"+i+"'.":"";return new Error("Warning: Invalid state passed to '"+t+"'. "+(e+" Passed to '"+r+"'. "+l))}function n(e){return Array.isArray(e)?"array":"undefined"==typeof e?"undefined":babelHelpers["typeof"](e)}function r(e){return e instanceof Error}function a(e){return function(t,n,r){return!l(t)||e(t,n,r)}}function o(e,n,a,o){for(var i=0;i<n.length;i++)if(r(e(n[i],a,o)))return t(u,a,o);return!0}function i(e,r,a,o){var i=n(r);if(i!==e){var s="Expected type '"+e+"', but received type '"+i+"'.";return t(s,a,o)}return!0}var s=this.metalNamed.metal.getFunctionName,l=this.metalNamed.metal.isDefAndNotNull,u="Expected an array of single type.",c="Expected object of one type.",d="Expected one of given values.",h="Expected one of given types.",g="Expected object with a specific shape.",m={any:function(){return function(){return!0}},array:e("array"),bool:e("boolean"),func:e("function"),number:e("number"),object:e("object"),string:e("string"),arrayOf:function(e){return a(function(t,n,a){var i=m.array(t,n,a);return r(i)?i:o(e,t,n,a)})},instanceOf:function(e){return a(function(n,r,a){if(n instanceof e)return!0;var o="Expected instance of "+e;return t(o,r,a)})},objectOf:function(e){return a(function(n,a,o){for(var i in n)if(r(e(n[i])))return t(c,a,o);return!0})},oneOf:function(e){return a(function(n,a,o){var i=m.array(e,a,o);return r(i)?i:e.indexOf(n)!==-1||t(d,a,o)})},oneOfType:function(e){return a(function(n,a,o){var i=m.array(e,a,o);if(r(i))return i;for(var s=0;s<e.length;s++)if(!r(e[s](n,a,o)))return!0;return t(h,a,o)})},shapeOf:function(e){return a(function(n,a,o){var i=m.object(e,a,o);if(r(i))return i;for(var s in e){var u=e[s],c=!1;if(u.config&&(c=u.config.required,u=u.config.validator),c&&!l(n[s])||r(u(n[s])))return t(g,a,o)}return!0})}};this.metal.validators=m}.call(this),function(){function e(t){var n=Object.keys(t),r={};return n.forEach(function(n){var a=t[n];r[n]=a.config&&a.config.validator?a.config.validator:e(a)}),r}function t(e,t){var n=e;return n===s&&(n=Object.create(s),n.config={}),o.mixin(n.config,t),n}function n(e){return function(t){return this.validator(i[e](t))}}function r(e){return function(t){return this.validator(i[e](t.config.validator))}}function a(e){return function(){return this.validator(i[e])}}var o=this.metalNamed.metal.object,i=this.metal.validators,s={any:a("any"),array:a("array"),arrayOf:r("arrayOf"),bool:a("bool"),func:a("func"),instanceOf:n("instanceOf"),number:a("number"),object:a("object"),objectOf:r("objectOf"),oneOf:n("oneOf"),oneOfType:function(e){return e=e.map(function(e){return e.config.validator}),this.validator(i.oneOfType(e))},shapeOf:function(t){return t=e(t),this.validator(i.shapeOf(t))},string:a("string"),internal:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t(this,{internal:e})},required:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t(this,{required:e})},setter:function(e){return t(this,{setter:e})},validator:function(e){return t(this,{validator:e})},value:function(e){return t(this,{value:e})},valueFn:function(e){return t(this,{valueFn:e})}};this.metal.Config=s}.call(this),function(){var e=this.metalNamed.metal.async,t=this.metalNamed.metal.getStaticProperty,n=this.metalNamed.metal.isDefAndNotNull,r=this.metalNamed.metal.isFunction,a=this.metalNamed.metal.isObject,o=this.metalNamed.metal.isString,i=this.metalNamed.metal.object,s=this.metalNamed.events.EventEmitter,l=function(s){function l(e,t,n){babelHelpers.classCallCheck(this,l);var r=babelHelpers.possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this));return r.context_=n||r,r.keysBlacklist_=null,r.obj_=t||r,r.eventData_=null,r.scheduledBatchData_=null,r.stateInfo_={},r.stateConfigs_={},r.initialValues_=i.mixin({},e),r.setShouldUseFacade(!0),r.configStateFromStaticHint_(),Object.defineProperty(r.obj_,l.STATE_REF_KEY,{configurable:!0,enumerable:!1,value:r}),r}return babelHelpers.inherits(l,s),babelHelpers.createClass(l,[{key:"assertGivenIfRequired_",value:function(e){var t=this.stateConfigs_[e];if(t.required){var r=this.getStateInfo(e),a=r.state===l.KeyStates.INITIALIZED?this.get(e):this.initialValues_[e];if(!n(a)){var o='The property called "'+e+"\" is required but didn't receive a value.";if(this.shouldThrowValidationError())throw new Error(o)}}}},{key:"assertValidatorReturnInstanceOfError_",value:function(e){if(e instanceof Error&&this.shouldThrowValidationError())throw e}},{key:"assertValidStateKeyName_",value:function(e){if(this.keysBlacklist_&&this.keysBlacklist_[e])throw new Error("It's not allowed to create a state key with the name \""+e+'".')}},{key:"buildKeyPropertyDef_",value:function(e){return{configurable:!0,enumerable:!0,get:function(){return this[l.STATE_REF_KEY].getStateKeyValue_(e)},set:function(t){this[l.STATE_REF_KEY].setStateKeyValue_(e,t)}}}},{key:"callFunction_",value:function(e,t){return o(e)?this.context_[e].apply(this.context_,t):r(e)?e.apply(this.context_,t):void 0}},{key:"callSetter_",value:function(e,t,n){var r=this.stateConfigs_[e];return r.setter&&(t=this.callFunction_(r.setter,[t,n])),t}},{key:"callValidator_",value:function(e,t){var n=this.stateConfigs_[e];if(n.validator){var r=this.callFunction_(n.validator,[t,e,this.context_]);return this.assertValidatorReturnInstanceOfError_(r),r}return!0}},{key:"canSetState",value:function(e){var t=this.getStateInfo(e);return!this.stateConfigs_[e].writeOnce||!t.written}},{key:"configState",value:function(e,t){var n=Object.keys(e);if(0!==n.length){if(t!==!1){for(var r={},a=0;a<n.length;a++){var o=n[a];this.assertValidStateKeyName_(o),r[o]=this.buildKeyPropertyDef_(o)}Object.defineProperties(t||this.obj_,r)}this.stateConfigs_=e;for(var i=0;i<n.length;i++){var s=n[i];e[s]=e[s].config?e[s].config:e[s],this.assertGivenIfRequired_(n[i]),this.validateInitialValue_(n[i])}}}},{key:"configStateFromStaticHint_",value:function(){var e=this.constructor;if(e!==l){var t=void 0;this.obj_===this&&(t=!e.hasConfiguredState_&&e.prototype,e.hasConfiguredState_=!0),this.configState(l.getStateStatic(e),t)}}},{key:"disposeInternal",value:function(){babelHelpers.get(l.prototype.__proto__||Object.getPrototypeOf(l.prototype),"disposeInternal",this).call(this),this.initialValues_=null,this.stateInfo_=null,this.stateConfigs_=null,this.scheduledBatchData_=null}},{key:"emitBatchEvent_",value:function(){if(!this.isDisposed()){var e=this.scheduledBatchData_;this.scheduledBatchData_=null,this.context_.emit("stateChanged",e)}}},{key:"get",value:function(e){return this.obj_[e]}},{key:"getState",value:function(e){for(var t={},n=e||this.getStateKeys(),r=0;r<n.length;r++)t[n[r]]=this.get(n[r]);return t}},{key:"getStateInfo",value:function(e){return this.stateInfo_[e]||(this.stateInfo_[e]={}),this.stateInfo_[e]}},{key:"getStateKeyConfig",value:function(e){return this.stateConfigs_?this.stateConfigs_[e]:null}},{key:"getStateKeys",value:function(){return this.stateConfigs_?Object.keys(this.stateConfigs_):[]}},{key:"getStateKeyValue_",value:function(e){if(!this.warnIfDisposed_(e))return this.initStateKey_(e),this.getStateInfo(e).value}},{key:"hasBeenSet",value:function(e){var t=this.getStateInfo(e);return t.state===l.KeyStates.INITIALIZED||this.hasInitialValue_(e)}},{key:"hasInitialValue_",value:function(e){return this.initialValues_.hasOwnProperty(e)}},{key:"hasStateKey",value:function(e){if(!this.warnIfDisposed_(e))return!!this.stateConfigs_[e]}},{key:"informChange_",value:function(e,t){if(this.shouldInformChange_(e,t)){var n=i.mixin({key:e,newVal:this.get(e),prevVal:t},this.eventData_);this.context_.emit(e+"Changed",n),this.context_.emit("stateKeyChanged",n),this.scheduleBatchEvent_(n)}}},{key:"initStateKey_",value:function(e){var t=this.getStateInfo(e);t.state===l.KeyStates.UNINITIALIZED&&(t.state=l.KeyStates.INITIALIZING,this.setInitialValue_(e),t.written||this.setDefaultValue(e),t.state=l.KeyStates.INITIALIZED)}},{key:"removeStateKey",value:function(e){this.stateInfo_[e]=null,this.stateConfigs_[e]=null,delete this.obj_[e]}},{key:"scheduleBatchEvent_",value:function(t){this.scheduledBatchData_||(e.nextTick(this.emitBatchEvent_,this),this.scheduledBatchData_=i.mixin({changes:{}},this.eventData_));var n=t.key,r=this.scheduledBatchData_.changes;r[n]?r[n].newVal=t.newVal:r[n]=t}},{key:"set",value:function(e,t){this.hasStateKey(e)&&(this.obj_[e]=t)}},{key:"setDefaultValue",value:function(e){var t=this.stateConfigs_[e];void 0!==t.value?this.set(e,t.value):this.set(e,this.callFunction_(t.valueFn))}},{key:"setEventData",value:function(e){this.eventData_=e}},{key:"setInitialValue_",value:function(e){this.hasInitialValue_(e)&&(this.set(e,this.initialValues_[e]),this.initialValues_[e]=void 0)}},{key:"setKeysBlacklist",value:function(e){this.keysBlacklist_=e}},{key:"setState",value:function(e,t){var n=this;Object.keys(e).forEach(function(t){return n.set(t,e[t])}),t&&this.scheduledBatchData_&&this.context_.once("stateChanged",t)}},{key:"setStateKeyValue_",value:function(e,t){if(!this.warnIfDisposed_(e)&&this.canSetState(e)&&this.validateKeyValue_(e,t)){var n=this.get(e),r=this.getStateInfo(e);r.value=this.callSetter_(e,t,n),this.assertGivenIfRequired_(e),
r.written=!0,this.informChange_(e,n)}}},{key:"shouldInformChange_",value:function(e,t){var n=this.getStateInfo(e);return n.state===l.KeyStates.INITIALIZED&&(a(t)||t!==this.get(e))}},{key:"shouldThrowValidationError",value:function(){return!1}},{key:"validateInitialValue_",value:function(e){this.hasInitialValue_(e)&&!this.callValidator_(e,this.initialValues_[e])&&delete this.initialValues_[e]}},{key:"validateKeyValue_",value:function(e,t){var n=this.getStateInfo(e);return n.state===l.KeyStates.INITIALIZING||this.callValidator_(e,t)}},{key:"warnIfDisposed_",value:function(e){var t=this.isDisposed();return t}}],[{key:"getStateStatic",value:function(e){return t(e,"STATE",l.mergeState)}},{key:"mergeState",value:function(e,t){return i.mixin({},t,e)}}]),l}(s);l.STATE_REF_KEY="__METAL_STATE_REF_KEY__",l.KeyStates={UNINITIALIZED:void 0,INITIALIZING:1,INITIALIZED:2},this.metal.State=l}.call(this),function(){var e=this.metal.validators,t=this.metal.Config,n=this.metal.State;this.metal.state=n,this.metalNamed.state=this.metalNamed.state||{},this.metalNamed.state.validators=e,this.metalNamed.state.Config=t,this.metalNamed.state.State=n}.call(this),function(){var e=this.metalNamed.metal.object,t=this.metal.state,n={components:!0,context:!0,element:!0,refs:!0,state:!0,stateKey:!0,wasRendered:!0},r="__DATA_MANAGER_DATA__",a=function(){function a(){babelHelpers.classCallCheck(this,a)}return babelHelpers.createClass(a,[{key:"createState_",value:function(r,a){var o=new t(r.getInitialConfig(),r,r);o.setKeysBlacklist(n),o.configState(e.mixin({},a,t.getStateStatic(r.constructor))),this.getManagerData(r).state_=o}},{key:"dispose",value:function(e){var t=this.getManagerData(e);t.state_&&t.state_.dispose(),e[r]=null}},{key:"get",value:function(e,t){return this.getManagerData(e).state_.get(t)}},{key:"getManagerData",value:function(e){return e[r]}},{key:"getSyncKeys",value:function(e){return this.getManagerData(e).state_.getStateKeys()}},{key:"getStateKeys",value:function(e){return this.getManagerData(e).state_.getStateKeys()}},{key:"getState",value:function(e){return this.getManagerData(e).state_.getState()}},{key:"getStateInstance",value:function(e){return this.getManagerData(e).state_}},{key:"replaceNonInternal",value:function(e,t,n){for(var r=n||this.getManagerData(e).state_,a=r.getStateKeys(),o=0;o<a.length;o++){var i=a[o];r.getStateKeyConfig(i).internal||(t.hasOwnProperty(i)?r.set(i,t[i]):r.setDefaultValue(i))}}},{key:"setState",value:function(e,t,n){this.getManagerData(e).state_.setState(t,n)}},{key:"setUp",value:function(e,t){e[r]={},this.createState_(e,t)}}]),a}();this.metal.ComponentDataManager=new a}.call(this),function(){var e=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"dispose",value:function(){}},{key:"getExtraDataConfig",value:function(){}},{key:"render",value:function(e){e.element||(e.element=document.createElement("div")),e.informRendered()}},{key:"setUp",value:function(){}},{key:"update",value:function(){}}]),e}();this.metal.ComponentRenderer=new e}.call(this),function(){var e=this.metalNamed.events.addListenersFromObj,t=this.metalNamed.metal.getStaticProperty,n=this.metalNamed.metal.isBoolean,r=this.metalNamed.metal.isDefAndNotNull,a=this.metalNamed.metal.isElement,o=this.metalNamed.metal.isObject,i=this.metalNamed.metal.isString,s=this.metalNamed.metal.object,l=this.metalNamed.sync.syncState,u=this.metalNamed.dom.DomEventEmitterProxy,c=this.metalNamed.dom.toElement,d=this.metal.ComponentDataManager,h=this.metal.ComponentRenderer,g=this.metalNamed.events.EventEmitter,m=this.metalNamed.events.EventHandler,f=function(n){function d(e,t){babelHelpers.classCallCheck(this,d);var n=babelHelpers.possibleConstructorReturn(this,(d.__proto__||Object.getPrototypeOf(d)).call(this));return n.elementEventProxy_=new u(null,n,p),n.eventsStateKeyHandler_=null,n.inDocument=!1,n.initialConfig_=e||{},n.wasRendered=!1,n.DEFAULT_ELEMENT_PARENT=document.body,n.setShouldUseFacade(!0),n.element=n.initialConfig_.element,n.setUpRenderer_(),n.setUpDataManager_(),n.setUpSyncUpdates_(),n.on("stateChanged",n.handleComponentStateChanged_),n.on("eventsChanged",n.onEventsChanged_),n.addListenersFromObj_(n.dataManager_.get(n,"events")),n.created(),n.componentCreated_=!0,t!==!1&&n.renderComponent(t),n}return babelHelpers.inherits(d,n),babelHelpers.createClass(d,[{key:"addListenersFromObj_",value:function(t){var n;this.eventsStateKeyHandler_||(this.eventsStateKeyHandler_=new m);var r=e(this,t);(n=this.eventsStateKeyHandler_).add.apply(n,babelHelpers.toConsumableArray(r))}},{key:"attach",value:function(e,t){return this.inDocument||(this.attachElement(e,t),this.inDocument=!0,this.attachData_={parent:e,sibling:t},this.emit("attached",this.attachData_),this.attached()),this}},{key:"attached",value:function(){}},{key:"attachElement",value:function(e,t){var n=this.element;if(n&&(t||!n.parentNode)){var r=c(e)||this.DEFAULT_ELEMENT_PARENT;r.insertBefore(n,c(t))}}},{key:"created",value:function(){}},{key:"delegate",value:function(e,t,n){return this.on("delegate:"+e+":"+t,n)}},{key:"detach",value:function(){return this.inDocument&&(this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.inDocument=!1,this.detached()),this.emit("detached"),this}},{key:"detached",value:function(){}},{key:"disposed",value:function(){}},{key:"disposeInternal",value:function(){this.detach(),this.disposed(),this.elementEventProxy_.dispose(),this.elementEventProxy_=null,this.dataManager_.dispose(this),this.dataManager_=null,this.renderer_.dispose(this),this.renderer_=null,babelHelpers.get(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"disposeInternal",this).call(this)}},{key:"getAttachData",value:function(){return this.attachData_}},{key:"getDataManager",value:function(){return this.dataManager_}},{key:"getInitialConfig",value:function(){return this.initialConfig_}},{key:"getState",value:function(){return this.dataManager_.getState(this)}},{key:"getStateKeys",value:function(){return this.dataManager_.getStateKeys(this)}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"handleComponentElementChanged_",value:function(e,t){this.elementEventProxy_.setOriginEmitter(t),this.componentCreated_&&(this.emit("elementChanged",{prevVal:e,newVal:t}),t&&this.wasRendered&&this.syncVisible(this.dataManager_.get(this,"visible")))}},{key:"handleComponentStateChanged_",value:function(e){this.hasSyncUpdates()||this.updateRenderer_(e),l(this,e.changes),this.emit("stateSynced",e)}},{key:"handleComponentStateKeyChanged_",value:function(e){this.updateRenderer_({changes:babelHelpers.defineProperty({},e.key,e)})}},{key:"hasSyncUpdates",value:function(){return this.syncUpdates_}},{key:"informRendered",value:function(){var e=!this.hasRendererRendered_;this.hasRendererRendered_=!0,this.rendered(e),this.emit("rendered",e)}},{key:"mergeElementClasses_",value:function(e,t){return e?e+" "+(t||""):t}},{key:"onEventsChanged_",value:function(e){this.eventsStateKeyHandler_.removeAllListeners(),this.addListenersFromObj_(e.newVal)}},{key:"renderComponent",value:function(e){this.hasRendererRendered_||(window.__METAL_DEV_TOOLS_HOOK__&&window.__METAL_DEV_TOOLS_HOOK__(this),this.getRenderer().render(this)),this.emit("render"),l(this),this.attach(e),this.wasRendered=!0}},{key:"setState",value:function(e,t){this.dataManager_.setState(this,e,t)}},{key:"setterElementClassesFn_",value:function(e){var n=t(this.constructor,"ELEMENT_CLASSES",this.mergeElementClasses_);return n&&(e+=" "+n),e.trim()}},{key:"setUpDataManager_",value:function(){this.dataManager_=t(this.constructor,"DATA_MANAGER"),this.dataManager_.setUp(this,s.mixin({},this.renderer_.getExtraDataConfig(this),d.DATA))}},{key:"setUpRenderer_",value:function(){this.renderer_=t(this.constructor,"RENDERER"),this.renderer_.setUp(this)}},{key:"setUpSyncUpdates_",value:function(){this.syncUpdates_=t(this.constructor,"SYNC_UPDATES"),this.hasSyncUpdates()&&this.on("stateKeyChanged",this.handleComponentStateKeyChanged_.bind(this))}},{key:"startSkipUpdates",value:function(){this.skipUpdates_=!0}},{key:"stopSkipUpdates",value:function(){this.skipUpdates_=!1}},{key:"syncVisible",value:function(e){this.element&&(this.element.style.display=e?"":"none")}},{key:"rendered",value:function(){}},{key:"updateRenderer_",value:function(e){!this.skipUpdates_&&this.hasRendererRendered_&&this.getRenderer().update(this,e)}},{key:"validatorEventsFn_",value:function(e){return!r(e)||o(e)}},{key:"element",get:function(){return this.elementValue_},set:function(e){if((a(e)||i(e)||!r(e))&&(e&&(e=c(e)||this.elementValue_),this.elementValue_!==e)){var t=this.elementValue_;this.elementValue_=e,this.handleComponentElementChanged_(t,e)}}}],[{key:"isComponentCtor",value:function(e){return e.prototype&&e.prototype[d.COMPONENT_FLAG]}},{key:"render",value:function(e,t,n){var r=t,o=n;a(t)&&(r=null,o=t);var i=new e(r,(!1));return i.renderComponent(o),i}},{key:"renderToString",value:function(e,t){var n=e.RENDERER&&e.RENDERER.RENDERER_NAME;switch(n){case"jsx":case"soy":case"incremental-dom":if("undefined"==typeof IncrementalDOM)throw new Error("Error. Trying to render incremental dom based component to string requires IncrementalDOM implementation to be loaded.");var r=[],a=IncrementalDOM.patch,o=function(){var e=a.apply(null,arguments);r.push(e.innerHTML),IncrementalDOM.patch=a};return IncrementalDOM.patch=o,d.render(e,t).dispose(),r[0];default:throw new Error("Error. Trying to render non incremental dom based component to string.")}}}]),d}(g);f.DATA={children:{validator:Array.isArray,value:[]},elementClasses:{setter:"setterElementClassesFn_",validator:i,value:""},events:{validator:"validatorEventsFn_",value:null},visible:{validator:n,value:!0}},f.COMPONENT_FLAG="__metal_component__",f.DATA_MANAGER=d,f.ELEMENT_CLASSES="",f.RENDERER=h,f.SYNC_UPDATES=!1,f.prototype[f.COMPONENT_FLAG]=!0;var p={eventsChanged:!0,stateChanged:!0,stateKeyChanged:!0};this.metal.Component=f}.call(this),function(){var e=this.metalNamed.metal.getFunctionName,t=function(){function t(){babelHelpers.classCallCheck(this,t)}return babelHelpers.createClass(t,null,[{key:"getConstructor",value:function(e){var n=t.components_[e];return n}},{key:"register",value:function(n,r){var a=r;a||(a=n.hasOwnProperty("NAME")?n.NAME:e(n)),n.NAME=a,t.components_[a]=n}}]),t}();t.components_={},this.metal.ComponentRegistry=t}.call(this),function(){var e=this.metal.Component,t=this.metal.ComponentDataManager,n=this.metal.ComponentRegistry,r=this.metal.ComponentRenderer;this.metal.component=e,this.metalNamed.component=this.metalNamed.component||{},this.metalNamed.component.Component=e,this.metalNamed.component.ComponentDataManager=t,this.metalNamed.component.ComponentRegistry=n,this.metalNamed.component.ComponentRenderer=r,Object.keys(this.metalNamed.events).forEach(function(e){this.metalNamed.component[e]=this.metalNamed.events[e]})}.call(this),function(){function e(){}function t(e,t){this.attrs=o(),this.attrsArr=[],this.newAttrs=o(),this.staticsApplied=!1,this.key=t,this.keyMap=o(),this.keyMapValid=!0,this.focused=!1,this.nodeName=e,this.text=null}function n(){this.created=h.nodesCreated&&[],this.deleted=h.nodesDeleted&&[]}var r=Object.prototype.hasOwnProperty;e.prototype=Object.create(null);var a=function(e,t){return r.call(e,t)},o=function(){return new e},i=function(e,n,r){var a=new t(n,r);return e.__incrementalDOMData=a,a},s=function(e){return l(e),e.__incrementalDOMData},l=function _e(e){if(!e.__incrementalDOMData){var t=e instanceof Element,n=t?e.localName:e.nodeName,r=t?e.getAttribute("key"):null,a=i(e,n,r);if(r&&(s(e.parentNode).keyMap[r]=e),t)for(var o=e.attributes,l=a.attrs,u=a.newAttrs,c=a.attrsArr,d=0;d<o.length;d+=1){var h=o[d],g=h.name,m=h.value;l[g]=m,u[g]=void 0,c.push(g),c.push(m)}for(var f=e.firstChild;f;f=f.nextSibling)_e(f)}},u=function(e,t){return"svg"===e?"http://www.w3.org/2000/svg":"foreignObject"===s(t).nodeName?null:t.namespaceURI},c=function(e,t,n,r){var a=u(n,t),o=void 0;return o=a?e.createElementNS(a,n):e.createElement(n),i(o,n,r),o},d=function(e){var t=e.createTextNode("");return i(t,"#text",null),t},h={nodesCreated:null,nodesDeleted:null};n.prototype.markCreated=function(e){this.created&&this.created.push(e)},n.prototype.markDeleted=function(e){this.deleted&&this.deleted.push(e)},n.prototype.notifyChanges=function(){this.created&&this.created.length>0&&h.nodesCreated(this.created),this.deleted&&this.deleted.length>0&&h.nodesDeleted(this.deleted)};var g=!1,m=!1,f=function(e,t){if(!t)throw new Error("Cannot call "+e+"() unless in patch.")},p=function(e,t){if(e!==t){for(var n=e,r=[];n&&n!==t;)r.push(n.nodeName.toLowerCase()),n=n.parentNode;throw new Error("One or more tags were not closed:\n"+r.join("\n"))}},v=function(e){if(g)throw new Error(e+"() can not be called between elementOpenStart() and elementOpenEnd().")},y=function(e){if(m)throw new Error(e+"() may not be called inside an element that has called skip().")},_=function(e){if(!g)throw new Error(e+"() can only be called after calling elementOpenStart().")},b=function(){if(g)throw new Error("elementOpenEnd() must be called after calling elementOpenStart().")},E=function(e,t){if(e!==t)throw new Error('Received a call to close "'+t+'" but "'+e+'" was open.')},N=function(e,t){if(null!==t)throw new Error(e+"() must come before any child declarations inside the current element.")},S=function(e,t,n,r){var a=t.nextSibling===n&&t.previousSibling===r,o=t.nextSibling===e.nextSibling&&t.previousSibling===r,i=t===e;if(!a&&!o&&!i)throw new Error("There must be exactly one top level call corresponding to the patched element.")},C=function(e){var t=g;return g=e,t},k=function(e){var t=m;return m=e,t},R=function(e){return e instanceof Document||e instanceof DocumentFragment},D=function(e,t){for(var n=[],r=e;r!==t;)n.push(r),r=r.parentNode;return n},O=function(e){for(var t=e,n=t;t;)n=t,t=t.parentNode;return n},A=function(e){var t=O(e);return R(t)?t.activeElement:null},P=function(e,t){var n=A(e);return n&&e.contains(n)?D(n,t):[]},L=function(e,t,n){for(var r=t.nextSibling,a=n;a!==t;){var o=a.nextSibling;e.insertBefore(a,r),a=o}},T=null,w=null,I=null,H=null,M=function(e,t){for(var n=0;n<e.length;n+=1)s(e[n]).focused=t},x=function(e){var t=function(t,r,a){var o=T,i=H,s=w,l=I,u=!1,c=!1;T=new n,H=t.ownerDocument,I=t.parentNode,"production"!==process.env.NODE_ENV&&(u=C(!1),c=k(!1));var d=P(t,I);M(d,!0);var h=e(t,r,a);return M(d,!1),"production"!==process.env.NODE_ENV&&(b(),C(u),k(c)),T.notifyChanges(),T=o,H=i,w=s,I=l,h};return t},U=x(function(e,t,n){return w=e,$(),t(n),K(),"production"!==process.env.NODE_ENV&&p(w,e),e}),F=x(function(e,t,n){var r={nextSibling:e},a=null,o=null;return"production"!==process.env.NODE_ENV&&(a=e.nextSibling,o=e.previousSibling),w=r,t(n),"production"!==process.env.NODE_ENV&&S(r,w,a,o),e!==w&&e.parentNode&&V(I,e,s(I).keyMap),r===w?null:w}),j=function(e,t,n){var r=s(e);return t===r.nodeName&&n==r.key},B=function(e,t){if(!w||!j(w,e,t)){var n=s(I),r=w&&s(w),a=n.keyMap,o=void 0;if(t){var i=a[t];i&&(j(i,e,t)?o=i:i===w?T.markDeleted(i):V(I,i,a))}o||(o="#text"===e?d(H):c(H,I,e,t),t&&(a[t]=o),T.markCreated(o)),s(o).focused?L(I,o,w):r&&r.key&&!r.focused?(I.replaceChild(o,w),n.keyMapValid=!1):I.insertBefore(o,w),w=o}},V=function(e,t,n){e.removeChild(t),T.markDeleted(t);var r=s(t).key;r&&delete n[r]},q=function(){var e=I,t=s(e),n=t.keyMap,r=t.keyMapValid,a=e.lastChild,o=void 0;if(a!==w||!r){for(;a!==w;)V(e,a,n),a=e.lastChild;if(!r){for(o in n)a=n[o],a.parentNode!==e&&(T.markDeleted(a),delete n[o]);t.keyMapValid=!0}}},$=function(){I=w,w=null},G=function(){return w?w.nextSibling:I.firstChild},z=function(){w=G()},K=function(){q(),w=I,I=I.parentNode},Y=function(e,t){return z(),B(e,t),$(),I},W=function(){return"production"!==process.env.NODE_ENV&&k(!1),K(),w},Q=function(){return z(),B("#text",null),w},J=function(){return"production"!==process.env.NODE_ENV&&(f("currentElement",T),v("currentElement")),I},Z=function(){return"production"!==process.env.NODE_ENV&&(f("currentPointer",T),v("currentPointer")),G()},X=function(){"production"!==process.env.NODE_ENV&&(N("skip",w),k(!0)),w=I.lastChild},ee=z,te={"default":"__default"},ne=function(e){return 0===e.lastIndexOf("xml:",0)?"http://www.w3.org/XML/1998/namespace":0===e.lastIndexOf("xlink:",0)?"http://www.w3.org/1999/xlink":void 0},re=function(e,t,n){if(null==n)e.removeAttribute(t);else{var r=ne(t);r?e.setAttributeNS(r,t,n):e.setAttribute(t,n)}},ae=function(e,t,n){e[t]=n},oe=function(e,t,n){t.indexOf("-")>=0?e.setProperty(t,n):e[t]=n},ie=function(e,t,n){if("string"==typeof n)e.style.cssText=n;else{e.style.cssText="";var r=e.style,o=n;for(var i in o)a(o,i)&&oe(r,i,o[i])}},se=function(e,t,n){var r="undefined"==typeof n?"undefined":babelHelpers["typeof"](n);"object"===r||"function"===r?ae(e,t,n):re(e,t,n)},le=function(e,t,n){var r=s(e),a=r.attrs;if(a[t]!==n){var o=ue[t]||ue[te["default"]];o(e,t,n),a[t]=n}},ue=o();ue[te["default"]]=se,ue.style=ie;var ce=3,de=[],he=function(e,t,n,r){"production"!==process.env.NODE_ENV&&(v("elementOpen"),y("elementOpen"));var a=Y(e,t),o=s(a);if(!o.staticsApplied){if(n)for(var i=0;i<n.length;i+=2){var l=n[i],u=n[i+1];le(a,l,u)}o.staticsApplied=!0}for(var c=o.attrsArr,d=o.newAttrs,h=!c.length,g=ce,m=0;g<arguments.length;g+=2,m+=2){var f=arguments[g];if(h)c[m]=f,d[f]=void 0;else if(c[m]!==f)break;var u=arguments[g+1];(h||c[m+1]!==u)&&(c[m+1]=u,le(a,f,u))}if(g<arguments.length||m<c.length){for(;g<arguments.length;g+=1,m+=1)c[m]=arguments[g];for(m<c.length&&(c.length=m),g=0;g<c.length;g+=2){var l=c[g],u=c[g+1];d[l]=u}for(var p in d)le(a,p,d[p]),d[p]=void 0}return a},ge=function(e,t,n){"production"!==process.env.NODE_ENV&&(v("elementOpenStart"),C(!0)),de[0]=e,de[1]=t,de[2]=n},me=function(e,t){"production"!==process.env.NODE_ENV&&_("attr"),de.push(e),de.push(t)},fe=function(){"production"!==process.env.NODE_ENV&&(_("elementOpenEnd"),C(!1));var e=he.apply(null,de);return de.length=0,e},pe=function(e){"production"!==process.env.NODE_ENV&&v("elementClose");var t=W();return"production"!==process.env.NODE_ENV&&E(s(t).nodeName,e),t},ve=function(e,t,n,r){return he.apply(null,arguments),pe(e)},ye=function(e,t){"production"!==process.env.NODE_ENV&&(v("text"),y("text"));var n=Q(),r=s(n);if(r.text!==e){r.text=e;for(var a=e,o=1;o<arguments.length;o+=1){var i=arguments[o];a=i(a)}n.data=a}return n};exports.patch=U,exports.patchInner=U,exports.patchOuter=F,exports.currentElement=J,exports.currentPointer=Z,exports.skip=X,exports.skipNode=ee,exports.elementVoid=ve,exports.elementOpenStart=ge,exports.elementOpenEnd=fe,exports.elementOpen=he,exports.elementClose=pe,exports.text=ye,exports.attr=me,exports.symbols=te,exports.attributes=ue,exports.applyAttr=re,exports.applyProp=ae,exports.notifications=h,exports.importNode=l}.call(this),function(){!function(e,t){"object"===("undefined"==typeof exports?"undefined":babelHelpers["typeof"](exports))&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.IncrementalDOM=e.IncrementalDOM||{})}(this,function(e){"use strict";e.buffer=[],e.currentParent=null;var t=function(){return e.currentParent},n=function(){return{}},r=function(t,n,r){return e.currentParent=t,n(r),e.currentParent.innerHTML=e.buffer.join(""),e.buffer=[],e.currentParent},a=r,o=r,i=function(t,n){for(var r=t,a=1;a<arguments.length;a+=1){var o=arguments[a];r=o(r)}e.buffer.push(r)},s={"default":"__default"},l={},u=function(e,t,n){var r=l[t]||l[s["default"]];r(e,t,n)};l[s["default"]]=function(e,t,n){Array.isArray(e)&&e.push(" "+t+'="'+n+'"')};var c=function(e,t){for(;e.length>t;)e.pop()},d=3,h=[],g=function(e,t){h.push(e),h.push(t)},m=function(t){return"function"==typeof t?void new t:void e.buffer.push("</"+t+">")},f=function(e,t,n,r){return p.apply(null,arguments),m(e)},p=function(t,n,r,a){if("function"==typeof t)return new t,e.currentParent;if(e.buffer.push("<"+t),r)for(var o=0;o<r.length;o+=2){var i=r[o],s=r[o+1];u(e.buffer,i,s)}for(var l=d,c=0;l<arguments.length;l+=2,c+=2){var h=arguments[l],g=arguments[l+1];u(e.buffer,h,g)}return e.buffer.push(">"),e.currentParent},v=function(){p.apply(null,h),c(h,0)},y=function(e,t,n){h[0]=e,h[1]=t,h[2]=n},_=function(e){return r({},e),t().innerHTML};e.currentElement=t,e.currentPointer=n,e.patch=r,e.patchInner=o,e.patchOuter=a,e.text=i,e.attr=g,e.elementClose=m,e.elementOpen=p,e.elementOpenEnd=v,e.elementOpenStart=y,e.elementVoid=f,e.renderToString=_,e.symbols=s,e.attributes=l,e.updateAttribute=u,Object.defineProperty(e,"__esModule",{value:!0})})}.call(this),function(){var e=this.metalNamed["incremental-dom-cjs"],t=this.metalNamed["incremental-dom-string"],n=this.metalNamed.metal.isServerSide;if(n())global.IncrementalDOM=t;else{var r="undefined"!=typeof exports&&"undefined"!=typeof global?global:window;r.IncrementalDOM=e}}.call(this),function(){function e(e){e[n]=null}function t(e){return e[n]||(e[n]={}),e[n]}var n="__METAL_IC_RENDERER_DATA__";this.metalNamed.data=this.metalNamed.data||{},this.metalNamed.data.clearData=e,this.metalNamed.data.getData=t}.call(this),function(){function e(e){e.changes=null}function t(e,t){e.changes=e.changes||{};var n=t.type||"props";e.changes[n]=e.changes[n]||{},e.changes[n][t.key]=t}function n(e){return a(e).changes}function r(e){var n=a(e);e.on("stateKeyChanged",t.bind(null,n))}var a=this.metalNamed.data.getData;this.metalNamed.changes=this.metalNamed.changes||{},this.metalNamed.changes.clearChanges=e,this.metalNamed.changes.getChanges=n,this.metalNamed.changes.trackChanges=r}.call(this),function(){function e(e){var t={};e[1]&&(t.key=e[1]);for(var n=(e[2]||[]).concat(e.slice(3)),r=0;r<n.length;r+=2)t[n[r]]=n[r+1];return t}function t(e,t){for(var n=[e,t.key,[]],r=Object.keys(t),a=0;a<r.length;a++)"children"!==r[a]&&"key"!==r[a]&&n.push(r[a],t[r[a]]);return n}this.metalNamed.callArgs=this.metalNamed.callArgs||{},this.metalNamed.callArgs.buildConfigFromCall=e,this.metalNamed.callArgs.buildCallFromConfig=t}.call(this),function(){function e(){return d}function t(e){return d[e]}function n(e){e.attr=a,e.elementOpenEnd=i,e.elementOpenStart=o,e.elementVoid=s,h.push(e)}function r(){h.pop()}function a(e,t){g.push(e,t)}function o(e,t,n){g=[e,t,n]}function i(){var e;return(e=IncrementalDOM).elementOpen.apply(e,babelHelpers.toConsumableArray(g))}function s(){return IncrementalDOM.elementOpen.apply(null,arguments),IncrementalDOM.elementClose.apply(null,arguments)}function l(){return h.length>0?h[h.length-1]:null}function u(e){var t={name:e},n=c.bind(t);return n}function c(){var e=this.name,t=l(),n=t&&t[e]||d[e];return n.apply(null,arguments)}this.metalNamed["incremental-dom-aop"]=this.metalNamed["incremental-dom-aop"]||{},this.metalNamed["incremental-dom-aop"].getOriginalFns=e,this.metalNamed["incremental-dom-aop"].getOriginalFn=t,this.metalNamed["incremental-dom-aop"].startInterception=n,this.metalNamed["incremental-dom-aop"].stopInterception=r;var d={attr:IncrementalDOM.attr,attributes:IncrementalDOM.attributes[IncrementalDOM.symbols["default"]],elementClose:IncrementalDOM.elementClose,elementOpen:IncrementalDOM.elementOpen,elementOpenEnd:IncrementalDOM.elementOpenEnd,elementOpenStart:IncrementalDOM.elementOpenStart,elementVoid:IncrementalDOM.elementVoid,text:IncrementalDOM.text},h=[],g=[];IncrementalDOM.attr=u("attr"),IncrementalDOM.elementClose=u("elementClose"),IncrementalDOM.elementOpen=u("elementOpen"),IncrementalDOM.elementOpenEnd=u("elementOpenEnd"),IncrementalDOM.elementOpenStart=u("elementOpenStart"),IncrementalDOM.elementVoid=u("elementVoid"),IncrementalDOM.text=u("text"),IncrementalDOM.attributes[IncrementalDOM.symbols["default"]]=u("attributes")}.call(this),function(){function e(e,t,n){_=e,p=t,f=n,b={props:{children:[]}},b.config=b.props,v=b,y=!0,h({elementClose:i,elementOpen:s,text:l})}function t(e){return d(e.tag)}function n(e){return e[m]}function r(e,t){if(y)return void o(e);if(!t||!t.call(null,e))if(d(e.text)){var a=e.args?e.args:[];a[0]=e.text,IncrementalDOM.text.apply(null,a)}else{var i=u(e.tag,e.props);if(i[0]={tag:i[0],owner:n(e)},IncrementalDOM.elementOpen.apply(null,i),e.props.children)for(var s=0;s<e.props.children.length;s++)r(e.props.children[s],t);IncrementalDOM.elementClose(e.tag)}}function a(e,t){var n=babelHelpers.defineProperty({parent:v},m,_);return t?(n.text=e[0],e.length>1&&(n.args=e)):(n.tag=e[0],n.props=c(e),n.props.children=[],n.config=n.props),o(n),n}function o(e){v.props.children.push(e)}function i(){if(v===b){g(),y=!1;var e=p.call(_,b,f);return p=null,f=null,v=null,_=null,b=null,e}return v=v.parent,!0}function s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];v=a(t)}function l(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];a(t,!0)}var u=this.metalNamed.callArgs.buildCallFromConfig,c=this.metalNamed.callArgs.buildConfigFromCall,d=this.metalNamed.metal.isDef,h=this.metalNamed["incremental-dom-aop"].startInterception,g=this.metalNamed["incremental-dom-aop"].stopInterception,m="__metalChildOwner";this.metalNamed.children=this.metalNamed.children||{},this.metalNamed.children.CHILD_OWNER=m,this.metalNamed.children.captureChildren=e,this.metalNamed.children.isChildTag=t,this.metalNamed.children.getOwner=n,this.metalNamed.children.renderChildTree=r;var f=void 0,p=void 0,v=void 0,y=!1,_=void 0,b=void 0}.call(this),function(){function e(e,n,r,l){var u=o(r);return u?void t(e,n,r,u,l):(l=a(r,l),s(n,r,l),void(h(l)?i(n,r,l):d("attributes")(n,r,l)))}function t(e,t,n,r,a){if(!l()){var o=r+f;t[o]&&(t[o].removeListener(),t[o]=null),a&&(t[n]=a,t[o]=u(document,r,t,a))}}function n(e,t){for(var n=Object.keys(t),a=0;a<n.length;a++){var o=n[a];t[o]=r(e,o,t[o])}}function r(e,t,n){if(m(n)){var r=o(t);if(r){var a=c(e,n);if(a)return a}}return n}function a(e,t){return"checked"===e&&(t=g(t)&&t!==!1),t}function o(e){var t=p.exec(e),n=t?t[1]?t[1]:t[2]:null;return n?n.toLowerCase():null}function i(e,t,n){l()||(e[t]=n,n?e.setAttribute(t,""):e.removeAttribute(t))}function s(e,t,n){l()||"value"===t&&e.value!==n&&(e[t]=n)}var l=this.metalNamed.metal.isServerSide,u=this.metalNamed.dom.delegate,c=this.metalNamed.component.getComponentFn,d=this.metalNamed["incremental-dom-aop"].getOriginalFn,h=this.metalNamed.metal.isBoolean,g=this.metalNamed.metal.isDefAndNotNull,m=this.metalNamed.metal.isString,f="__handle__",p=/^(?:on([A-Z].+))|(?:data-on(.+))$/;this.metalNamed.attributes=this.metalNamed.attributes||{},this.metalNamed.attributes.applyAttribute=e,this.metalNamed.attributes.convertListenerNamesToFns=n}.call(this),function(){function e(){if(!a){a=!0;for(var e=0;e<r.length;e++){var t=r[e];t.isDisposed()||n(t).parent||(t.element=null,t.dispose())}r=[],a=!1}}function t(e){for(var t=0;t<e.length;t++)e[t].isDisposed()||(n(e[t]).parent=null,r.push(e[t]))}var n=this.metalNamed.data.getData,r=[],a=!1;this.metalNamed.unused=this.metalNamed.unused||{},this.metalNamed.unused.disposeUnused=e,this.metalNamed.unused.schedule=t}.call(this),function(){function e(e,t){t["class"]?(t["class"]+=" "+e,t["class"]=E(t["class"])):t["class"]=e}function t(e){return 0===e.length?re:e}function n(e){X(),B(e).rootElementReached||(e.element=null),e.informRendered(),r()}function r(){ne.pop(),0===ne.length&&W()}function a(e,t){var n=B(e);return!n.rootElementReached&&n.config.key&&(t=n.config.key),e.getRenderer().generateKey(e,t)}function o(e){return e.childComponents=e.childComponents||[],e.childComponents}function i(){return ne[ne.length-1]}function s(){var e=IncrementalDOM.currentElement(),t=i(),n=B(t);return n.rootElementReached&&e!==t.element.parentNode&&(n=j.get(e)),n.icComponentsData=n.icComponentsData||{},n.icComponentsData}function l(e,t){var n=V();if(n){var r=e.getRenderer(),a=n.renderers,o=!a||a.indexOf(r)!==-1||a.indexOf(r.RENDERER_NAME)!==-1;if(o&&t.key&&!t.ref)return t.key}return t.ref}function u(e,t,n){var r=e;K(r)&&(r=te.getConstructor(e));var a=l(n,t),o=void 0;if($(a))o=_(n.components[a],r,t,n),n.components[a]=o,n.refs[a]=o;else{var i=s(),u=t.key;if(!$(u)){var c=q(r,!0);i.currCount=i.currCount||{},i.currCount[c]=i.currCount[c]||0,u="__METAL_IC__"+c+"_"+i.currCount[c]++}o=_(i.prevComps?i.prevComps[u]:null,r,t,n),i.currComps=i.currComps||{},i.currComps[u]=o}return o}function c(e,n){var r=n.props,a=n.tag;return r.children=t(e.props.children),C(a,r)}function d(e){if(e.tag&&v(e.tag))return e.props.children=t(e.props.children),C(e.tag,e.props,M(e)),!0}function h(e,t,n){L(i(),e,t,n)}function g(e){return v(e)?f.apply(null,arguments):m.apply(null,arguments)}function m(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=w(n),s=n[0],l=i(),u=l;if(x(s)&&(u=s.owner,s=s.tag),o.key=a(l,o.key),!B(l).rootElementReached){var c=l.getDataManager().get(l,"elementClasses");c&&e(c,o)}T(l,o);var d=I(s,o),h=J("elementOpen").apply(null,d);return O(h),P(l,h),G(o.ref)&&(u.refs[o.ref]=h),u.getRenderer().handleNodeRendered(h),h}function f(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];H(i(),c,{props:w(t),tag:t[0]})}function p(e,t){var n=B(e),r=n.config;if(!n.rootElementReached&&r&&K(r.elementClasses)){var a="";K(t.elementClasses)&&(a=t.elementClasses+" "),t.elementClasses=a+r.elementClasses}}function v(e){return z(e)||K(e)&&e[0]===e[0].toUpperCase()}function y(e,t,n){return!(!e||e.constructor!==t||e.isDisposed())&&B(e).owner===n}function _(e,t,n,r){return y(e,t,r)?(e.startSkipUpdates(),e.getDataManager().replaceNonInternal(e,n),e.stopSkipUpdates()):e=new t(n,(!1)),B(e).config=n,e}function b(e){ne.push(e);var t=B(e);D(t.icComponentsData),F(t),t.rootElementReached=!1,e.refs={},t.childComponents&&(Q(t.childComponents),t.childComponents=null),Z({attributes:h,elementOpen:g})}function E(e){for(var t=[],n=e.split(/\s+/),r={},a=0;a<n.length;a++)r[n[a]]||(r[n[a]]=!0,t.push(n[a]));return t.join(" ")}function N(e){b(e),e.getRenderer().renderIncDom(e),n(e)}function S(e){U(e,d)}function C(e,t,n){if(K(e)||e.prototype.getRenderer){var r=R(e,t,n);return P(i(),r.element),r.element}return e(t)}function k(e,t,n,r){if(!ee.isComponentCtor(t)){var a=t,o=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"created",value:function(){var e=i();e&&A(this,e)}},{key:"render",value:function(){a(this.getInitialConfig())}}]),t}(ee);o.RENDERER=e,t=o}return ee.render(t,n,r)}function R(e,t,n){var r=i(),a=n||r;p(r,t);var s=u(e,t,a);A(s,r);var l=B(s);l.parent=r,l.owner=a;var c=B(r);return o(c).push(s),t.key||c.rootElementReached||(t.key=c.config.key),s.getRenderer().renderInsidePatch(s),s.wasRendered||s.renderComponent(),s}function D(e){e&&(e.prevComps=e.currComps,e.currComps=null,e.currCount=null)}function O(e){j.has(e)&&D(j.get(e).icComponentsData)}function A(e,t){var n=e.context,r=t.getChildContext?t.getChildContext():null;Y.mixin(n,t.context,r),e.context=n}function P(e,t){var n=B(e);n.rootElementReached||(n.rootElementReached=!0,e.element!==t&&(e.element=t))}var L=this.metalNamed.attributes.applyAttribute,T=this.metalNamed.attributes.convertListenerNamesToFns,w=this.metalNamed.callArgs.buildConfigFromCall,I=this.metalNamed.callArgs.buildCallFromConfig,H=this.metalNamed.children.captureChildren,M=this.metalNamed.children.getOwner,x=this.metalNamed.children.isChildTag,U=this.metalNamed.children.renderChildTree,F=this.metalNamed.changes.clearChanges,j=this.metalNamed.dom.domData,B=this.metalNamed.data.getData,V=this.metalNamed.metal.getCompatibilityModeData,q=this.metalNamed.metal.getUid,$=this.metalNamed.metal.isDef,G=this.metalNamed.metal.isDefAndNotNull,z=this.metalNamed.metal.isFunction,K=this.metalNamed.metal.isString,Y=this.metalNamed.metal.object,W=this.metalNamed.unused.disposeUnused,Q=this.metalNamed.unused.schedule,J=this.metalNamed["incremental-dom-aop"].getOriginalFn,Z=this.metalNamed["incremental-dom-aop"].startInterception,X=this.metalNamed["incremental-dom-aop"].stopInterception,ee=this.metalNamed.component.Component,te=this.metalNamed.component.ComponentRegistry,ne=[],re=[];this.metalNamed.render=this.metalNamed.render||{},
this.metalNamed.render.getComponentBeingRendered=i,this.metalNamed.render.isComponentTag_=v,this.metalNamed.render.render=N,this.metalNamed.render.renderChild=S,this.metalNamed.render.renderFunction=k}.call(this),function(){function e(e){if(!e||!e.parentNode){var t=document.createElement("div");return e&&i(t,e),t}}function t(e,t,n){c.push(e);var r=l(e);r.render||(r.render=u.bind(null,e));var a=n?IncrementalDOM.patchOuter:IncrementalDOM.patch;a(t,r.render),c.pop()}function n(){return c[c.length-1]}function r(e){if(!a(e)&&!o(e)){var n=e.element;t(e,n,!0)}}function a(e){var t=l(e);if(!e.element&&t.parent)return t.parent.getRenderer().patch(t.parent),!0}function o(n){var r=e(n.element);if(r){if(t(n,r),s(n.element),n.element&&n.inDocument){var a=n.getAttachData();n.attachElement(a.parent,a.sibling)}return!0}}var i=this.metalNamed.dom.append,s=this.metalNamed.dom.exitDocument,l=this.metalNamed.data.getData,u=this.metalNamed.render.render,c=[];this.metalNamed.patch=this.metalNamed.patch||{},this.metalNamed.patch.getPatchingComponent=n,this.metalNamed.patch.patch=r}.call(this),function(){var e=this.metalNamed.changes.getChanges,t=this.metalNamed.changes.trackChanges,n=this.metalNamed.data.clearData,r=this.metalNamed.data.getData,a=this.metalNamed.children.getOwner,o=this.metalNamed.patch.getPatchingComponent,i=this.metalNamed.patch.patch,s=this.metalNamed.render.render,l=this.metalNamed.render.renderChild,u=this.metalNamed.render.renderFunction,c=this.metalNamed.component.Component,d=this.metalNamed.component.ComponentRenderer,h=function(d){function h(){return babelHelpers.classCallCheck(this,h),babelHelpers.possibleConstructorReturn(this,(h.__proto__||Object.getPrototypeOf(h)).apply(this,arguments))}return babelHelpers.inherits(h,d),babelHelpers.createClass(h,[{key:"buildShouldUpdateArgs",value:function(e){return[e.props]}},{key:"dispose",value:function(e){var t=r(e),a=t.config.ref,o=t.owner;if(o&&o.components&&o.components[a]===e&&delete o.components[a],t.childComponents)for(var i=0;i<t.childComponents.length;i++){var s=t.childComponents[i];s.isDisposed()||(s.element=null,s.dispose())}n(e)}},{key:"generateKey",value:function(e,t){return t}},{key:"getConfig",value:function(e){return r(e).config}},{key:"getData",value:function(e){return r(e)}},{key:"getPatchingComponent",value:function(){return o()}},{key:"handleNodeRendered",value:function(){}},{key:"isIncDomNode",value:function(e){return!!a(e)}},{key:"patch",value:function(e){i(e)}},{key:"render",value:function(e,t,n){return e instanceof c?void this.patch(e):u(this,e,t,n)}},{key:"renderChild",value:function(e){l(e)}},{key:"renderIncDom",value:function(e){e.render?e.render():IncrementalDOM.elementVoid("div")}},{key:"renderInsidePatch",value:function(t){var n=!t.wasRendered||this.shouldUpdate(t,e(t))||IncrementalDOM.currentPointer()!==t.element;n?s(t):t.element&&this.skipRender()}},{key:"setUp",value:function(e){e.context={},e.components={},e.refs={};var n=r(e);n.config=e.getInitialConfig(),t(e)}},{key:"shouldUpdate",value:function(e,t){return!!t&&(!e.shouldUpdate||e.shouldUpdate.apply(e,babelHelpers.toConsumableArray(this.buildShouldUpdateArgs(t))))}},{key:"skipNextChildrenDisposal",value:function(e){r(e).childComponents=null}},{key:"skipRender",value:function(){IncrementalDOM.skipNode()}},{key:"update",value:function(t){this.shouldUpdate(t,e(t))&&this.patch(t)}}]),h}(d.constructor),g=new h;g.RENDERER_NAME="incremental-dom",this.metal.IncrementalDomRenderer=g}.call(this),function(){var e=this.metalNamed.metal.core,t=this.metalNamed.metal.getFunctionName,n=this.metalNamed.metal.object,r=this.metalNamed.senna.App,a=this.metalNamed.senna.RequestScreen,o=this.metalNamed.senna.Route,i=this.metal.Promise,s=this.metalNamed.component.Component,l=this.metalNamed.component.ComponentRegistry,u=this.metal.IncrementalDomRenderer,c=this.metal.Uri,d=function(t){function a(){return babelHelpers.classCallCheck(this,a),babelHelpers.possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return babelHelpers.inherits(a,t),babelHelpers.createClass(a,[{key:"created",value:function(){this.route=new o(this.path,this.createScreen_.bind(this)),this.route.router=this,a.router().addRoutes(this.route),this.firstRenderElement=this.element,this.element=null}},{key:"addRoutingData",value:function(e,t){if(this.includeRoutingData){var r=this.lastExtractedParams||this.extractParams(e),a=this.extractQuery(e);return n.mixin({},t,{router:{currentUrl:e,params:r,query:a}})}return t}},{key:"attached",value:function(){this.wasRendered||(this.element=this.firstRenderElement)}},{key:"createScreen_",value:function(){return this.screen_=new a.defaultScreen(this),this.screen_}},{key:"disposeInternal",value:function(){a.activeRouter===this&&(a.activeRouter=null),a.router().removeRoute(this.route),babelHelpers.get(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"disposeInternal",this).call(this)}},{key:"extractParams",value:function(e){return a.router().extractParams(this.route,e)}},{key:"extractQuery",value:function(e){for(var t=new c(e),n={},r=t.getParameterNames(),a=0;a<r.length;a++){var o=r[a];n[o]=t.getParameterValue(o)}return n}},{key:"getRouteComponent",value:function(){return this.components.comp}},{key:"getScreen",value:function(){return this.screen_}},{key:"render",value:function(){if(this.isActive_){var e;(e=IncrementalDOM).elementVoid.apply(e,[this.component,null,null,"ref","comp"].concat(babelHelpers.toConsumableArray(this.toArray_(a.activeState))))}}},{key:"setterComponentFn_",value:function(t){return e.isString(t)&&(t=l.getConstructor(t)),t}},{key:"shouldUpdate",value:function(e){return e.isActive_||e.component}},{key:"toArray_",value:function(e){for(var t=[],n=Object.keys(e||{}),r=0;r<n.length;r++)t.push(n[r],e[n[r]]);return t}}],[{key:"getActiveComponent",value:function(){return a.activeRouter?a.activeRouter.getRouteComponent():null}},{key:"getActiveState",value:function(){return a.activeState}},{key:"router",value:function(){if(!a.routerInstance){var e=new r;e.setIgnoreQueryStringFromRoutePath(!0),a.routerInstance=e}return a.routerInstance}}]),a}(s);d.RENDERER=u,d.STATE={beforeDeactivateHandler:{validator:function(t){return e.isString(t)||e.isFunction(t)}},cacheable:{validator:e.isBoolean,value:!0},component:{setter:"setterComponentFn_"},data:{setter:function(t){return e.isFunction(t)?t:function(){return t||{}}}},fetch:{value:!1},fetchUrl:{validator:function(t){return e.isString(t)||e.isFunction(t)}},fetchTimeout:{validator:function(t){return e.isNumber(t)||!e.isDefAndNotNull(t)},value:3e4},includeRoutingData:{value:!0},isActive_:{internal:!0,value:!1},path:{}},d.activeRouter=null,d.activeState=null;var h=function(n){function r(e){babelHelpers.classCallCheck(this,r);var t=babelHelpers.possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));if(!e)throw new Error("Router not specified for component screen.");return t.router=e,t.timeout=e.fetchTimeout,t}return babelHelpers.inherits(r,n),babelHelpers.createClass(r,[{key:"beforeDeactivate",value:function(){var n=this.router.beforeDeactivateHandler;if(n){if(e.isString(n)){var r=this.router.getRouteComponent();if(r&&e.isFunction(r[n]))return r[n]();var a=t(r);throw new Error('No function named "'+n+'" exists inside '+a+".")}return n()}}},{key:"beforeUpdateHistoryPath",value:function(e){return this.router.fetchUrl?e:babelHelpers.get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"beforeUpdateHistoryPath",this).call(this,e)}},{key:"evaluateScripts",value:function(){}},{key:"evaluateStyles",value:function(){}},{key:"flip",value:function(){this.maybeRedirectRouter(),d.activeState=this.router.addRoutingData(this.router.lastPath,this.maybeParseLastLoadedStateAsJson()),d.activeRouter&&(d.activeRouter.isActive_=!1,this.reuseActiveRouterElementInNewRouter_(this.router));var e=this.waitRouterRenderSubComponents(this.router);return d.activeRouter=this.router,d.activeRouter.isActive_=!0,e}},{key:"getFetchUrl_",value:function(t){var n=this.router.fetchUrl||t;return e.isFunction(n)&&(n=n(t)),n}},{key:"load",value:function(e){var t=this;this.setCacheable(this.router.cacheable);var n=i.resolve(),a=void 0;return this.router.fetch?n=n.then(function(){return babelHelpers.get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"load",t).call(t,t.getFetchUrl_(e))}):(a=this.router.extractParams(e),n=n.then(function(){return t.router.data(e,a)})),n.then(function(n){return t.router.lastPath=e,t.router.lastRedirectPath=t.maybeFindRedirectPath(),t.router.lastLoadedState=n,t.router.lastExtractedParams=a,n})}},{key:"maybeFindRedirectPath",value:function(){var e=this.beforeUpdateHistoryPath(this.router.lastPath);return e!==this.router.lastPath?e:null}},{key:"maybeFindRedirectRouter",value:function(){var e=this.maybeFindRedirectPath();if(e){var t=d.router().findRoute(e);if(t)return t.router.lastPath=this.router.lastRedirectPath,t.router.lastLoadedState=this.router.lastLoadedState,t.router}return null}},{key:"maybeParseLastLoadedStateAsJson",value:function(){var t=this.router.lastLoadedState;try{return JSON.parse(t)}catch(n){return e.isDefAndNotNull(t)?t:{}}}},{key:"maybeRedirectRouter",value:function(){var e=this.maybeFindRedirectRouter();if(e){this.router=e;var t=d.router();t.once("endNavigate",function(){t.screens[t.redirectPath]=t.screens[t.activePath],delete t.screens[t.activePath]})}}},{key:"reuseActiveRouterElementInNewRouter_",value:function(e){var t=d.activeRouter;t!==e&&t.firstRenderElement===e.firstRenderElement&&(e.element=t.element,t.element=null)}},{key:"waitRouterRenderSubComponents",value:function(e){return new Promise(function(t){return e.once("rendered",t)})}}]),r}(a);d.defaultScreen=h,this.metal.Router=d}.call(this),function(){(function(){this.CLOSURE_NO_DEPS=!0,this.goog=this.goog||{};var COMPILED=!1,goog=this.goog||{};goog.global=this,goog.global.CLOSURE_UNCOMPILED_DEFINES,goog.global.CLOSURE_DEFINES,goog.isDef=function(e){return void 0!==e},goog.exportPath_=function(e,t,n){var r=e.split("."),a=n||goog.global;r[0]in a||!a.execScript||a.execScript("var "+r[0]);for(var o;r.length&&(o=r.shift());)!r.length&&goog.isDef(t)?a[o]=t:a=a[o]?a[o]:a[o]={}},goog.define=function(e,t){var n=t;COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,e)?n=goog.global.CLOSURE_UNCOMPILED_DEFINES[e]:goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,e)&&(n=goog.global.CLOSURE_DEFINES[e])),goog.exportPath_(e,n)},goog.define("goog.DEBUG",!0),goog.define("goog.LOCALE","en"),goog.define("goog.TRUSTED_SITE",!0),goog.define("goog.STRICT_MODE_COMPATIBLE",!1),goog.define("goog.DISALLOW_TEST_ONLY_CODE",COMPILED&&!goog.DEBUG),goog.define("goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING",!1),goog.provide=function(e){if(!COMPILED&&goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');goog.constructNamespace_(e)},goog.constructNamespace_=function(e,t){if(!COMPILED){delete goog.implicitNamespaces_[e];for(var n=e;(n=n.substring(0,n.lastIndexOf(".")))&&!goog.getObjectByName(n);)goog.implicitNamespaces_[n]=!0}goog.exportPath_(e,t)},goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/,goog.module=function(e){if(!goog.isString(e)||!e||e.search(goog.VALID_MODULE_RE_)==-1)throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+e+" has been loaded incorrectly.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");if(goog.moduleLoaderState_.moduleName=e,!COMPILED){if(goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');delete goog.implicitNamespaces_[e]}},goog.module.get=function(e){return goog.module.getInternal_(e)},goog.module.getInternal_=function(e){if(!COMPILED)return goog.isProvided_(e)?e in goog.loadedModules_?goog.loadedModules_[e]:goog.getObjectByName(e):null},goog.moduleLoaderState_=null,goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_},goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_())throw new Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0},goog.setTestOnly=function(e){if(goog.DISALLOW_TEST_ONLY_CODE)throw e=e||"",Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))},COMPILED||(goog.isProvided_=function(e){return e in goog.loadedModules_||!goog.implicitNamespaces_[e]&&goog.isDefAndNotNull(goog.getObjectByName(e))},goog.implicitNamespaces_={"goog.module":!0}),goog.getObjectByName=function(e,t){for(var n,r=e.split("."),a=t||goog.global;n=r.shift();){if(!goog.isDefAndNotNull(a[n]))return null;a=a[n]}return a},goog.globalize=function(e,t){var n=t||goog.global;for(var r in e)n[r]=e[r]},goog.addDependency=function(e,t,n,r){if(goog.DEPENDENCIES_ENABLED){var a,o,i=e.replace(/\\/g,"/"),s=goog.dependencies_;r&&"boolean"!=typeof r||(r=r?{module:"goog"}:{});for(var l=0;a=t[l];l++)s.nameToPath[a]=i,s.pathIsModule[i]="goog"==r.module;for(var u=0;o=n[u];u++)i in s.requires||(s.requires[i]={}),s.requires[i][o]=!0}},goog.define("goog.ENABLE_DEBUG_LOADER",!0),goog.logToConsole_=function(e){goog.global.console&&goog.global.console.error(e)},goog.require=function(e){if(!COMPILED){if(goog.ENABLE_DEBUG_LOADER&&goog.IS_OLD_IE_&&goog.maybeProcessDeferredDep_(e),goog.isProvided_(e))return goog.isInModuleLoader_()?goog.module.getInternal_(e):null;if(goog.ENABLE_DEBUG_LOADER){var t=goog.getPathFromDeps_(e);if(t)return goog.writeScripts_(t),null}var n="goog.require could not find: "+e;throw goog.logToConsole_(n),Error(n)}},goog.basePath="",goog.global.CLOSURE_BASE_PATH,goog.global.CLOSURE_NO_DEPS,goog.global.CLOSURE_IMPORT_SCRIPT,goog.nullFunction=function(){},goog.abstractMethod=function(){throw Error("unimplemented abstract method")},goog.addSingletonGetter=function(e){e.getInstance=function(){return e.instance_?e.instance_:(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=e),e.instance_=new e)}},goog.instantiatedSingletons_=[],goog.define("goog.LOAD_MODULE_USING_EVAL",!0),goog.define("goog.SEAL_MODULE_EXPORTS",goog.DEBUG),goog.loadedModules_={},goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER,goog.DEPENDENCIES_ENABLED&&(goog.dependencies_={pathIsModule:{},nameToPath:{},requires:{},visited:{},written:{},deferred:{}},goog.inHtmlDocument_=function(){var e=goog.global.document;return null!=e&&"write"in e},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH))return void(goog.basePath=goog.global.CLOSURE_BASE_PATH);if(goog.inHtmlDocument_())for(var e=goog.global.document,t=e.getElementsByTagName("SCRIPT"),n=t.length-1;n>=0;--n){var r=t[n],a=r.src,o=a.lastIndexOf("?"),i=o==-1?a.length:o;if("base.js"==a.substr(i-7,7))return void(goog.basePath=a.substr(0,i-7))}},goog.importScript_=function(e,t){var n=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;n(e,t)&&(goog.dependencies_.written[e]=!0)},goog.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.importModule_=function(e){var t='goog.retrieveAndExecModule_("'+e+'");';goog.importScript_("",t)&&(goog.dependencies_.written[e]=!0)},goog.queuedModules_=[],goog.wrapModule_=function(e,t){return goog.LOAD_MODULE_USING_EVAL&&goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(t+"\n//# sourceURL="+e+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+t+"\n;return exports});\n//# sourceURL="+e+"\n"},goog.loadQueuedModules_=function(){var e=goog.queuedModules_.length;if(e>0){var t=goog.queuedModules_;goog.queuedModules_=[];for(var n=0;n<e;n++){var r=t[n];goog.maybeProcessDeferredPath_(r)}}},goog.maybeProcessDeferredDep_=function(e){if(goog.isDeferredModule_(e)&&goog.allDepsAreAvailable_(e)){var t=goog.getPathFromDeps_(e);goog.maybeProcessDeferredPath_(goog.basePath+t)}},goog.isDeferredModule_=function(e){var t=goog.getPathFromDeps_(e);if(t&&goog.dependencies_.pathIsModule[t]){var n=goog.basePath+t;return n in goog.dependencies_.deferred}return!1},goog.allDepsAreAvailable_=function(e){var t=goog.getPathFromDeps_(e);if(t&&t in goog.dependencies_.requires)for(var n in goog.dependencies_.requires[t])if(!goog.isProvided_(n)&&!goog.isDeferredModule_(n))return!1;return!0},goog.maybeProcessDeferredPath_=function(e){if(e in goog.dependencies_.deferred){var t=goog.dependencies_.deferred[e];delete goog.dependencies_.deferred[e],goog.globalEval(t)}},goog.loadModuleFromUrl=function(e){goog.retrieveAndExecModule_(e)},goog.loadModule=function(e){var t=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:void 0,declareLegacyNamespace:!1};var n;if(goog.isFunction(e))n=e.call(goog.global,{});else{if(!goog.isString(e))throw Error("Invalid module definition");n=goog.loadModuleFromSource_.call(goog.global,e)}var r=goog.moduleLoaderState_.moduleName;if(!goog.isString(r)||!r)throw Error('Invalid module name "'+r+'"');goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(r,n):goog.SEAL_MODULE_EXPORTS&&Object.seal&&Object.seal(n),goog.loadedModules_[r]=n}finally{goog.moduleLoaderState_=t}},goog.loadModuleFromSource_=function(){"use strict";var exports={};return eval(arguments[0]),exports},goog.writeScriptSrcNode_=function(e){goog.global.document.write('<script type="text/javascript" src="'+e+'"></script>')},goog.appendScriptSrcNode_=function(e){var t=goog.global.document,n=t.createElement("script");n.type="text/javascript",n.src=e,n.defer=!1,n.async=!1,t.head.appendChild(n)},goog.writeScriptTag_=function(e,t){if(goog.inHtmlDocument_()){var n=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&"complete"==n.readyState){var r=/\bdeps.js$/.test(e);if(r)return!1;throw Error('Cannot write "'+e+'" after document load')}var a=goog.IS_OLD_IE_;if(void 0===t)if(a){var o=" onreadystatechange='goog.onScriptLoad_(this, "+ ++goog.lastNonModuleScriptIndex_+")' ";n.write('<script type="text/javascript" src="'+e+'"'+o+"></script>")}else goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?goog.appendScriptSrcNode_(e):goog.writeScriptSrcNode_(e);else n.write('<script type="text/javascript">'+t+"</script>");return!0}return!1},goog.lastNonModuleScriptIndex_=0,goog.onScriptLoad_=function(e,t){return"complete"==e.readyState&&goog.lastNonModuleScriptIndex_==t&&goog.loadQueuedModules_(),!0},goog.writeScripts_=function(e){function t(e){if(!(e in a.written||e in a.visited)){if(a.visited[e]=!0,e in a.requires)for(var o in a.requires[e])if(!goog.isProvided_(o)){if(!(o in a.nameToPath))throw Error("Undefined nameToPath for "+o);t(a.nameToPath[o])}e in r||(r[e]=!0,n.push(e))}}var n=[],r={},a=goog.dependencies_;t(e);for(var o=0;o<n.length;o++){var i=n[o];goog.dependencies_.written[i]=!0}var s=goog.moduleLoaderState_;goog.moduleLoaderState_=null;for(var o=0;o<n.length;o++){var i=n[o];if(!i)throw goog.moduleLoaderState_=s,Error("Undefined script input");a.pathIsModule[i]?goog.importModule_(goog.basePath+i):goog.importScript_(goog.basePath+i)}goog.moduleLoaderState_=s},goog.getPathFromDeps_=function(e){return e in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[e]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js")),goog.normalizePath_=function(e){for(var t=e.split("/"),n=0;n<t.length;)"."==t[n]?t.splice(n,1):n&&".."==t[n]&&t[n-1]&&".."!=t[n-1]?t.splice(--n,2):n++;return t.join("/")},goog.loadFileSync_=function(e){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(e);var t=new goog.global.XMLHttpRequest;return t.open("get",e,!1),t.send(),t.responseText},goog.retrieveAndExecModule_=function(e){if(!COMPILED){var t=e;e=goog.normalizePath_(e);var n=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_,r=goog.loadFileSync_(e);if(null==r)throw new Error("load of "+e+"failed");var a=goog.wrapModule_(e,r),o=goog.IS_OLD_IE_;o?(goog.dependencies_.deferred[t]=a,goog.queuedModules_.push(t)):n(e,a)}},goog.typeOf=function(e){var t="undefined"==typeof e?"undefined":babelHelpers["typeof"](e);if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&"undefined"==typeof e.call)return"object";return t},goog.isNull=function(e){return null===e},goog.isDefAndNotNull=function(e){return null!=e},goog.isArray=function(e){return"array"==goog.typeOf(e)},goog.isArrayLike=function(e){var t=goog.typeOf(e);return"array"==t||"object"==t&&"number"==typeof e.length},goog.isDateLike=function(e){return goog.isObject(e)&&"function"==typeof e.getFullYear},goog.isString=function(e){return"string"==typeof e},goog.isBoolean=function(e){return"boolean"==typeof e},goog.isNumber=function(e){return"number"==typeof e},goog.isFunction=function(e){return"function"==goog.typeOf(e)},goog.isObject=function(e){var t="undefined"==typeof e?"undefined":babelHelpers["typeof"](e);return"object"==t&&null!=e||"function"==t},goog.getUid=function(e){return e[goog.UID_PROPERTY_]||(e[goog.UID_PROPERTY_]=++goog.uidCounter_)},goog.hasUid=function(e){return!!e[goog.UID_PROPERTY_]},goog.removeUid=function(e){null!==e&&"removeAttribute"in e&&e.removeAttribute(goog.UID_PROPERTY_);/** @preserveTry */
try{delete e[goog.UID_PROPERTY_]}catch(t){}},goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0),goog.uidCounter_=0,goog.getHashCode=goog.getUid,goog.removeHashCode=goog.removeUid,goog.cloneObject=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if(e.clone)return e.clone();var n="array"==t?[]:{};for(var r in e)n[r]=goog.cloneObject(e[r]);return n}return e},goog.bindNative_=function(e,t,n){return e.call.apply(e.bind,arguments)},goog.bindJs_=function(e,t,n){if(!e)throw new Error;if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}},goog.bind=function(e,t,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_,goog.bind.apply(null,arguments)},goog.partial=function(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}},goog.mixin=function(e,t){for(var n in t)e[n]=t[n]},goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date},goog.globalEval=function(e){if(goog.global.execScript)goog.global.execScript(e,"JavaScript");else{if(!goog.global.eval)throw Error("goog.globalEval not available");if(null==goog.evalWorksForGlobals_)if(goog.global.eval("var _evalTest_ = 1;"),"undefined"!=typeof goog.global._evalTest_){try{delete goog.global._evalTest_}catch(t){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1;if(goog.evalWorksForGlobals_)goog.global.eval(e);else{var n=goog.global.document,r=n.createElement("SCRIPT");r.type="text/javascript",r.defer=!1,r.appendChild(n.createTextNode(e)),n.body.appendChild(r),n.body.removeChild(r)}}},goog.evalWorksForGlobals_=null,goog.cssNameMapping_,goog.cssNameMappingStyle_,goog.getCssName=function(e,t){var n,r=function(e){return goog.cssNameMapping_[e]||e},a=function(e){for(var t=e.split("-"),n=[],a=0;a<t.length;a++)n.push(r(t[a]));return n.join("-")};return n=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?r:a:function(e){return e},t?e+"-"+n(t):n(e)},goog.setCssNameMapping=function(e,t){goog.cssNameMapping_=e,goog.cssNameMappingStyle_=t},goog.global.CLOSURE_CSS_NAME_MAPPING,!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING),goog.getMsg=function(e,t){return t&&(e=e.replace(/\{\$([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e},goog.getMsgWithFallback=function(e,t){return e},goog.exportSymbol=function(e,t,n){goog.exportPath_(e,t,n)},goog.exportProperty=function(e,t,n){e[t]=n},goog.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.base=function(e,n,r){for(var a=new Array(arguments.length-2),o=2;o<arguments.length;o++)a[o-2]=arguments[o];return t.prototype[n].apply(e,a)}},goog.base=function(e,t,n){var r=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!r)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(r.superClass_){for(var a=new Array(arguments.length-1),o=1;o<arguments.length;o++)a[o-1]=arguments[o];return r.superClass_.constructor.apply(e,a)}for(var i=new Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];for(var s=!1,l=e.constructor;l;l=l.superClass_&&l.superClass_.constructor)if(l.prototype[t]===r)s=!0;else if(s)return l.prototype[t].apply(e,i);if(e[t]===r)return e.constructor.prototype[t].apply(e,i);throw Error("goog.base called from a method of one name to a method of a different name")},goog.scope=function(e){e.call(goog.global)},COMPILED||(goog.global.COMPILED=COMPILED),goog.provide("goog.string"),goog.string.subs=function(e,t){for(var n=e.split("%s"),r="",a=Array.prototype.slice.call(arguments,1);a.length&&n.length>1;)r+=n.shift()+a.shift();return r+n.join("%s")},goog.string.AMP_RE_=/&/g,goog.string.LT_RE_=/</g,goog.string.GT_RE_=/>/g,goog.string.QUOT_RE_=/"/g,goog.string.SINGLE_QUOTE_RE_=/'/g,goog.string.NULL_RE_=/\x00/g,goog.string.E_RE_=/e/g,goog.string.ALL_RE_=goog.string.DETECT_DOUBLE_ESCAPING?/[\x00&<>"'e]/:/[\x00&<>"']/,goog.string.unescapeEntities=function(e){return goog.string.contains(e,"&")?!goog.string.FORCE_NON_DOM_HTML_UNESCAPING&&"document"in goog.global?goog.string.unescapeEntitiesUsingDom_(e):goog.string.unescapePureXmlEntities_(e):e},goog.string.unescapeEntitiesUsingDom_=function(e,t){var n,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'};return n=t?t.createElement("div"):goog.global.document.createElement("div"),e.replace(goog.string.HTML_ENTITY_PATTERN_,function(e,t){var a=r[e];if(a)return a;if("#"==t.charAt(0)){var o=Number("0"+t.substr(1));isNaN(o)||(a=String.fromCharCode(o))}return a||(n.innerHTML=e+" ",a=n.firstChild.nodeValue.slice(0,-1)),r[e]=a})},goog.string.unescapePureXmlEntities_=function(e){return e.replace(/&([^;]+);/g,function(e,t){switch(t){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:if("#"==t.charAt(0)){var n=Number("0"+t.substr(1));if(!isNaN(n))return String.fromCharCode(n)}return e}})},goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g,goog.string.contains=function(e,t){return e.indexOf(t)!=-1},goog.string.htmlEscape=function(e,t){return t?(e=e.replace(goog.string.AMP_RE_,"&amp;").replace(goog.string.LT_RE_,"&lt;").replace(goog.string.GT_RE_,"&gt;").replace(goog.string.QUOT_RE_,"&quot;").replace(goog.string.SINGLE_QUOTE_RE_,"&#39;").replace(goog.string.NULL_RE_,"&#0;"),goog.string.DETECT_DOUBLE_ESCAPING&&(e=e.replace(goog.string.E_RE_,"&#101;")),e):goog.string.ALL_RE_.test(e)?(e.indexOf("&")!=-1&&(e=e.replace(goog.string.AMP_RE_,"&amp;")),e.indexOf("<")!=-1&&(e=e.replace(goog.string.LT_RE_,"&lt;")),e.indexOf(">")!=-1&&(e=e.replace(goog.string.GT_RE_,"&gt;")),e.indexOf('"')!=-1&&(e=e.replace(goog.string.QUOT_RE_,"&quot;")),e.indexOf("'")!=-1&&(e=e.replace(goog.string.SINGLE_QUOTE_RE_,"&#39;")),e.indexOf("\0")!=-1&&(e=e.replace(goog.string.NULL_RE_,"&#0;")),goog.string.DETECT_DOUBLE_ESCAPING&&e.indexOf("e")!=-1&&(e=e.replace(goog.string.E_RE_,"&#101;")),e):e},goog.debug={},goog.debug.runtimeType=function(e){return e instanceof Function?e.displayName||e.name||"unknown type name":e instanceof Object?e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e):null===e?"null":"undefined"==typeof e?"undefined":babelHelpers["typeof"](e)},goog.debug.Error=function(e){if(Error.captureStackTrace)Error.captureStackTrace(this,goog.debug.Error);else{var t=(new Error).stack;t&&(this.stack=t)}e&&(this.message=String(e)),this.reportErrorToServer=!0},goog.inherits(goog.debug.Error,Error),goog.debug.Error.prototype.name="CustomError",goog.dom={},goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},goog.provide("goog.i18n.bidi"),goog.provide("goog.i18n.bidi.Dir"),goog.provide("goog.i18n.bidi.DirectionalString"),goog.provide("goog.i18n.bidi.Format"),goog.define("goog.i18n.bidi.FORCE_RTL",!1),goog.i18n.bidi.IS_RTL=goog.i18n.bidi.FORCE_RTL||("ar"==goog.LOCALE.substring(0,2).toLowerCase()||"fa"==goog.LOCALE.substring(0,2).toLowerCase()||"he"==goog.LOCALE.substring(0,2).toLowerCase()||"iw"==goog.LOCALE.substring(0,2).toLowerCase()||"ps"==goog.LOCALE.substring(0,2).toLowerCase()||"sd"==goog.LOCALE.substring(0,2).toLowerCase()||"ug"==goog.LOCALE.substring(0,2).toLowerCase()||"ur"==goog.LOCALE.substring(0,2).toLowerCase()||"yi"==goog.LOCALE.substring(0,2).toLowerCase())&&(2==goog.LOCALE.length||"-"==goog.LOCALE.substring(2,3)||"_"==goog.LOCALE.substring(2,3))||goog.LOCALE.length>=3&&"ckb"==goog.LOCALE.substring(0,3).toLowerCase()&&(3==goog.LOCALE.length||"-"==goog.LOCALE.substring(3,4)||"_"==goog.LOCALE.substring(3,4)),goog.i18n.bidi.Format={LRE:"",RLE:"",PDF:"",LRM:"",RLM:""},goog.i18n.bidi.Dir={LTR:1,RTL:-1,NEUTRAL:0},goog.i18n.bidi.RIGHT="right",goog.i18n.bidi.LEFT="left",goog.i18n.bidi.I18N_RIGHT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.LEFT:goog.i18n.bidi.RIGHT,goog.i18n.bidi.I18N_LEFT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT,goog.i18n.bidi.toDir=function(e,t){return"number"==typeof e?e>0?goog.i18n.bidi.Dir.LTR:e<0?goog.i18n.bidi.Dir.RTL:t?null:goog.i18n.bidi.Dir.NEUTRAL:null==e?null:e?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR},goog.i18n.bidi.ltrChars_="A-Za-z--------",goog.i18n.bidi.rtlChars_="----",goog.i18n.bidi.htmlSkipReg_=/<[^>]*>|&[^;]+;/g,goog.i18n.bidi.stripHtmlIfNeeded_=function(e,t){return t?e.replace(goog.i18n.bidi.htmlSkipReg_,""):e},goog.i18n.bidi.rtlCharReg_=new RegExp("["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.ltrCharReg_=new RegExp("["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.hasAnyRtl=function(e,t){return goog.i18n.bidi.rtlCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.hasRtlChar=goog.i18n.bidi.hasAnyRtl,goog.i18n.bidi.hasAnyLtr=function(e,t){return goog.i18n.bidi.ltrCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.ltrRe_=new RegExp("^["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.rtlRe_=new RegExp("^["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.isRtlChar=function(e){return goog.i18n.bidi.rtlRe_.test(e)},goog.i18n.bidi.isLtrChar=function(e){return goog.i18n.bidi.ltrRe_.test(e)},goog.i18n.bidi.isNeutralChar=function(e){return!goog.i18n.bidi.isLtrChar(e)&&!goog.i18n.bidi.isRtlChar(e)},goog.i18n.bidi.ltrDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.rtlChars_+"]*["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.rtlDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.ltrChars_+"]*["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.startsWithRtl=function(e,t){return goog.i18n.bidi.rtlDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.isRtlText=goog.i18n.bidi.startsWithRtl,goog.i18n.bidi.startsWithLtr=function(e,t){return goog.i18n.bidi.ltrDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.isLtrText=goog.i18n.bidi.startsWithLtr,goog.i18n.bidi.isRequiredLtrRe_=/^http:\/\/.*/,goog.i18n.bidi.isNeutralText=function(e,t){return e=goog.i18n.bidi.stripHtmlIfNeeded_(e,t),goog.i18n.bidi.isRequiredLtrRe_.test(e)||!goog.i18n.bidi.hasAnyLtr(e)&&!goog.i18n.bidi.hasAnyRtl(e)},goog.i18n.bidi.ltrExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.ltrChars_+"][^"+goog.i18n.bidi.rtlChars_+"]*$"),goog.i18n.bidi.rtlExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.rtlChars_+"][^"+goog.i18n.bidi.ltrChars_+"]*$"),goog.i18n.bidi.endsWithLtr=function(e,t){return goog.i18n.bidi.ltrExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.isLtrExitText=goog.i18n.bidi.endsWithLtr,goog.i18n.bidi.endsWithRtl=function(e,t){return goog.i18n.bidi.rtlExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(e,t))},goog.i18n.bidi.isRtlExitText=goog.i18n.bidi.endsWithRtl,goog.i18n.bidi.rtlLocalesRe_=new RegExp("^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Arab|Hebr|Thaa|Nkoo|Tfng))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)","i"),goog.i18n.bidi.isRtlLanguage=function(e){return goog.i18n.bidi.rtlLocalesRe_.test(e)},goog.i18n.bidi.bracketGuardTextRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(<.*?>+)/g,goog.i18n.bidi.guardBracketInText=function(e,t){var n=void 0===t?goog.i18n.bidi.hasAnyRtl(e):t,r=n?goog.i18n.bidi.Format.RLM:goog.i18n.bidi.Format.LRM;return e.replace(goog.i18n.bidi.bracketGuardTextRe_,r+"$&"+r)},goog.i18n.bidi.enforceRtlInHtml=function(e){return"<"==e.charAt(0)?e.replace(/<\w+/,"$& dir=rtl"):"\n<span dir=rtl>"+e+"</span>"},goog.i18n.bidi.enforceRtlInText=function(e){return goog.i18n.bidi.Format.RLE+e+goog.i18n.bidi.Format.PDF},goog.i18n.bidi.enforceLtrInHtml=function(e){return"<"==e.charAt(0)?e.replace(/<\w+/,"$& dir=ltr"):"\n<span dir=ltr>"+e+"</span>"},goog.i18n.bidi.enforceLtrInText=function(e){return goog.i18n.bidi.Format.LRE+e+goog.i18n.bidi.Format.PDF},goog.i18n.bidi.dimensionsRe_=/:\s*([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)/g,goog.i18n.bidi.leftRe_=/left/gi,goog.i18n.bidi.rightRe_=/right/gi,goog.i18n.bidi.tempRe_=/%%%%/g,goog.i18n.bidi.mirrorCSS=function(e){return e.replace(goog.i18n.bidi.dimensionsRe_,":$1 $4 $3 $2").replace(goog.i18n.bidi.leftRe_,"%%%%").replace(goog.i18n.bidi.rightRe_,goog.i18n.bidi.LEFT).replace(goog.i18n.bidi.tempRe_,goog.i18n.bidi.RIGHT)},goog.i18n.bidi.doubleQuoteSubstituteRe_=/([\u0591-\u05f2])"/g,goog.i18n.bidi.singleQuoteSubstituteRe_=/([\u0591-\u05f2])'/g,goog.i18n.bidi.normalizeHebrewQuote=function(e){return e.replace(goog.i18n.bidi.doubleQuoteSubstituteRe_,"$1").replace(goog.i18n.bidi.singleQuoteSubstituteRe_,"$1")},goog.i18n.bidi.wordSeparatorRe_=/\s+/,goog.i18n.bidi.hasNumeralsRe_=/[\d\u06f0-\u06f9]/,goog.i18n.bidi.rtlDetectionThreshold_=.4,goog.i18n.bidi.estimateDirection=function(e,t){for(var n=0,r=0,a=!1,o=goog.i18n.bidi.stripHtmlIfNeeded_(e,t).split(goog.i18n.bidi.wordSeparatorRe_),i=0;i<o.length;i++){var s=o[i];goog.i18n.bidi.startsWithRtl(s)?(n++,r++):goog.i18n.bidi.isRequiredLtrRe_.test(s)?a=!0:goog.i18n.bidi.hasAnyLtr(s)?r++:goog.i18n.bidi.hasNumeralsRe_.test(s)&&(a=!0)}return 0==r?a?goog.i18n.bidi.Dir.LTR:goog.i18n.bidi.Dir.NEUTRAL:n/r>goog.i18n.bidi.rtlDetectionThreshold_?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR},goog.i18n.bidi.detectRtlDirectionality=function(e,t){return goog.i18n.bidi.estimateDirection(e,t)==goog.i18n.bidi.Dir.RTL},goog.i18n.bidi.setElementDirAndAlign=function(e,t){e&&(t=goog.i18n.bidi.toDir(t),t&&(e.style.textAlign=t==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT,e.dir=t==goog.i18n.bidi.Dir.RTL?"rtl":"ltr"))},goog.i18n.bidi.setElementDirByTextDirectionality=function(e,t){switch(goog.i18n.bidi.estimateDirection(t)){case goog.i18n.bidi.Dir.LTR:e.dir="ltr";break;case goog.i18n.bidi.Dir.RTL:e.dir="rtl";break;default:e.removeAttribute("dir")}},goog.i18n.bidi.DirectionalString=function(){},goog.i18n.bidi.DirectionalString.prototype.implementsGoogI18nBidiDirectionalString,goog.i18n.bidi.DirectionalString.prototype.getDirection,goog.provide("goog.asserts"),goog.define("goog.asserts.ENABLE_ASSERTS",goog.DEBUG),goog.asserts.AssertionError=function(e,t){t.unshift(e),goog.debug.Error.call(this,goog.string.subs.apply(null,t)),t.shift(),this.messagePattern=e},goog.inherits(goog.asserts.AssertionError,goog.debug.Error),goog.asserts.AssertionError.prototype.name="AssertionError",goog.asserts.DEFAULT_ERROR_HANDLER=function(e){throw e},goog.asserts.errorHandler_=goog.asserts.DEFAULT_ERROR_HANDLER,goog.asserts.doAssertFailure_=function(e,t,n,r){var a="Assertion failed";if(n){a+=": "+n;var o=r}else e&&(a+=": "+e,o=t);var i=new goog.asserts.AssertionError(""+a,o||[]);goog.asserts.errorHandler_(i)},goog.asserts.setErrorHandler=function(e){goog.asserts.ENABLE_ASSERTS&&(goog.asserts.errorHandler_=e)},goog.asserts.assert=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&!e&&goog.asserts.doAssertFailure_("",null,t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.fail=function(e,t){goog.asserts.ENABLE_ASSERTS&&goog.asserts.errorHandler_(new goog.asserts.AssertionError("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1)))},goog.asserts.assertNumber=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(e)&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertString=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&!goog.isString(e)&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertFunction=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(e)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertObject=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&!goog.isObject(e)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertArray=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&!goog.isArray(e)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertBoolean=function(e,t,n){return goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(e)&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertElement=function(e,t,n){return!goog.asserts.ENABLE_ASSERTS||goog.isObject(e)&&e.nodeType==goog.dom.NodeType.ELEMENT||goog.asserts.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertInstanceof=function(e,t,n,r){return!goog.asserts.ENABLE_ASSERTS||e instanceof t||goog.asserts.doAssertFailure_("Expected instanceof %s but got %s.",[goog.asserts.getType_(t),goog.asserts.getType_(e)],n,Array.prototype.slice.call(arguments,3)),e},goog.asserts.assertObjectPrototypeIsIntact=function(){for(var e in Object.prototype)goog.asserts.fail(e+" should not be enumerable in Object.prototype.")},goog.asserts.getType_=function(e){return e instanceof Function?e.displayName||e.name||"unknown type name":e instanceof Object?e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e):null===e?"null":"undefined"==typeof e?"undefined":babelHelpers["typeof"](e)},goog.string.StringBuffer=function(e,t){null!=e&&this.append.apply(this,arguments)},goog.string.StringBuffer.prototype.buffer_="",goog.string.StringBuffer.prototype.set=function(e){this.buffer_=""+e},goog.string.StringBuffer.prototype.append=function(e,t,n){if(this.buffer_+=String(e),null!=t)for(var r=1;r<arguments.length;r++)this.buffer_+=arguments[r];return this},goog.string.StringBuffer.prototype.clear=function(){this.buffer_=""},goog.string.StringBuffer.prototype.getLength=function(){return this.buffer_.length},goog.string.StringBuffer.prototype.toString=function(){return this.buffer_},goog.soy={},goog.soy.data={},goog.soy.data.SanitizedContentKind={HTML:goog.DEBUG?{sanitizedContentKindHtml:!0}:{},JS:goog.DEBUG?{sanitizedContentJsChars:!0}:{},URI:goog.DEBUG?{sanitizedContentUri:!0}:{},TRUSTED_RESOURCE_URI:goog.DEBUG?{sanitizedContentTrustedResourceUri:!0}:{},ATTRIBUTES:goog.DEBUG?{sanitizedContentHtmlAttribute:!0}:{},CSS:goog.DEBUG?{sanitizedContentCss:!0}:{},TEXT:goog.DEBUG?{sanitizedContentKindText:!0}:{}},goog.soy.data.SanitizedContent=function(){throw Error("Do not instantiate directly")},goog.soy.data.SanitizedContent.prototype.contentKind,goog.soy.data.SanitizedContent.prototype.contentDir=null,goog.soy.data.SanitizedContent.prototype.content,goog.soy.data.SanitizedContent.prototype.getContent=function(){return this.content},goog.soy.data.SanitizedContent.prototype.toString=function(){return this.content},goog.soy.data.UnsanitizedText=function(){goog.soy.data.UnsanitizedText.base(this,"constructor")},goog.inherits(goog.soy.data.UnsanitizedText,goog.soy.data.SanitizedContent),goog.soy.data.SanitizedHtml=function(){goog.soy.data.SanitizedHtml.base(this,"constructor")},goog.inherits(goog.soy.data.SanitizedHtml,goog.soy.data.SanitizedContent),goog.soy.data.SanitizedHtml.prototype.contentKind=goog.soy.data.SanitizedContentKind.HTML,goog.soy.data.SanitizedHtml.isCompatibleWith=function(e){return goog.isString(e)||e instanceof goog.soy.data.SanitizedHtml||e instanceof goog.soy.data.UnsanitizedText||e instanceof goog.html.SafeHtml},function(){var e={};e.asserts={},e.esc={};var t={};e.StringBuilder=goog.string.StringBuffer,t.SanitizedContentKind=goog.soy.data.SanitizedContentKind,t.isContentKind=function(e,t){return null!=e&&e.contentKind===t},t.SanitizedHtml=function(){t.SanitizedHtml.base(this,"constructor")},goog.inherits(t.SanitizedHtml,goog.soy.data.SanitizedHtml),t.SanitizedHtml.from=function(n){return null!=n&&n.contentKind===goog.soy.data.SanitizedContentKind.HTML?(goog.asserts.assert(n.constructor===goog.soy.data.SanitizedHtml||n.constructor===t.SanitizedHtml),n):n instanceof goog.html.SafeHtml?t.VERY_UNSAFE.ordainSanitizedHtml(goog.html.SafeHtml.unwrap(n),n.getDirection()):t.VERY_UNSAFE.ordainSanitizedHtml(e.esc.$$escapeHtmlHelper(String(n)),t.getContentDir(n))},t.SanitizedHtml.isCompatibleWith=function(e){return goog.isString(e)||e instanceof goog.soy.data.SanitizedHtml||e instanceof goog.soy.data.UnsanitizedText||e instanceof goog.html.SafeHtml},t.SanitizedUri=function(){goog.soy.data.SanitizedContent.call(this)},goog.inherits(t.SanitizedUri,goog.soy.data.SanitizedContent),t.SanitizedUri.prototype.contentKind=t.SanitizedContentKind.URI,t.SanitizedUri.prototype.contentDir=goog.i18n.bidi.Dir.LTR,t.UnsanitizedText=function(e,t){this.content=String(e),this.contentDir=null!=t?t:null},goog.inherits(t.UnsanitizedText,goog.soy.data.UnsanitizedText),t.UnsanitizedText.prototype.contentKind=t.SanitizedContentKind.TEXT,t.$$EMPTY_STRING_={VALUE:""},t.$$makeSanitizedContentFactory_=function(e){function t(e){this.content=e}function n(e,n){var r=new t(String(e));return void 0!==n&&(r.contentDir=n),r}return t.prototype=e.prototype,n},t.$$makeSanitizedContentFactoryWithDefaultDirOnly_=function(e){function t(e){this.content=e}function n(e){var n=new t(String(e));return n}return t.prototype=e.prototype,n},t.markUnsanitizedText=function(e,n){return new t.UnsanitizedText(e,n)},t.VERY_UNSAFE={},t.VERY_UNSAFE.ordainSanitizedUri=t.$$makeSanitizedContentFactoryWithDefaultDirOnly_(t.SanitizedUri),e.$$augmentMap=function(t,n){return e.$$assignDefaults(e.$$assignDefaults({},n),t)},e.$$assignDefaults=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},e.$$checkMapKey=function(e){if("string"!=typeof e)throw Error("Map literal's key expression must evaluate to string (encountered type \""+("undefined"==typeof e?"undefined":babelHelpers["typeof"](e))+'").');return e},e.$$getMapKeys=function(e){var t=[];for(var n in e)t.push(n);return t},e.$$checkNotNull=function(e){if(null==e)throw Error("unexpected null value");return e},e.$$getDelTemplateId=function(e){return e},e.$$DELEGATE_REGISTRY_PRIORITIES_={},e.$$DELEGATE_REGISTRY_FUNCTIONS_={},e.$$registerDelegateFn=function(t,n,r,a){var o="key_"+t+":"+n,i=e.$$DELEGATE_REGISTRY_PRIORITIES_[o];if(void 0===i||r>i)e.$$DELEGATE_REGISTRY_PRIORITIES_[o]=r,e.$$DELEGATE_REGISTRY_FUNCTIONS_[o]=a;else if(r==i)throw Error('Encountered two active delegates with the same priority ("'+t+":"+n+'").')},e.$$getDelegateFn=function(t,n,r){var a=e.$$DELEGATE_REGISTRY_FUNCTIONS_["key_"+t+":"+n];if(a||""==n||(a=e.$$DELEGATE_REGISTRY_FUNCTIONS_["key_"+t+":"]),a)return a;if(r)return e.$$EMPTY_TEMPLATE_FN_;throw Error('Found no active impl for delegate call to "'+t+":"+n+'" (and not allowemptydefault="true").')},e.$$EMPTY_TEMPLATE_FN_=function(e,t,n){return""},e.$$truncate=function(t,n,r){return t=String(t),t.length<=n?t:(r&&(n>3?n-=3:r=!1),e.$$isHighSurrogate_(t.charAt(n-1))&&e.$$isLowSurrogate_(t.charAt(n))&&(n-=1),t=t.substring(0,n),r&&(t+="..."),t)},e.$$isHighSurrogate_=function(e){return 55296<=e&&e<=56319},e.$$isLowSurrogate_=function(e){return 56320<=e&&e<=57343},e.asserts.assertType=function(e,t,n,r){if(goog.asserts.ENABLE_ASSERTS&&!e){var a="expected param "+t+" of type "+r+(goog.DEBUG?", but got "+goog.debug.runtimeType(n):"")+".";goog.asserts.fail(a)}return n},e.esc.$$escapeHtmlHelper=function(e){return goog.string.htmlEscape(String(e))},e.$$filterImageDataUri=function(n){return t.VERY_UNSAFE.ordainSanitizedUri(e.esc.$$filterImageDataUriHelper(n))},e.esc.$$FILTER_FOR_FILTER_IMAGE_DATA_URI_=/^data:image\/(?:bmp|gif|jpe?g|png|tiff|webp);base64,[a-z0-9+\/]+=*$/i,e.esc.$$filterImageDataUriHelper=function(t){var n=String(t);return e.esc.$$FILTER_FOR_FILTER_IMAGE_DATA_URI_.test(n)?n:(goog.asserts.fail("Bad value `%s` for |filterImageDataUri",[n]),"data:image/gif;base64,zSoyz")};var n=IncrementalDOM,r={};r.renderDynamicContent=function(e){goog.isFunction(e)?e():null!=e&&n.text(e)},r.print=function(a){if(a instanceof t.SanitizedHtml){var o=n.elementOpen("html-blob"),i=a.toString();o.__innerHTML!==i&&(e.renderHtml(o,a),o.__innerHTML=i),n.skip(),n.elementClose("html-blob")}else r.renderDynamicContent(a)},goog.loadModule(function(){return goog.module("soy.idom"),r}),goog.loadModule(function(){return goog.module("soy"),e}),goog.loadModule(function(){return goog.module("soydata"),t}),goog.loadModule(function(){return goog.module("soy.asserts"),e})}(),goog.loadModule(function(){return goog.module("incrementaldom"),IncrementalDOM})}).call("undefined"!=typeof exports&&"undefined"!=typeof global?global:window)}.call(this),function(){/*
  * HTML5 Parser By Sam Blowes
  *
  * Designed for HTML5 documents
  *
  * Original code by John Resig (ejohn.org)
  * http://ejohn.org/blog/pure-javascript-html-parser/
  * Original code by Erik Arvidsson, Mozilla Public License
  * http://erik.eae.net/simplehtmlparser/simplehtmlparser.js
  *
  * ----------------------------------------------------------------------------
  * License
  * ----------------------------------------------------------------------------
  *
  * This code is triple licensed using Apache Software License 2.0,
  * Mozilla Public License or GNU Public License
  *
  * ////////////////////////////////////////////////////////////////////////////
  *
  * Licensed under the Apache License, Version 2.0 (the "License"); you may not
  * use this file except in compliance with the License.  You may obtain a copy
  * of the License at http://www.apache.org/licenses/LICENSE-2.0
  *
  * ////////////////////////////////////////////////////////////////////////////
  *
  * The contents of this file are subject to the Mozilla Public License
  * Version 1.1 (the "License"); you may not use this file except in
  * compliance with the License. You may obtain a copy of the License at
  * http://www.mozilla.org/MPL/
  *
  * Software distributed under the License is distributed on an "AS IS"
  * basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  * License for the specific language governing rights and limitations
  * under the License.
  *
  * The Original Code is Simple HTML Parser.
  *
  * The Initial Developer of the Original Code is Erik Arvidsson.
  * Portions created by Erik Arvidssson are Copyright (C) 2004. All Rights
  * Reserved.
  *
  * ////////////////////////////////////////////////////////////////////////////
  *
  * This program is free software; you can redistribute it and/or
  * modify it under the terms of the GNU General Public License
  * as published by the Free Software Foundation; either version 2
  * of the License, or (at your option) any later version.
  *
  * This program is distributed in the hope that it will be useful,
  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  * GNU General Public License for more details.
  *
  * You should have received a copy of the GNU General Public License
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
  * @license
  */
(function(){function e(e){for(var t={},n=e.split(","),r=0;r<n.length;r++)t[n[r]]=!0;return t}var t=/^<([-A-Za-z0-9_]+)((?:\s+[a-zA-Z_:][-a-zA-Z0-9_:.]*(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,n=/^<\/([-A-Za-z0-9_]+)[^>]*>/,r=/([a-zA-Z_:][-a-zA-Z0-9_:.]*)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,a=e("area,base,basefont,br,col,frame,hr,img,input,link,meta,param,embed,command,keygen,source,track,wbr"),o=e("a,address,article,applet,aside,audio,blockquote,button,canvas,center,dd,del,dir,div,dl,dt,fieldset,figcaption,figure,footer,form,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,output,p,pre,section,script,table,tbody,td,tfoot,th,thead,tr,ul,video"),i=e("abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),s=e("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),l=e("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),u=e("script,style");window.HTMLParser=function(e,c){function d(e,t,n,u){if(t=t.toLowerCase(),o[t])for(;p.last()&&i[p.last()]&&"span"!==p.last();)h("",p.last());if(s[t]&&p.last()==t&&h("",t),u=a[t]||!!u,u||p.push(t),c.start){var d=[];n.replace(r,function(e,t){var n=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:l[t]?t:"";d.push({name:t,value:n,escaped:n.replace(/(^|[^\\])"/g,'$1\\"')})}),c.start&&c.start(t,d,u)}}function h(e,t){if(t)for(var n=p.length-1;n>=0&&p[n]!=t;n--);else var n=0;if(n>=0){for(var r=p.length-1;r>=n;r--)c.end&&c.end(p[r]);p.length=n}}var g,m,f,p=[],v=e;for(p.last=function(){return this[this.length-1]};e;){if(m=!0,p.last()&&u[p.last()])e=e.replace(new RegExp("([\\s\\S]*?)</"+p.last()+"[^>]*>"),function(e,t){return t=t.replace(/<!--([\s\S]*?)-->|<!\[CDATA\[([\s\S]*?)]]>/g,"$1$2"),c.chars&&c.chars(t),""}),h("",p.last());else if(0==e.indexOf("<!--")?(g=e.indexOf("-->"),g>=0&&(c.comment&&c.comment(e.substring(4,g)),e=e.substring(g+3),m=!1)):0==e.indexOf("</")?(f=e.match(n),f&&(e=e.substring(f[0].length),f[0].replace(n,h),m=!1)):0==e.indexOf("<")&&(f=e.match(t),f&&(e=e.substring(f[0].length),f[0].replace(t,d),m=!1)),m){g=e.indexOf("<");var y=g<0?e:e.substring(0,g);e=g<0?"":e.substring(g),c.chars&&c.chars(y)}if(e==v)throw"Parse Error: "+e;v=e}h()}}).call(this)}.call(this),function(){function e(e){var n={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'},r=document.createElement("div");return e.replace(t,function(e,t){var a=n[e];if(a)return a;if("#"===t.charAt(0)){var o=Number("0"+t.substr(1));isNaN(o)||(a=String.fromCharCode(o))}return a||(r.innerHTML=e+" ",a=r.firstChild.nodeValue.slice(0,-1)),n[e]=a,a})}this.metal.unescape=e;var t=/&([^;\s<&]+);?/g}.call(this),function(){var e,t=this.metal.unescape,n=function(){function n(){babelHelpers.classCallCheck(this,n)}return babelHelpers.createClass(n,null,[{key:"buildFn",value:function(e){return function(){return n.run(e)}}},{key:"getParser",value:function(){return e||window.HTMLParser}},{key:"run",value:function(e){n.getParser()(e,{start:function(e,t,n){for(var r=n?IncrementalDOM.elementVoid:IncrementalDOM.elementOpen,a=[e,null,[]],o=0;o<t.length;o++)a.push(t[o].name,t[o].value);r.apply(null,a)},end:function(e){IncrementalDOM.elementClose(e)},chars:function(e){IncrementalDOM.text(e,t)}})}},{key:"setParser",value:function(t){e=t}}]),n}();this.metal.HTML2IncDom=n}.call(this),function(){var e=this.metal.HTML2IncDom;this.metal.withParser=e}.call(this),function(){var e={interceptFns_:[],getOriginalFn:function(e){return e.originalFn?e.originalFn:e},handleTemplateCall_:function(t,n,r,a){var o=e.interceptFns_[e.interceptFns_.length-1];return o?o.call(null,t,n,r,a):t.call(null,n,r,a)},registerForInterception:function(t,n){var r=t[n];r.originalFn||(t[n]=e.handleTemplateCall_.bind(null,r),t[n].originalFn=r)},startInterception:function(t){e.interceptFns_.push(t)},stopAllInterceptions:function(){e.interceptFns_=[]},stopInterception:function(){e.interceptFns_.pop()}};this.metal.SoyAop=e}.call(this),function(){var e=this.metalNamed.component.ComponentRegistry,t=this.metalNamed.metal.isFunction,n=this.metalNamed.metal.isObject,r=this.metalNamed.metal.isString,a=this.metalNamed.metal.object,o=this.metalNamed.state.validators,i=this.metalNamed.state.Config,s=this.metal.withParser,l=this.metal.IncrementalDomRenderer,u=this.metal.SoyAop,c={},d=function(o){function i(){return babelHelpers.classCallCheck(this,i),babelHelpers.possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return babelHelpers.inherits(i,o),babelHelpers.createClass(i,[{key:"getExtraDataConfig",value:function(e){var n=e.constructor.TEMPLATE;if(t(n)){n=u.getOriginalFn(n),this.soyParamTypes_=n.types||{};for(var r=n.params||[],a={},o=0;o<r.length;o++)e[r[o]]||(a[r[o]]={});return a}}},{key:"buildTemplateData_",value:function(e,n){var r=this,o=a.mixin({},this.getConfig(e));e.getStateKeys().forEach(function(t){var n=e[t];r.isHtmlParam_(e,t)&&(n=h.toIncDom(n)),o[t]=n});for(var i=0;i<n.length;i++)!o[n[i]]&&t(e[n[i]])&&(o[n[i]]=e[n[i]].bind(e));return t(e.prepareStateForRender)?e.prepareStateForRender(o)||o:o}},{key:"getTemplate",value:function(e,t){return function(n,r,a){if(!goog.loadedModules_[e])throw new Error('No template with namespace "'+e+'" has been loaded yet.');return goog.loadedModules_[e][t](n,r,a)}}},{key:"handleInterceptedCall_",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[e.componentCtor,null,[]];for(var r in t)n.push(r,t[r]);IncrementalDOM.elementVoid.apply(null,n)}},{key:"isHtmlParam_",value:function(e,t){var n=e.getDataManager().getStateInstance(e);if(n.getStateKeyConfig(t).isHtml)return!0;var r=u.getOriginalFn(e.constructor.TEMPLATE),a=(r.types||{})[t]||"";return a.split("|").indexOf("html")!==-1}},{key:"register",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"render";t.RENDERER=h,t.TEMPLATE=u.getOriginalFn(n[r]),t.TEMPLATE.componentCtor=t,u.registerForInterception(n,r),e.register(t)}},{key:"renderIncDom",value:function(e){var n=e.constructor.TEMPLATE;if(t(n)&&!e.render){n=u.getOriginalFn(n),u.startInterception(this.handleInterceptedCall_);var r=this.buildTemplateData_(e,n.params||[]);n(r,null,c),u.stopInterception()}else babelHelpers.get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"renderIncDom",this).call(this,e)}},{key:"setInjectedData",value:function(e){c=e||{}}},{key:"shouldUpdate",value:function(e,t){var n=babelHelpers.get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"shouldUpdate",this).call(this,e,t);if(!n||e.shouldUpdate)return n;for(var r=e.constructor.TEMPLATE,a=r?u.getOriginalFn(r).params:[],o=0;o<a.length;o++)if(t.props[a[o]])return!0;return!1}},{key:"toHtmlString",value:function(e){var t=document.createElement("div");return IncrementalDOM.patch(t,e),t.innerHTML}},{key:"toIncDom",value:function(e){return n(e)&&r(e.content)&&"HTML"===e.contentKind&&(e=e.content),r(e)&&(e=s.buildFn(e)),e}}]),i}(l.constructor),h=new d;h.RENDERER_NAME="soy",this.metal.Soy=h,this.metalNamed.Soy=this.metalNamed.Soy||{},this.metalNamed.Soy.Config=i,this.metalNamed.Soy.Soy=h,this.metalNamed.Soy.SoyAop=u,this.metalNamed.Soy.validators=o}.call(this),function(){var e,t=this.metal.component,n=this.metal.Soy;goog.loadModule(function(t){function n(e,t,n){}goog.module("Router.incrementaldom");goog.require("soy"),goog.require("soydata");goog.require("goog.i18n.bidi"),goog.require("goog.asserts"),goog.require("goog.string");var r=goog.require("incrementaldom");r.elementOpen,r.elementClose,r.elementVoid,r.elementOpenStart,r.elementOpenEnd,r.text,r.attr;return t.render=n,goog.DEBUG&&(n.soyTemplateName="Router.render"),t.render.params=[],t.render.types={},e=t,t});var r=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return babelHelpers.inherits(t,e),t}(t);n.register(r,e),this.metalNamed.RouterSoy=this.metalNamed.RouterSoy||{},this.metalNamed.RouterSoy.Router=r,this.metalNamed.RouterSoy.templates=e,this.metal.RouterSoy=e}.call(this),function(){var e=this.metal.RouterSoy,t=this.metal.Router,n=this.metal.Soy,r=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return babelHelpers.inherits(t,e),t}(t);n.register(r,e),this.metal.RouterSoy=r}.call(this),function(){var e=this.metal.Router,t=this.metal.RouterSoy;this.metal.router=e,this.metalNamed.router=this.metalNamed.router||{},this.metalNamed.router.Router=e,this.metalNamed.router.RouterSoy=t}.call(this)}).call(this);